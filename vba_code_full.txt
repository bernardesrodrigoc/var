
============================================================
MODULE: Módulo1.bas
============================================================
Attribute VB_Name = "Módulo1"



============================================================
MODULE: EstaPasta_de_trabalho.cls
============================================================
Attribute VB_Name = "EstaPasta_de_trabalho"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()
Application.Visible = False
bemvindo.Show

'Application.OnTime Now + TimeValue("00:10:00"), "SaveWb"
End Sub




============================================================
MODULE: Planilha4.cls
============================================================
Attribute VB_Name = "Planilha4"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Módulo2.bas
============================================================
Attribute VB_Name = "Módulo2"
Sub dois()
Attribute dois.VB_ProcData.VB_Invoke_Func = "W\n14"

' Atalho do teclado: Ctrl+w

    ultimalinha = Plan1.Cells(Rows.Count, "k").End(xlUp).Row
    Lin = 2
    For i = 2 To ultimalinha
        If Plan1.Cells(i, 14) <> "" Then
            
            Plan1.Cells(Lin, 16) = Plan1.Cells(i, 13)
            Plan1.Cells(Lin, 17) = Plan1.Cells(i, 14)
            
            Lin = Lin + 1
        End If
    
    Next


End Sub



============================================================
MODULE: Módulo4.bas
============================================================
Attribute VB_Name = "Módulo4"
Sub tres()
Attribute tres.VB_ProcData.VB_Invoke_Func = "e\n14"
'
' tres Macro
'
' Atalho do teclado: Ctrl+e
'
    Columns("K:K").Select
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Range("K1").Select
    ActiveCell.FormulaR1C1 = "nova"
    Range("L1").Select
    ActiveCell.FormulaR1C1 = "n"
    Range("K2:L2").Select
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 408
    ActiveWindow.ScrollRow = 734
    ActiveWindow.ScrollRow = 1101
    ActiveWindow.ScrollRow = 1223
    ActiveWindow.ScrollRow = 1631
    ActiveWindow.ScrollRow = 1957
    ActiveWindow.ScrollRow = 2406
    ActiveWindow.ScrollRow = 2446
    ActiveWindow.ScrollRow = 2650
    ActiveWindow.ScrollRow = 3017
    ActiveWindow.ScrollRow = 3140
    ActiveWindow.ScrollRow = 3262
    ActiveWindow.ScrollRow = 3303
    ActiveWindow.ScrollRow = 3669
    ActiveWindow.ScrollRow = 3833
    ActiveWindow.ScrollRow = 4159
    ActiveWindow.ScrollRow = 4240
    ActiveWindow.ScrollRow = 4526
    ActiveWindow.ScrollRow = 4607
    ActiveWindow.ScrollRow = 4729
    ActiveWindow.ScrollRow = 4892
    ActiveWindow.ScrollRow = 5015
    ActiveWindow.ScrollRow = 5463
    ActiveWindow.ScrollRow = 5749
    ActiveWindow.ScrollRow = 6319
    ActiveWindow.ScrollRow = 6686
    ActiveWindow.ScrollRow = 6890
    ActiveWindow.ScrollRow = 7298
    ActiveWindow.ScrollRow = 7420
    ActiveWindow.ScrollRow = 7787
    ActiveWindow.ScrollRow = 8031
    ActiveWindow.ScrollRow = 8398
    ActiveWindow.ScrollRow = 8439
    ActiveWindow.ScrollRow = 8480
    ActiveWindow.ScrollRow = 8521
    ActiveWindow.ScrollRow = 8847
    ActiveWindow.ScrollRow = 9091
    ActiveWindow.ScrollRow = 9377
    ActiveWindow.ScrollRow = 9499
    ActiveWindow.ScrollRow = 9581
    ActiveWindow.ScrollRow = 10029
    ActiveWindow.ScrollRow = 10111
    ActiveWindow.ScrollRow = 10681
    ActiveWindow.ScrollRow = 10885
    ActiveWindow.ScrollRow = 10967
    ActiveWindow.ScrollRow = 11293
    ActiveWindow.ScrollRow = 11537
    ActiveWindow.ScrollRow = 11619
    ActiveWindow.ScrollRow = 12067
    ActiveWindow.ScrollRow = 12149
    ActiveWindow.ScrollRow = 12108
    ActiveWindow.ScrollRow = 11904
    ActiveWindow.ScrollRow = 11619
    ActiveWindow.ScrollRow = 11578
    ActiveWindow.ScrollRow = 11537
    ActiveWindow.ScrollRow = 11293
    ActiveWindow.ScrollRow = 11252
    ActiveWindow.ScrollRow = 11211
    ActiveWindow.ScrollRow = 11130
    ActiveWindow.ScrollRow = 11089
    ActiveWindow.ScrollRow = 11130
    ActiveWindow.ScrollRow = 11252
    ActiveWindow.ScrollRow = 11334
    ActiveWindow.ScrollRow = 11293
    Range("K2:L18000").Select
    ActiveWindow.ScrollRow = 11252
    ActiveWindow.ScrollRow = 10885
    ActiveWindow.ScrollRow = 10192
    ActiveWindow.ScrollRow = 9866
    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _
        "Plan1!R1C11:R11311C12", Version:=xlPivotTableVersion15).CreatePivotTable _
        TableDestination:="Plan1!R2C14", TableName:="Tabela dinâmica1", _
        DefaultVersion:=xlPivotTableVersion15
    Sheets("Plan1").Select
    Cells(2, 14).Select
    ActiveWorkbook.ShowPivotTableFieldList = True
    With ActiveSheet.PivotTables("Tabela dinâmica1").PivotFields("n")
        .Orientation = xlColumnField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("Tabela dinâmica1").PivotFields("nova")
        .Orientation = xlRowField
        .Position = 1
    End With
    ActiveSheet.PivotTables("Tabela dinâmica1").AddDataField ActiveSheet. _
        PivotTables("Tabela dinâmica1").PivotFields("n"), "Soma de n", xlSum
    ActiveWorkbook.ShowPivotTableFieldList = False
    Range("N3:O3").Select
    ActiveWindow.ScrollRow = 82
    ActiveWindow.ScrollRow = 164
    ActiveWindow.ScrollRow = 245
    ActiveWindow.ScrollRow = 246
    ActiveWindow.ScrollRow = 245
    ActiveWindow.ScrollRow = 286
    ActiveWindow.ScrollRow = 653
    ActiveWindow.ScrollRow = 694
    ActiveWindow.ScrollRow = 1020
    ActiveWindow.ScrollRow = 1264
    ActiveWindow.ScrollRow = 1427
    ActiveWindow.ScrollRow = 1590
    ActiveWindow.ScrollRow = 1713
    ActiveWindow.ScrollRow = 1753
    ActiveWindow.ScrollRow = 1876
    ActiveWindow.ScrollRow = 1917
    ActiveWindow.ScrollRow = 1957
    ActiveWindow.ScrollRow = 2039
    ActiveWindow.ScrollRow = 2080
    ActiveWindow.ScrollRow = 2120
    ActiveWindow.ScrollRow = 2283
    ActiveWindow.ScrollRow = 2324
    ActiveWindow.ScrollRow = 2406
    ActiveWindow.ScrollRow = 2446
    ActiveWindow.ScrollRow = 2610
    ActiveWindow.ScrollRow = 2650
    ActiveWindow.ScrollRow = 2773
    ActiveWindow.ScrollRow = 3017
    ActiveWindow.ScrollRow = 3221
    ActiveWindow.ScrollRow = 3425
    ActiveWindow.ScrollRow = 3466
    ActiveWindow.ScrollRow = 3669
    ActiveWindow.ScrollRow = 3710
    ActiveWindow.ScrollRow = 3914
    ActiveWindow.ScrollRow = 4036
    ActiveWindow.ScrollRow = 4118
    ActiveWindow.ScrollRow = 4159
    ActiveWindow.ScrollRow = 4199
    ActiveWindow.ScrollRow = 4281
    ActiveWindow.ScrollRow = 4322
    ActiveWindow.ScrollRow = 4403
    ActiveWindow.ScrollRow = 4607
    ActiveWindow.ScrollRow = 4729
    ActiveWindow.ScrollRow = 4892
    ActiveWindow.ScrollRow = 4933
    ActiveWindow.ScrollRow = 5219
    ActiveWindow.ScrollRow = 5341
    ActiveWindow.ScrollRow = 5504
    ActiveWindow.ScrollRow = 5667
    ActiveWindow.ScrollRow = 5789
    ActiveWindow.ScrollRow = 5871
    ActiveWindow.ScrollRow = 6156
    ActiveWindow.ScrollRow = 6279
    ActiveWindow.ScrollRow = 6442
    ActiveWindow.ScrollRow = 6523
    ActiveWindow.ScrollRow = 6605
    ActiveWindow.ScrollRow = 6768
    ActiveWindow.ScrollRow = 6890
    ActiveWindow.ScrollRow = 7053
    ActiveWindow.ScrollRow = 7175
    ActiveWindow.ScrollRow = 7420
    ActiveWindow.ScrollRow = 7583
    ActiveWindow.ScrollRow = 7665
    ActiveWindow.ScrollRow = 7787
    ActiveWindow.ScrollRow = 7828
    ActiveWindow.ScrollRow = 7787
    ActiveWindow.ScrollRow = 7420
    ActiveWindow.ScrollRow = 7379
    ActiveWindow.ScrollRow = 7380
    ActiveWindow.SmallScroll Down:=-465
    Range("N3:O18000").Select
    Selection.Copy
    ActiveWindow.ScrollRow = 6931
    ActiveWindow.ScrollRow = 6890
    ActiveWindow.ScrollRow = 6401
    ActiveWindow.ScrollRow = 5096
    ActiveWindow.ScrollRow = 4118
    ActiveWindow.ScrollRow = 2243
    ActiveWindow.ScrollRow = 1876
    ActiveWindow.ScrollRow = 1835
    ActiveWindow.ScrollRow = 1142
    ActiveWindow.ScrollRow = 816
    ActiveWindow.ScrollRow = 612
    ActiveWindow.ScrollRow = 449
    ActiveWindow.ScrollRow = 327
    ActiveWindow.ScrollRow = 204
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 1
    Range("P2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Columns("Q:Q").Select
    Application.CutCopyMode = False
    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("P:P").Select
End Sub



============================================================
MODULE: Módulo3.bas
============================================================
Attribute VB_Name = "Módulo3"
Sub um()
Attribute um.VB_ProcData.VB_Invoke_Func = "q\n14"
'
' um Macro
'
' Atalho do teclado: Ctrl+q
'
    Columns("K:K").Select
    Selection.Delete Shift:=xlToLeft
    Range("K1").Select
    ActiveCell.FormulaR1C1 = "lat"
    Range("L1").Select
    ActiveCell.FormulaR1C1 = "long"
    Range("M1").Select
    ActiveCell.FormulaR1C1 = "nova"
    Range("M2").Select
    ActiveCell.FormulaR1C1 = "=CONCATENATE(R1C11,RC[-2],R1C12,RC[-1])"
    Range("M3").Select
    Columns("M:M").ColumnWidth = 11.71
    Range("M2").Select
    Selection.AutoFill Destination:=Range("M2:M18001")
    Range("M2:M18001").Select
    Range("N2").Select
    ActiveCell.FormulaR1C1 = "=RC[-1]=R[1]C[-1]"
    Range("N2").Select
    Selection.AutoFill Destination:=Range("N2:N18001")
    Range("N2:N18001").Select
    Columns("N:N").ColumnWidth = 11.29
    Columns("N:N").ColumnWidth = 14
    Columns("N:N").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Columns("N:N").Select
    Selection.Replace what:="VERDADEIRO", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace what:="FALSO", Replacement:="1", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("O2").Select
End Sub



============================================================
MODULE: LOGIN.frm
============================================================
Attribute VB_Name = "LOGIN"
Attribute VB_Base = "0{7A2066D0-3958-4F9A-A386-6A14D6EF32EB}{DE16E0B4-35E6-4C97-9EAA-40D5C66EE419}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Workbook_Open()
    Application.Visible = False
    
    

End Sub

Private Sub botao_cancelar_Click()
resposta = MsgBox("Deseja realmente sair?", vbYesNo, "Cadastro de clientes")
    If resposta = vbYes Then
    ActiveWorkbook.Save
    Application.Quit
    Else
    Exit Sub
    End If
    
    
End Sub

Private Sub botao_ok_Click()
Windows("ExploTrack exe").Activate
Worksheets("Plan2").Select
    If caixa_usuario = "" Then
    MsgBox "Digite o nome do Usuário"
    caixa_usuario.SetFocus
    Exit Sub
    
    Else
        If caixa_senha = "" Then
    MsgBox "Digite a senha"
    caixa_senha.SetFocus
    Exit Sub
        
        End If
    End If
    
    'varrer planilha
    
Linha = 1
    
Do
Linha = Linha + 1

    nome = Cells(Linha, 1)
    senha = CStr(Cells(Linha, 2))
    
    
    If caixa_usuario = nome And caixa_senha = senha Then
        Unload LOGIN
        inicio.Show
         
    End If
        
Loop Until (caixa_usuario = nome And caixa_senha = senha) Or Cells(Linha, 1) = ""
                
        
If caixa_usuario <> nome And caixa_senha <> senha Then
 
        MsgBox "usuario ou senha incorretos!"
        caixa_usuario = ""
        caixa_senha = ""
        
End If
        
        
    
End Sub

Private Sub CommandButton1_Click()
resposta = MsgBox("Deseja realmente sair?", vbYesNo, "Cadastro de clientes")
    If resposta = vbYes Then
    ActiveWorkbook.Save
    Application.Quit
    Else
    Exit Sub
    End If
End Sub

Private Sub CommandButton2_Click()
Windows("ExploTrack exe").Activate
Worksheets("Desenvolvedor").Select
    If caixa_usuario = "" Then
    MsgBox "Digite o nome do Usuário"
    caixa_usuario.SetFocus
    Exit Sub
    
    Else
        If caixa_senha = "" Then
    MsgBox "Digite a senha"
    caixa_senha.SetFocus
    Exit Sub
        
        End If
    End If
    
    'varrer planilha
    
Linha = 1
Do
  Linha = Linha + 1
    
    nome = Cells(Linha, 1)
    senha = CStr(Cells(Linha, 2))
    
    
    If caixa_usuario = nome And caixa_senha = senha Then
        Application.Visible = True
         
        End If
        
Loop Until (caixa_usuario = nome And caixa_senha = senha) Or Cells(Linha, 1) = ""

If caixa_usuario <> nome And caixa_senha <> senha Then
                
    MsgBox "usuario ou senha incorretos!"
    caixa_usuario = ""
    caixa_senha = ""
    
End If
End Sub

Private Sub Label4_Click()

End Sub
Private Sub UserForm_QueryClose _
   (Cancel As Integer, CloseMode As Integer)
   If CloseMode = vbFormControlMenu Then
       MsgBox "Fechar de maneira correta (botão SAIR)", vbCritical, "AVISO"
        Cancel = True
   End If
End Sub

Private Sub UserForm_Click()

End Sub



============================================================
MODULE: cadastro.frm
============================================================
Attribute VB_Name = "cadastro"
Attribute VB_Base = "0{60A46D2A-C14F-4944-8DAF-54465D738F90}{8517226B-8D74-480A-8833-7D35A534A4EF}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub acessar_inserir_Click()
Unload cadastro
venda.Show
End Sub

Private Sub botao_Click()
Unload cadastro
creditos_venda.Show
End Sub

Private Sub botao_excluir_Click()

If codigo = "" Or quantidade_cad = "" Or precocusto = "" Or precovenda = "" Or descricao_cad = "" Then
            
    MsgBox "FORMULARIO NÃO PREENCHIDO!"
    
Else
Worksheets("Bancodados").Select
Totalregistro = Worksheets("Bancodados").UsedRange.Rows.Count

'''' Editar se ja estiver cadastrado
For i = 2 To Totalregistro
    
    If codigo.Text = Cells(i, 1) Then
    
        Sheets("Bancodados").Rows(i).Select
        Selection.Delete Shift:=xlUp
    
    End If
        
        Next
        
MsgBox "Produto excluido!"

''''''''''''''''''''''''''''''''''''''''''''''''''''''' proximo codigo
Linha = 1
valor = 0
Do

Linha = Linha + 1


If Cells(Linha, 1).Value > valor Then

valor = Cells(Linha, 1).Value

End If
Loop Until Cells(Linha, 1).Value = ""

codigo = valor + 1
''''''''''''''''''''''''''''''''''''''''''''''''''''

'limpar caixas
quantidade_cad = ""
precocusto = ""
precovenda = ""
descricao_cad = ""

ActiveWorkbook.Save

'voltar cursor para caixa codigo
editar_cad.Enabled = False
botao_excluir.Enabled = False
botao_salvar.Enabled = True
quantidade_cad.SetFocus

'''''''''''''''''''''''''''''''''''''' somar valor custo e venda total

Linha = 1
valor = 0
valor1 = 0

Do

Linha = Linha + 1

valor = valor + (Cells(Linha, 3).Value * Cells(Linha, 2).Value)
valor1 = valor1 + (Cells(Linha, 4).Value * Cells(Linha, 2).Value)

Loop Until Cells(Linha, 3).Value = ""

Text_total_custo = Format(valor, "0.00")
Text_total_venda = Format(valor1, "0.00")

''''''''''''''''''''''''''''''''''''''''''''''' listbox
Linha = 2
linhalistbox = Linha - 2

listbox_cadastro.Clear
Do While Sheets("Bancodados").Cells(Linha, 1) <> ""


        
    With Me.listbox_cadastro
     .AddItem
        .List(linhalistbox, 0) = Sheets("Bancodados").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("Bancodados").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("Bancodados").Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets("Bancodados").Cells(Linha, 4)
        .List(linhalistbox, 4) = Sheets("Bancodados").Cells(Linha, 5)
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop
''''''''''''''''''''''''''''''''''''''''''''''''''''''


End If

End Sub

Private Sub botao_fechar_Click()
Unload cadastro
LOGIN.Show
End Sub

Private Sub botao_salvar_Click()


If codigo = "" Or quantidade_cad = "" Or precocusto = "" Or precovenda = "" Or descricao_cad = "" Then
            
    MsgBox "FORMULARIO NÃO PREENCHIDO!"
    
Else

Worksheets("Bancodados").Select
Totalregistro = Worksheets("Bancodados").UsedRange.Rows.Count


Totalregistro = Worksheets("Bancodados").UsedRange.Rows.Count + 1


'aqui começa a gravação dos dados no fomulario
Cells(Totalregistro, 1) = codigo.Value
Cells(Totalregistro, 2) = quantidade_cad.Value
Cells(Totalregistro, 3) = precocusto.Value
Cells(Totalregistro, 4) = precovenda.Value
Cells(Totalregistro, 5) = descricao_cad.Value
Cells(Totalregistro, 6) = Date

''''''''''''''''''''''''''''''''''''''''''''''''''''''' proximo codigo
Linha = 1
valor = 0
Do

Linha = Linha + 1


If Cells(Linha, 1).Value > valor Then

valor = Cells(Linha, 1).Value

End If
Loop Until Cells(Linha, 1).Value = ""

codigo = valor + 1
''''''''''''''''''''''''''''''''''''''''''''''''''''


'''''''''''''''''''''''''''''''''''''' somar valor custo e venda total

Linha = 1
valor = 0
valor1 = 0

Do

Linha = Linha + 1

valor = valor + (Cells(Linha, 3).Value * Cells(Linha, 2).Value)
valor1 = valor1 + (Cells(Linha, 4).Value * Cells(Linha, 2).Value)

Loop Until Cells(Linha, 3).Value = ""

Text_total_custo = Format(valor, "0.00")
Text_total_venda = Format(valor1, "0.00")


''''''''''''''''''''''''''''''''''''''''''''''' listbox
Linha = 2
linhalistbox = Linha - 2

listbox_cadastro.Clear

Do While Sheets("Bancodados").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_cadastro
     .AddItem
        .List(linhalistbox, 0) = Sheets("Bancodados").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("Bancodados").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("Bancodados").Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets("Bancodados").Cells(Linha, 4)
        .List(linhalistbox, 4) = Sheets("Bancodados").Cells(Linha, 5)
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop
''''''''''''''''''''''''''''''''''''''''''''''''''''''

ActiveWorkbook.Save
editar_cad.Enabled = False
botao_excluir.Enabled = False
'MsgBox "Dados gravados com sucesso!"
'limpar caixas
quantidade_cad = ""
precocusto = ""
precovenda = ""
descricao_cad = ""

'voltar cursor para caixa codigo
quantidade_cad.SetFocus

End If

End Sub

Private Sub caixa_nome_Change()

End Sub

Private Sub buscar_edit_Click()

End Sub

Private Sub codigo_Change()

If codigo = "" Then

Else
If Not IsNumeric(codigo) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 Linha = 1
valor = 0
Do

Linha = Linha + 1


If Cells(Linha, 1).Value > valor Then

valor = Cells(Linha, 1).Value

End If
Loop Until Cells(Linha, 1).Value = ""

codigo = valor + 1
 
 End If
  End If

'''''
 botao_salvar.Enabled = True
  editar_cad.Enabled = False
botao_excluir.Enabled = False

quantidade_cad = ""
precocusto = ""
precovenda = ""
descricao_cad = ""
 
Worksheets("Bancodados").Select
Totalregistro = Worksheets("Bancodados").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If CStr(codigo.Text) = CStr(Cells(i, 1)) Then
        botao_salvar.Enabled = False
        editar_cad.Enabled = True
        botao_excluir.Enabled = True
        'MsgBox "Produto já cadastrado", vbInformation, "ATENÇÃO"
        quantidade_cad = Cells(i, 2)
        precocusto = Cells(i, 3)
        precovenda = Cells(i, 4)
        descricao_cad = Cells(i, 5)
        
    End If
        
Next



End Sub

Private Sub CommandButton10_Click()
Unload cadastro
parametros.Show
End Sub

Private Sub CommandButton11_Click()
Unload cadastro
inicio.Show
End Sub

Private Sub CommandButton12_Click()
resposta = MsgBox("Deseja realmente sair?", vbYesNo, "ATENÇÃO")
    If resposta = vbYes Then
    ActiveWorkbook.Save
    Application.Quit
    Else
    ActiveWorkbook.Save
    Exit Sub
    End If
End Sub

Private Sub CommandButton13_Click()
Unload cadastro
prazo.Show
End Sub

Private Sub CommandButton9_Click()
Unload cadastro
relatorio.Show
End Sub

Private Sub contagem_inicio_Click()

End Sub

Private Sub descricao_cad_Change()

End Sub

Private Sub editar_cad_Click()
If codigo = "" Or quantidade_cad = "" Or precocusto = "" Or precovenda = "" Or descricao_cad = "" Then
            
    MsgBox "FORMULARIO NÃO PREENCHIDO!"
    
Else

Worksheets("Bancodados").Select
Totalregistro = Worksheets("Bancodados").UsedRange.Rows.Count

'''' Editar se ja estiver cadastrado
For i = 2 To Totalregistro
    
    If codigo.Text = Cells(i, 1) Then
    
        Cells(i, 1) = codigo.Value
        Cells(i, 2) = quantidade_cad.Value
        Cells(i, 3) = precocusto.Value
        Cells(i, 4) = precovenda.Value
        Cells(i, 5) = descricao_cad.Value
    
    End If
        
        Next

''''

''''''''''''''''''''''''''''''''''''''''''''''''''''''' proximo codigo
Linha = 1
valor = 0
Do

Linha = Linha + 1


If Cells(Linha, 1).Value > valor Then

valor = Cells(Linha, 1).Value

End If
Loop Until Cells(Linha, 1).Value = ""

codigo = valor + 1
''''''''''''''''''''''''''''''''''''''''''''''''''''

'MsgBox "Dados Editados com sucesso!"
'limpar caixas
quantidade_cad = ""
precocusto = ""
precovenda = ""
descricao_cad = ""

ActiveWorkbook.Save

'voltar cursor para caixa codigo
editar_cad.Enabled = False
botao_excluir.Enabled = False
quantidade_cad.SetFocus

'''''''''''''''''''''''''''''''''''''' somar valor custo e venda total

Linha = 1
valor = 0
valor1 = 0

Do

Linha = Linha + 1

valor = valor + (Cells(Linha, 3).Value * Cells(Linha, 2).Value)
valor1 = valor1 + (Cells(Linha, 4).Value * Cells(Linha, 2).Value)

Loop Until Cells(Linha, 3).Value = ""

Text_total_custo = Format(valor, "0.00")
Text_total_venda = Format(valor1, "0.00")


''''''''''''''''''''''''''''''''''''''''''''''' listbox
Linha = 2
linhalistbox = Linha - 2

listbox_cadastro.Clear

Do While Sheets("Bancodados").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_cadastro
     .AddItem
        .List(linhalistbox, 0) = Sheets("Bancodados").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("Bancodados").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("Bancodados").Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets("Bancodados").Cells(Linha, 4)
        .List(linhalistbox, 4) = Sheets("Bancodados").Cells(Linha, 5)
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop
''''''''''''''''''''''''''''''''''''''''''''''''''''''


End If

End Sub

Private Sub Image2_Click()
Application.Visible = False
ActiveWorkbook.FollowHyperlink Address:="https://www.researchgate.net/profile/Rodrigo_Cupertino_Bernardes", NewWindow:=True
Unload Me
End Sub

Private Sub Label1_Click()

End Sub

Private Sub Label2_Click()

End Sub

Private Sub Lattes_Click()
Application.Visible = False
ActiveWorkbook.FollowHyperlink Address:="http://buscatextual.cnpq.br/buscatextual/visualizacv.do?id=K4319641E3", NewWindow:=True
Unload Me
End Sub

Private Sub Label29_Click()

End Sub

Private Sub Label31_Click()

End Sub

Private Sub listbox_cadastro_Click()

End Sub

Private Sub precocusto_Change()
If precocusto = "" Then

Else
If Not IsNumeric(precocusto) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 precocusto = ""
 
 End If
  End If
End Sub

Private Sub precovenda_Change()
If precovenda = "" Then

Else
If Not IsNumeric(precovenda) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 precovenda = ""
 
 End If
  End If
End Sub

Private Sub quantidade_cad_Change()
If quantidade_cad = "" Then

Else
If Not IsNumeric(quantidade_cad) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 quantidade_cad = ""
 
 End If
  End If
End Sub

Private Sub TextBox1_Change()

End Sub

Private Sub senha_cad_Change()

Text_total_custo.Visible = False
Text_total_venda.Visible = False


listbox_cadastro.Visible = False


Worksheets("Desenvolvedor").Select
        
    'varrer planilha
    
Linha = 1
Do
  Linha = Linha + 1
    
    
    senha_ = CStr(Cells(Linha, 2))
    
    
    If senha_ = senha_cad Then
    
        Text_total_custo.Visible = True
        Text_total_venda.Visible = True
        listbox_cadastro.Visible = True
        
        
        

         
    End If
        
Loop Until (senha_cad = senha) Or Cells(Linha, 1) = ""




End Sub


Private Sub UserForm_Click()

End Sub
Private Sub UserForm_QueryClose _
   (Cancel As Integer, CloseMode As Integer)
   If CloseMode = vbFormControlMenu Then
       MsgBox "Fechar de maneira correta (botão SAIR)", vbCritical, "AVISO"
        Cancel = True
   End If
End Sub

Private Sub UserForm_Initialize()

Text_total_custo.Visible = False
Text_total_venda.Visible = False
listbox_cadastro.Visible = False


editar_cad.Enabled = False
botao_excluir.Enabled = False

Worksheets("Bancodados").Select

quantidade_cad.SetFocus

Linha = 1
valor = 0
Do

Linha = Linha + 1


If Cells(Linha, 1).Value > valor Then

valor = Cells(Linha, 1).Value

End If
Loop Until Cells(Linha, 1).Value = ""

codigo = valor + 1

'''''''''''''''''''''''''''''''''''''' somar valor custo e venda total

Linha = 1
valor = 0
valor1 = 0

Do

Linha = Linha + 1

valor = valor + (Cells(Linha, 3).Value * Cells(Linha, 2).Value)
valor1 = valor1 + (Cells(Linha, 4).Value * Cells(Linha, 2).Value)

Loop Until Cells(Linha, 3).Value = ""

Text_total_custo = Format(valor, "0.00")
Text_total_venda = Format(valor1, "0.00")



''''''''''''''''''''''''''''''''''''''''''''''' listbox
Linha = 2
linhalistbox = Linha - 2

listbox_cadastro.Clear


Do While Sheets("Bancodados").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_cadastro
     .AddItem
        .List(linhalistbox, 0) = Sheets("Bancodados").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("Bancodados").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("Bancodados").Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets("Bancodados").Cells(Linha, 4)
        .List(linhalistbox, 4) = Sheets("Bancodados").Cells(Linha, 5)
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop




End Sub



============================================================
MODULE: Plan2.cls
============================================================
Attribute VB_Name = "Plan2"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Plan3.cls
============================================================
Attribute VB_Name = "Plan3"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Planilha6.cls
============================================================
Attribute VB_Name = "Planilha6"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Módulo22.bas
============================================================
Attribute VB_Name = "Módulo22"



============================================================
MODULE: Módulo6.bas
============================================================
Attribute VB_Name = "Módulo6"
Sub igual()
Attribute igual.VB_ProcData.VB_Invoke_Func = " \n14"
'
' igual Macro
'

'
    Columns("N:N").Select
    Selection.ClearContents
    Range("N2").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=R[1]C[-1],"""",""1"")"
    Range("N2").Select
    Selection.AutoFill Destination:=Range("N2:N18001")
    Range("N2:N18001").Select
    Columns("N:N").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.TextToColumns Destination:=Range("N1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(1, 1), TrailingMinusNumbers:=True
End Sub
Sub sublat()
Attribute sublat.VB_ProcData.VB_Invoke_Func = " \n14"
'
' sublat Macro
'

'
    Range("P2").Select
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 490
    ActiveWindow.ScrollRow = 653
    ActiveWindow.ScrollRow = 734
    ActiveWindow.ScrollRow = 775
    ActiveWindow.ScrollRow = 979
    ActiveWindow.ScrollRow = 938
    ActiveWindow.ScrollRow = 979
    ActiveWindow.ScrollRow = 1020
    ActiveWindow.ScrollRow = 1060
    ActiveWindow.ScrollRow = 1101
    ActiveWindow.ScrollRow = 1142
    ActiveWindow.ScrollRow = 1101
    ActiveWindow.ScrollRow = 1060
    ActiveWindow.ScrollRow = 1020
    ActiveWindow.ScrollRow = 979
    ActiveWindow.ScrollRow = 938
    ActiveWindow.ScrollRow = 897
    ActiveWindow.ScrollRow = 898
    ActiveWindow.ScrollRow = 897
    ActiveWindow.ScrollRow = 857
    ActiveWindow.ScrollRow = 816
    ActiveWindow.ScrollRow = 734
    ActiveWindow.ScrollRow = 694
    ActiveWindow.ScrollRow = 653
    ActiveWindow.ScrollRow = 694
    ActiveWindow.ScrollRow = 816
    ActiveWindow.ScrollRow = 857
    ActiveWindow.ScrollRow = 1020
    ActiveWindow.ScrollRow = 1142
    ActiveWindow.ScrollRow = 1223
    ActiveWindow.ScrollRow = 1346
    ActiveWindow.ScrollRow = 1427
    ActiveWindow.ScrollRow = 1468
    ActiveWindow.ScrollRow = 1509
    ActiveWindow.ScrollRow = 1550
    ActiveWindow.ScrollRow = 1590
    ActiveWindow.ScrollRow = 1591
    ActiveWindow.SmallScroll Down:=-153
    Range("P2:Q1454").Select
    ActiveWindow.SmallScroll Down:=-51
    Selection.Replace what:="lat", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace what:="long", Replacement:=";", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
End Sub
Sub quatro()
Attribute quatro.VB_ProcData.VB_Invoke_Func = " \n14"
'
' quatro Macro
'

'
    Columns("P:P").Select
    Selection.TextToColumns Destination:=Range("P1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(1, 1), TrailingMinusNumbers:=True
    Selection.TextToColumns Destination:=Range("P1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=True, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True
    Columns("P:R").Select
    Selection.Copy
    Workbooks.Add
    ActiveSheet.Paste
    Range("A1").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "x"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = "y"
    Range("C1").Select
    ActiveCell.FormulaR1C1 = "exploracao"
    Range("E3").Select
    ActiveCell.FormulaR1C1 = _
        "Pronto! Esse são os dados limpos pronto para construir seu gráfico de exploração."
    Range("E3:L3").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = -0.249977111117893
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .Color = -16776961
        .TintAndShade = 0
    End With
    With Selection.Font
        .Color = -16711681
        .TintAndShade = 0
    End With
    Range("F6").Select
    Windows("ExploTrack exe.xlsm").Activate
End Sub



============================================================
MODULE: Módulo11.bas
============================================================
Attribute VB_Name = "Módulo11"
Sub rodrigoexportar()
Attribute rodrigoexportar.VB_ProcData.VB_Invoke_Func = "j\n14"
'
' rodrigoexportar Macro
'
' Atalho do teclado: Ctrl+j
'
    nomepasta = Cells(1, 1)
    Windows(nomepasta).Activate
    Columns("A:C").Select
    Application.FileDialog(msoFileDialogSaveAs).AllowMultiSelect = False
escolha = Application.FileDialog(msoFileDialogSaveAs).Show
If escolha <> 0 Then
endereco = Application.FileDialog(msoFileDialogSaveAs).SelectedItems(1)

    ActiveWorkbook.SaveAs Filename:=endereco, FileFormat:=xlText, _
        CreateBackup:=False
    
    ActiveWindow.Close
        
    Windows("ExploTrack exe.xlsm").Activate
    
    End If
End Sub





============================================================
MODULE: Módulo10.bas
============================================================
Attribute VB_Name = "Módulo10"
Sub contagem()
'
' contagem Macro
'
' Atalho do teclado: Ctrl+g

Worksheets("Plan1").Select

    Columns("K:K").Select
    Selection.Delete Shift:=xlToLeft
    Range("K1").Select
    ActiveCell.FormulaR1C1 = "lat"
    Range("L1").Select
    ActiveCell.FormulaR1C1 = "long"
    Range("M1").Select
    ActiveCell.FormulaR1C1 = "nova"
    Range("M2").Select
    ActiveCell.FormulaR1C1 = "=CONCATENATE(R1C11,RC[-2],R1C12,RC[-1])"
    Range("M3").Select
    Columns("M:M").ColumnWidth = 11.71
    Range("M2").Select
    Selection.AutoFill Destination:=Range("M2:M18001")
    Range("M2:M18001").Select
    Range("N2").Select
    ActiveCell.FormulaR1C1 = "=RC[-1]=R[1]C[-1]"
    Range("N2").Select
    Selection.AutoFill Destination:=Range("N2:N18001")
    Range("N2:N18001").Select
    Columns("N:N").ColumnWidth = 11.29
    Columns("N:N").ColumnWidth = 14
    Columns("N:N").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Columns("N:N").Select
    Selection.Replace what:="VERDADEIRO", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace what:="FALSO", Replacement:="1", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("O2").Select


        Columns("N:N").Select
    Selection.ClearContents
    Range("N2").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=R[1]C[-1],"""",""1"")"
    Range("N2").Select
    Selection.AutoFill Destination:=Range("N2:N18001")
    Range("N2:N18001").Select
    Columns("N:N").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.TextToColumns Destination:=Range("N1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(1, 1), TrailingMinusNumbers:=True
        
        
        
        ultimalinha = Plan1.Cells(Rows.Count, "n").End(xlUp).Row
    Lin = 2
    For i = 2 To ultimalinha
        If Plan1.Cells(i, 14) <> "VERDADEIRO" Then
            
            Plan1.Cells(Lin, 16) = Plan1.Cells(i, 13)
            Plan1.Cells(Lin, 17) = Plan1.Cells(i, 14)
            
            Lin = Lin + 1
        End If
    
    Next
    
    
    Columns("K:K").Select
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Range("K1").Select
    ActiveCell.FormulaR1C1 = "nova"
    Range("L1").Select
    ActiveCell.FormulaR1C1 = "n"
    Range("K2:L2").Select
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 408
    ActiveWindow.ScrollRow = 734
    ActiveWindow.ScrollRow = 1101
    ActiveWindow.ScrollRow = 1223
    ActiveWindow.ScrollRow = 1631
    ActiveWindow.ScrollRow = 1957
    ActiveWindow.ScrollRow = 2406
    ActiveWindow.ScrollRow = 2446
    ActiveWindow.ScrollRow = 2650
    ActiveWindow.ScrollRow = 3017
    ActiveWindow.ScrollRow = 3140
    ActiveWindow.ScrollRow = 3262
    ActiveWindow.ScrollRow = 3303
    ActiveWindow.ScrollRow = 3669
    ActiveWindow.ScrollRow = 3833
    ActiveWindow.ScrollRow = 4159
    ActiveWindow.ScrollRow = 4240
    ActiveWindow.ScrollRow = 4526
    ActiveWindow.ScrollRow = 4607
    ActiveWindow.ScrollRow = 4729
    ActiveWindow.ScrollRow = 4892
    ActiveWindow.ScrollRow = 5015
    ActiveWindow.ScrollRow = 5463
    ActiveWindow.ScrollRow = 5749
    ActiveWindow.ScrollRow = 6319
    ActiveWindow.ScrollRow = 6686
    ActiveWindow.ScrollRow = 6890
    ActiveWindow.ScrollRow = 7298
    ActiveWindow.ScrollRow = 7420
    ActiveWindow.ScrollRow = 7787
    ActiveWindow.ScrollRow = 8031
    ActiveWindow.ScrollRow = 8398
    ActiveWindow.ScrollRow = 8439
    ActiveWindow.ScrollRow = 8480
    ActiveWindow.ScrollRow = 8521
    ActiveWindow.ScrollRow = 8847
    ActiveWindow.ScrollRow = 9091
    ActiveWindow.ScrollRow = 9377
    ActiveWindow.ScrollRow = 9499
    ActiveWindow.ScrollRow = 9581
    ActiveWindow.ScrollRow = 10029
    ActiveWindow.ScrollRow = 10111
    ActiveWindow.ScrollRow = 10681
    ActiveWindow.ScrollRow = 10885
    ActiveWindow.ScrollRow = 10967
    ActiveWindow.ScrollRow = 11293
    ActiveWindow.ScrollRow = 11537
    ActiveWindow.ScrollRow = 11619
    ActiveWindow.ScrollRow = 12067
    ActiveWindow.ScrollRow = 12149
    ActiveWindow.ScrollRow = 12108
    ActiveWindow.ScrollRow = 11904
    ActiveWindow.ScrollRow = 11619
    ActiveWindow.ScrollRow = 11578
    ActiveWindow.ScrollRow = 11537
    ActiveWindow.ScrollRow = 11293
    ActiveWindow.ScrollRow = 11252
    ActiveWindow.ScrollRow = 11211
    ActiveWindow.ScrollRow = 11130
    ActiveWindow.ScrollRow = 11089
    ActiveWindow.ScrollRow = 11130
    ActiveWindow.ScrollRow = 11252
    ActiveWindow.ScrollRow = 11334
    ActiveWindow.ScrollRow = 11293
    Range("K2:L11311").Select
    ActiveWindow.ScrollRow = 11252
    ActiveWindow.ScrollRow = 10885
    ActiveWindow.ScrollRow = 10192
    ActiveWindow.ScrollRow = 9866
    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _
        "Plan1!R1C11:R11311C12", Version:=xlPivotTableVersion15).CreatePivotTable _
        TableDestination:="Plan1!R2C14", TableName:="Tabela dinâmica1", _
        DefaultVersion:=xlPivotTableVersion15
    Sheets("Plan1").Select
    Cells(2, 14).Select
    ActiveWorkbook.ShowPivotTableFieldList = True
    With ActiveSheet.PivotTables("Tabela dinâmica1").PivotFields("n")
        .Orientation = xlColumnField
        .Position = 1
    End With
    With ActiveSheet.PivotTables("Tabela dinâmica1").PivotFields("nova")
        .Orientation = xlRowField
        .Position = 1
    End With
    ActiveSheet.PivotTables("Tabela dinâmica1").AddDataField ActiveSheet. _
        PivotTables("Tabela dinâmica1").PivotFields("n"), "Soma de n", xlSum
    ActiveWorkbook.ShowPivotTableFieldList = False
    Range("N3:O3").Select
    ActiveWindow.ScrollRow = 82
    ActiveWindow.ScrollRow = 164
    ActiveWindow.ScrollRow = 245
    ActiveWindow.ScrollRow = 246
    ActiveWindow.ScrollRow = 245
    ActiveWindow.ScrollRow = 286
    ActiveWindow.ScrollRow = 653
    ActiveWindow.ScrollRow = 694
    ActiveWindow.ScrollRow = 1020
    ActiveWindow.ScrollRow = 1264
    ActiveWindow.ScrollRow = 1427
    ActiveWindow.ScrollRow = 1590
    ActiveWindow.ScrollRow = 1713
    ActiveWindow.ScrollRow = 1753
    ActiveWindow.ScrollRow = 1876
    ActiveWindow.ScrollRow = 1917
    ActiveWindow.ScrollRow = 1957
    ActiveWindow.ScrollRow = 2039
    ActiveWindow.ScrollRow = 2080
    ActiveWindow.ScrollRow = 2120
    ActiveWindow.ScrollRow = 2283
    ActiveWindow.ScrollRow = 2324
    ActiveWindow.ScrollRow = 2406
    ActiveWindow.ScrollRow = 2446
    ActiveWindow.ScrollRow = 2610
    ActiveWindow.ScrollRow = 2650
    ActiveWindow.ScrollRow = 2773
    ActiveWindow.ScrollRow = 3017
    ActiveWindow.ScrollRow = 3221
    ActiveWindow.ScrollRow = 3425
    ActiveWindow.ScrollRow = 3466
    ActiveWindow.ScrollRow = 3669
    ActiveWindow.ScrollRow = 3710
    ActiveWindow.ScrollRow = 3914
    ActiveWindow.ScrollRow = 4036
    ActiveWindow.ScrollRow = 4118
    ActiveWindow.ScrollRow = 4159
    ActiveWindow.ScrollRow = 4199
    ActiveWindow.ScrollRow = 4281
    ActiveWindow.ScrollRow = 4322
    ActiveWindow.ScrollRow = 4403
    ActiveWindow.ScrollRow = 4607
    ActiveWindow.ScrollRow = 4729
    ActiveWindow.ScrollRow = 4892
    ActiveWindow.ScrollRow = 4933
    ActiveWindow.ScrollRow = 5219
    ActiveWindow.ScrollRow = 5341
    ActiveWindow.ScrollRow = 5504
    ActiveWindow.ScrollRow = 5667
    ActiveWindow.ScrollRow = 5789
    ActiveWindow.ScrollRow = 5871
    ActiveWindow.ScrollRow = 6156
    ActiveWindow.ScrollRow = 6279
    ActiveWindow.ScrollRow = 6442
    ActiveWindow.ScrollRow = 6523
    ActiveWindow.ScrollRow = 6605
    ActiveWindow.ScrollRow = 6768
    ActiveWindow.ScrollRow = 6890
    ActiveWindow.ScrollRow = 7053
    ActiveWindow.ScrollRow = 7175
    ActiveWindow.ScrollRow = 7420
    ActiveWindow.ScrollRow = 7583
    ActiveWindow.ScrollRow = 7665
    ActiveWindow.ScrollRow = 7787
    ActiveWindow.ScrollRow = 7828
    ActiveWindow.ScrollRow = 7787
    ActiveWindow.ScrollRow = 7420
    ActiveWindow.ScrollRow = 7379
    ActiveWindow.ScrollRow = 7380
    ActiveWindow.SmallScroll Down:=-465
    Range("N3:O6927").Select
    Selection.Copy
    ActiveWindow.ScrollRow = 6931
    ActiveWindow.ScrollRow = 6890
    ActiveWindow.ScrollRow = 6401
    ActiveWindow.ScrollRow = 5096
    ActiveWindow.ScrollRow = 4118
    ActiveWindow.ScrollRow = 2243
    ActiveWindow.ScrollRow = 1876
    ActiveWindow.ScrollRow = 1835
    ActiveWindow.ScrollRow = 1142
    ActiveWindow.ScrollRow = 816
    ActiveWindow.ScrollRow = 612
    ActiveWindow.ScrollRow = 449
    ActiveWindow.ScrollRow = 327
    ActiveWindow.ScrollRow = 204
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 1
    Range("P2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Columns("Q:Q").Select
    Application.CutCopyMode = False
    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("P:P").Select
    
    
    Range("P2").Select
    ActiveWindow.ScrollRow = 41
    ActiveWindow.ScrollRow = 490
    ActiveWindow.ScrollRow = 653
    ActiveWindow.ScrollRow = 734
    ActiveWindow.ScrollRow = 775
    ActiveWindow.ScrollRow = 979
    ActiveWindow.ScrollRow = 938
    ActiveWindow.ScrollRow = 979
    ActiveWindow.ScrollRow = 1020
    ActiveWindow.ScrollRow = 1060
    ActiveWindow.ScrollRow = 1101
    ActiveWindow.ScrollRow = 1142
    ActiveWindow.ScrollRow = 1101
    ActiveWindow.ScrollRow = 1060
    ActiveWindow.ScrollRow = 1020
    ActiveWindow.ScrollRow = 979
    ActiveWindow.ScrollRow = 938
    ActiveWindow.ScrollRow = 897
    ActiveWindow.ScrollRow = 898
    ActiveWindow.ScrollRow = 897
    ActiveWindow.ScrollRow = 857
    ActiveWindow.ScrollRow = 816
    ActiveWindow.ScrollRow = 734
    ActiveWindow.ScrollRow = 694
    ActiveWindow.ScrollRow = 653
    ActiveWindow.ScrollRow = 694
    ActiveWindow.ScrollRow = 816
    ActiveWindow.ScrollRow = 857
    ActiveWindow.ScrollRow = 1020
    ActiveWindow.ScrollRow = 1142
    ActiveWindow.ScrollRow = 1223
    ActiveWindow.ScrollRow = 1346
    ActiveWindow.ScrollRow = 1427
    ActiveWindow.ScrollRow = 1468
    ActiveWindow.ScrollRow = 1509
    ActiveWindow.ScrollRow = 1550
    ActiveWindow.ScrollRow = 1590
    ActiveWindow.ScrollRow = 1591
    ActiveWindow.SmallScroll Down:=-153
    Range("P2:Q18000").Select
    ActiveWindow.SmallScroll Down:=-51
    Selection.Replace what:="lat", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace what:="long", Replacement:=";", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        
        Selection.Replace what:="Total Geral", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        Selection.Replace what:="(vazio)", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        Selection.Replace what:="(vazio)", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
End Sub




============================================================
MODULE: Módulo5.bas
============================================================
Attribute VB_Name = "Módulo5"



============================================================
MODULE: Planilha5.cls
============================================================
Attribute VB_Name = "Planilha5"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Planilha7.cls
============================================================
Attribute VB_Name = "Planilha7"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: inicio.frm
============================================================
Attribute VB_Name = "inicio"
Attribute VB_Base = "0{811D9E3F-CFF8-4F05-9D06-0849ABB53515}{02897673-02F4-419C-9714-F7E2AB52D7C4}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub acessar_inserir_Click()
Unload inicio
venda.Show
End Sub

Private Sub botao_Click()
Unload inicio
creditos_venda.Show
End Sub

Private Sub CommandButton10_Click()
Unload inicio
parametros.Show
End Sub

Private Sub CommandButton11_Click()

End Sub

Private Sub CommandButton12_Click()
resposta = MsgBox("Deseja realmente sair?", vbYesNo, "ATENÇÃO")
    If resposta = vbYes Then
    ActiveWorkbook.Save
    Application.Quit
    Else
    ActiveWorkbook.Save
    Exit Sub
    End If
End Sub

Private Sub CommandButton13_Click()
Unload inicio
prazo.Show
End Sub

Private Sub CommandButton8_Click()
Unload inicio
LOGIN.Show
End Sub

Private Sub CommandButton9_Click()
Unload inicio
relatorio.Show
End Sub

Private Sub contagem_inicio_Click()
Unload inicio
acess_cadastro.Show
End Sub



Private Sub expdatabotao_Click()
Unload inicio
expdata.Show
End Sub

Private Sub Image2_Click()
Application.Visible = False
ActiveWorkbook.FollowHyperlink Address:="https://www.researchgate.net/profile/Rodrigo_Cupertino_Bernardes", NewWindow:=True
Unload Me
End Sub

Private Sub Lattes_Click()
Application.Visible = False
ActiveWorkbook.FollowHyperlink Address:="http://buscatextual.cnpq.br/buscatextual/visualizacv.do?id=K4319641E3", NewWindow:=True
Unload Me
End Sub
Private Sub UserForm_QueryClose _
   (Cancel As Integer, CloseMode As Integer)
   If CloseMode = vbFormControlMenu Then
       MsgBox "Fechar de maneira correta (botão SAIR)", vbCritical, "AVISO"
        Cancel = True
   End If
End Sub

Private Sub UserForm_Click()

End Sub



============================================================
MODULE: creditos_venda.frm
============================================================
Attribute VB_Name = "creditos_venda"
Attribute VB_Base = "0{8C4DE0EF-027A-4AA7-AD0B-00CA39BFEE96}{9C339576-338A-46DC-A62B-AD205D6C7E68}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub codigo_Change()

End Sub

Private Sub codigo_credito_Change()
 
Worksheets("Bancodados").Select
Totalregistro = Worksheets("Bancodados").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If codigo_credito.Text = Cells(i, 1) Then
        
               
        preco_credito = Cells(i, 4)
        
        
    End If
        
Next

End Sub

Private Sub cod_troca_Change()

If cod_troca = "" Then

descricaot = ""
quantidadet = ""
precot = ""

Else


descricaot = ""
quantidadet = ""
precot = ""

If IsNumeric(cod_troca) Then

Worksheets("Bancodados").Select
Totalregistro = Worksheets("Bancodados").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If CStr(cod_troca.Text) = CStr(Cells(i, 1)) Then
        lanca_troca.Enabled = True
        
        descricaot = Cells(i, 5)
        quantidadet = Cells(i, 2).Value
        precot = Cells(i, 4)
        
    End If
        
Next

Else

    MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
    lanca_troca.Enabled = False

End If

End If

End Sub

Private Sub Label1_Click()

End Sub

Private Sub Label5_Click()

End Sub

Private Sub Label9_Click()

End Sub

Private Sub acessar_inserir_Click()
Unload creditos_venda
venda.Show
End Sub

Private Sub botao_Click()

End Sub

Private Sub CommandButton10_Click()
Unload creditos_venda
parametros.Show
End Sub

Private Sub CommandButton11_Click()
Unload creditos_venda
inicio.Show
End Sub

Private Sub CommandButton12_Click()
resposta = MsgBox("Deseja realmente sair?", vbYesNo, "ATENÇÃO")
    If resposta = vbYes Then
    ActiveWorkbook.Save
    Application.Quit
    Else
    ActiveWorkbook.Save
    Exit Sub
    End If
End Sub

Private Sub CommandButton13_Click()
Unload creditos_venda
prazo.Show
End Sub

Private Sub CommandButton9_Click()
Unload creditos_venda
relatorio.Show
End Sub

Private Sub contagem_inicio_Click()
Unload creditos_venda
acess_cadastro.Show
End Sub

Private Sub cpf_cliente_Change()
'''''
 If cpf_cliente = "" Then
  nome_cliente = ""
  salvar_credito.Enabled = False
    editar_credito.Enabled = False
    excluir_credito.Enabled = False
  valor_credito = Format(0, "R$ 0.00#,##")
 
 Else
 
   
Worksheets("credito_clientes").Select
Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_cliente.Text = Cells(i, 2) Then
        salvar_credito.Enabled = False
        editar_credito.Enabled = True
        excluir_credito.Enabled = True
        
        nome_cliente = Cells(i, 1)
        valor_credito = Format(Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next

End If
End Sub

Private Sub editar_credito_Click()
If nome_cliente = "" Or cpf_cliente = "" Or valor_credito = "" Then
            
    MsgBox "FORMULARIO NÃO PREENCHIDO!"
    
Else

Worksheets("credito_clientes").Select
Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

'''' Editar se ja estiver cadastrado
For i = 2 To Totalregistro
    
    If cpf_cliente.Text = Cells(i, 2) Then
    
        Cells(i, 1) = nome_cliente.Value
        Cells(i, 2) = cpf_cliente.Value
        Cells(i, 3) = valor_credito.Value
        
    
    End If
        
        Next

''''

MsgBox "Dados Editados!"
'limpar caixas

nome_cliente = ""
cpf_cliente = ""

valor_credito = Format(0, "R$ 0.00#,##")

ActiveWorkbook.Save

'voltar cursor para caixa codigo
editar_credito.Enabled = False
excluir_credito.Enabled = False
cpf_cliente.SetFocus


''''''''''''''''''''''''''''''''''''''''''''''' listbox
Linha = 2
linhalistbox = Linha - 2

listbox_credito.Clear


Do While Sheets("credito_clientes").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_credito
     .AddItem
        
        
        .List(linhalistbox, 0) = Sheets("credito_clientes").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("credito_clientes").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("credito_clientes").Cells(Linha, 3)
        
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop

End If
End Sub

Private Sub excluir_credito_Click()
If nome_cliente = "" Or cpf_cliente = "" Or valor_credito = "" Then
            
    MsgBox "FORMULARIO NÃO PREENCHIDO!"
    
Else
Worksheets("credito_clientes").Select
Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

'''' Editar se ja estiver cadastrado
For i = 2 To Totalregistro
    
    If cpf_cliente.Text = Cells(i, 2) Then
    
        Sheets("credito_clientes").Rows(i).Select
        Selection.Delete Shift:=xlUp
    
    End If
        
        Next
        
MsgBox "Credito excluido!"
'limpar caixas
nome_cliente = ""
cpf_cliente = ""

valor_credito = Format(0, "R$ 0.00#,##")

ActiveWorkbook.Save

'voltar cursor para caixa codigo
editar_credito.Enabled = False
excluir_credito.Enabled = False
cpf_cliente.SetFocus


''''''''''''''''''''''''''''''''''''''''''''''' listbox
Linha = 2
linhalistbox = Linha - 2

listbox_credito.Clear


Do While Sheets("credito_clientes").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_credito
     .AddItem
        
        
        .List(linhalistbox, 0) = Sheets("credito_clientes").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("credito_clientes").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("credito_clientes").Cells(Linha, 3)
        
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop

End If
End Sub

Private Sub lanca_troca_Click()

If cod_troca = "" Then
            
    MsgBox "Código da troca NÃO PREENCHIDO!"
    
Else

Worksheets("Bancodados").Select
Totalregistro = Worksheets("Bancodados").UsedRange.Rows.Count

'''' Editar se ja estiver cadastrado
For i = 2 To Totalregistro
    
    If cod_troca.Text = Cells(i, 1) Then
    
        
        Cells(i, 2) = Cells(i, 2) + 1
        
    
    End If
        
        Next




ActiveWorkbook.Save

'voltar cursor para caixa codigo
cod_troca = ""
lanca_troca.Enabled = False
descricaot = ""
quantidadet = ""
precot = ""

cod_troca.SetFocus

End If


End Sub

Private Sub nome_cliente_Change()
'''''
If nome_cliente = "" Then
  cpf_cliente = ""
  valor_credito = Format(0, "R$ 0.00#,##")
 
 Else

 
 
 
Worksheets("credito_clientes").Select
Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If nome_cliente.Text = Cells(i, 1) Then
        salvar_credito.Enabled = False
        editar_credito.Enabled = True
        excluir_credito.Enabled = True
        
        cpf_cliente = Cells(i, 2)
        valor_credito = Format(Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next

End If

End Sub

Private Sub preco_credito_Change()

End Sub

Private Sub salvar_credito_Click()
If Not IsNumeric(valor_credito) Then

 MsgBox "Valor do credito incorreto!"

Else
If nome_cliente = "" Or cpf_cliente = "" Or valor_credito = "" Then
            
    MsgBox "FORMULARIO NÃO PREENCHIDO!"
    
Else

Worksheets("credito_clientes").Select

Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count + 1


'aqui começa a gravação dos dados no fomulario
Cells(Totalregistro, 1) = nome_cliente.Value
Cells(Totalregistro, 2) = cpf_cliente.Value
Cells(Totalregistro, 3) = Format(valor_credito.Value, "0.00#,##")


MsgBox "Dados gravados!"
'limpar caixas

nome_cliente = ""
cpf_cliente = ""


ActiveWorkbook.Save

'voltar cursor para caixa codigo
editar_credito.Enabled = False
excluir_credito.Enabled = False
cpf_cliente.SetFocus
valor_credito = Format(0, "R$ 0.00#,##")



''''''''''''''''''''''''''''''''''''''''''''''' listbox
Linha = 2
linhalistbox = Linha - 2

listbox_credito.Clear


Do While Sheets("credito_clientes").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_credito
     .AddItem
        
        
        .List(linhalistbox, 0) = Sheets("credito_clientes").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("credito_clientes").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("credito_clientes").Cells(Linha, 3)
        
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop

End If
End If

End Sub

Private Sub UserForm_Click()

End Sub
Private Sub UserForm_QueryClose _
   (Cancel As Integer, CloseMode As Integer)
   If CloseMode = vbFormControlMenu Then
       MsgBox "Fechar de maneira correta (botão SAIR)", vbCritical, "AVISO"
        Cancel = True
   End If
End Sub

Private Sub UserForm_Initialize()
valor_credito = Format(0, "R$ 0.00#,##")
salvar_credito.Enabled = False
editar_credito.Enabled = False
excluir_credito.Enabled = False
lanca_troca.Enabled = False

cpf_cliente.SetFocus


''''''''''''''''''''''''''''''''''''''''''''''' listbox
Linha = 2
linhalistbox = Linha - 2

listbox_credito.Clear


Do While Sheets("credito_clientes").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_credito
     .AddItem
        
        
        .List(linhalistbox, 0) = Sheets("credito_clientes").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("credito_clientes").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("credito_clientes").Cells(Linha, 3)
        
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop


End Sub

Private Sub valor_credito_Change()
If valor_credito = "" Then

Else
If Not IsNumeric(valor_credito) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 valor_credito = ""
 
 End If
  End If
  
  salvar_credito.Enabled = False
  
  If valor_credito <> Format(0, "R$ 0.00#,##") And valor_credito <> "" Then
   salvar_credito.Enabled = True
   End If
  
End Sub



============================================================
MODULE: Módulo7.bas
============================================================
Attribute VB_Name = "Módulo7"



============================================================
MODULE: Módulo8.bas
============================================================
Attribute VB_Name = "Módulo8"



============================================================
MODULE: Módulo9.bas
============================================================
Attribute VB_Name = "Módulo9"



============================================================
MODULE: Módulo12.bas
============================================================
Attribute VB_Name = "Módulo12"



============================================================
MODULE: prazo.frm
============================================================
Attribute VB_Name = "prazo"
Attribute VB_Base = "0{4DDE81DC-A200-4522-A7B0-7FD651B4EB10}{4FB20443-48A9-4FE2-A579-6657DDEC3CF6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub abater_prazo_Change()
If abater_prazo = "" Then

Else
If Not IsNumeric(abater_prazo) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 abater_prazo = ""
 
 End If
  End If
End Sub

Private Sub acessar_inserir_Click()
Unload prazo
venda.Show
End Sub

Private Sub botao_abater_Click()


Linha = 2
linhalistbox = Linha - 2

Do While Sheets("prazo").Cells(Linha, 1) <> ""

    If Sheets("prazo").Cells(Linha, 13).Text = cpf_cliente_prazo Then
       
        xy = Sheets("prazo").Cells(Linha, 3).Value - abater_prazo.Value
        Sheets("prazo").Cells(Linha, 3).Value = Format(xy, "0.00#,##")
        
    End If
    
    
    Linha = Linha + 1

Loop



Totalregistro1 = Worksheets("somatorio_vendas").UsedRange.Rows.Count + 1

Totalregistro = Worksheets("prazo").UsedRange.Rows.Count

For i = 2 To Totalregistro

    If cpf_cliente_prazo.Text = Sheets("prazo").Cells(i, 13) Then

    Sheets("somatorio_vendas").Cells(Totalregistro1, 1) = "Prazo"

    Sheets("somatorio_vendas").Cells(Totalregistro1, 2) = 1

    
    Sheets("somatorio_vendas").Cells(Totalregistro1, 3) = Format(abater_prazo.Value, "0.00#,##")

    Sheets("somatorio_vendas").Cells(Totalregistro1, 4) = Date
    Sheets("somatorio_vendas").Cells(Totalregistro1, 5) = Time
    
    Sheets("somatorio_vendas").Cells(Totalregistro1, 6) = Sheets("prazo").Cells(i, 6).Value
    Sheets("somatorio_vendas").Cells(Totalregistro1, 7) = Sheets("prazo").Cells(i, 7).Value
    
    Sheets("somatorio_vendas").Cells(Totalregistro1, 8) = Sheets("prazo").Cells(i, 8).Value
    
    Sheets("somatorio_vendas").Cells(Totalregistro1, 9) = Format(Date, "dd")
    
    Sheets("somatorio_vendas").Cells(Totalregistro1, 10) = Format(Date, "mm")
    
    Sheets("somatorio_vendas").Cells(Totalregistro1, 11) = Format(Date, "yyyy")
    
    Sheets("somatorio_vendas").Cells(Totalregistro1, 12) = Sheets("prazo").Cells(i, 14).Value
    
    Sheets("somatorio_vendas").Cells(Totalregistro1, 13) = Sheets("prazo").Cells(i, 15).Value
       
    
            
 End If
Next

ActiveWorkbook.Save
'''''''''''''''''''''''''''' atualizar listbox
listbox_prazo.Clear

nome_cliente_prazo = ""
cpf_cliente_prazo = ""
abater_prazo = Format(0, "R$ 0.00#,##")

cpf_cliente_prazo.SetFocus

''''''
''''''''''''''''''''''''''''''''''''''''''''''' listbox completo
Linha = 2
linhalistbox = Linha - 2

listbox_prazo2.Clear


Do While Sheets("prazo").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_prazo2
     .AddItem
        .List(linhalistbox, 0) = Sheets("prazo").Cells(Linha, 3)
        .List(linhalistbox, 1) = Sheets("prazo").Cells(Linha, 4)
        .List(linhalistbox, 2) = Sheets("prazo").Cells(Linha, 6)
        .List(linhalistbox, 3) = Sheets("prazo").Cells(Linha, 7)
        .List(linhalistbox, 4) = Sheets("prazo").Cells(Linha, 8)
        .List(linhalistbox, 5) = Sheets("prazo").Cells(Linha, 12)
        .List(linhalistbox, 6) = Sheets("prazo").Cells(Linha, 13)
        .List(linhalistbox, 7) = Sheets("prazo").Cells(Linha, 14)
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop


End Sub

Private Sub CommandButton1_Click()
listbox_prazo.Clear
Linha = 2
linhalistbox = Linha - 2

Do While Sheets("prazo").Cells(Linha, 1) <> ""

    If Sheets("prazo").Cells(Linha, 13).Text = cpf_cliente_prazo Then
    
    
    With Me.listbox_prazo
     .AddItem
        .List(linhalistbox, 0) = Sheets("prazo").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("prazo").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("prazo").Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets("prazo").Cells(Linha, 4)
        .List(linhalistbox, 4) = Format(Sheets("prazo").Cells(Linha, 5).Value, "HH:MM:SS")
        .List(linhalistbox, 5) = Sheets("prazo").Cells(Linha, 6)
        .List(linhalistbox, 6) = Sheets("prazo").Cells(Linha, 7)
        .List(linhalistbox, 7) = Sheets("prazo").Cells(Linha, 8)
        .List(linhalistbox, 8) = Sheets("prazo").Cells(Linha, 12)
        End With
        linhalistbox = linhalistbox + 1
    End If
    
    
    Linha = Linha + 1

Loop
End Sub

Private Sub CommandButton10_Click()
Unload prazo
parametros.Show
End Sub

Private Sub CommandButton11_Click()
Unload prazo
inicio.Show
End Sub

Private Sub CommandButton12_Click()
resposta = MsgBox("Deseja realmente sair?", vbYesNo, "ATENÇÃO")
    If resposta = vbYes Then
    ActiveWorkbook.Save
    Application.Quit
    Else
    ActiveWorkbook.Save
    Exit Sub
    End If
End Sub

Private Sub CommandButton13_Click()

End Sub

Private Sub CommandButton14_Click()
Unload prazo
creditos_venda.Show
End Sub

Private Sub CommandButton15_Click()
Worksheets("prazo_detalhe").Select

Totalregistro = Worksheets("prazo_detalhe").UsedRange.Rows.Count

Dim i As Integer

For i = 1 To Totalregistro

    If cpf_cliente_prazo.Text = Sheets("prazo_detalhe").Cells(i, 9) Then
    
        Sheets("prazo_detalhe").Cells(i, 1).EntireRow.Delete
        i = 1
        
    End If
Next i

ActiveWorkbook.Save

listbox_prazo.Clear
nome_cliente_prazo = ""
cpf_cliente_prazo = ""
abater_prazo = Format(0, "R$ 0.00#,##")
cpf_cliente_prazo.SetFocus
End Sub

Private Sub CommandButton9_Click()
Unload prazo
relatorio.Show
End Sub

Private Sub contagem_inicio_Click()
Unload prazo
acess_cadastro.Show
End Sub

Private Sub cpf_cliente_prazo_Change()

botao_abater.Enabled = False
pago_prazo.Enabled = False

listbox_prazo.Clear
Linha = 2
linhalistbox = Linha - 2



Do While Sheets("prazo_detalhe").Cells(Linha, 1) <> ""

        
    
    valorCelula = Sheets("prazo_detalhe").Cells(Linha, 9).Text
    Sheets("prazo_detalhe").Cells(Linha, 9).NumberFormat = "@"
    Sheets("prazo_detalhe").Cells(Linha, 9) = valorCelula
    
    
    
    
    
    If Sheets("prazo_detalhe").Cells(Linha, 9) = cpf_cliente_prazo Then
    
    'If p_detalhe = cliente_detalhe Then
    
        'nome_cliente_prazo = Sheets("prazo_detalhe").Cells(Linha, 8).Text
        botao_abater.Enabled = True
        pago_prazo.Enabled = True
    
    With Me.listbox_prazo
     .AddItem
        .List(linhalistbox, 0) = Sheets("prazo_detalhe").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("prazo_detalhe").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("prazo_detalhe").Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets("prazo_detalhe").Cells(Linha, 4)
        .List(linhalistbox, 4) = Format(Sheets("prazo_detalhe").Cells(Linha, 5).Value, "HH:MM:SS")
        .List(linhalistbox, 5) = Sheets("prazo_detalhe").Cells(Linha, 7)
        .List(linhalistbox, 6) = Sheets("prazo_detalhe").Cells(Linha, 8)
        .List(linhalistbox, 7) = Sheets("prazo_detalhe").Cells(Linha, 9)
        
        End With
        linhalistbox = linhalistbox + 1
    End If
    
    
    Linha = Linha + 1

Loop

End Sub

Private Sub salvar_credito_Click()

End Sub

Private Sub editar_prazo_Click()

End Sub

Private Sub Label24_Click()

End Sub

Private Sub Label33_Click()

End Sub

Private Sub Label50_Click()

End Sub

Private Sub Label9_Click()

End Sub

Private Sub nome_cliente_prazo_Change()

botao_abater.Enabled = False
pago_prazo.Enabled = False

listbox_prazo.Clear
Linha = 2
linhalistbox = Linha - 2

Do While Sheets("prazo_detalhe").Cells(Linha, 1) <> ""

    If Sheets("prazo_detalhe").Cells(Linha, 8).Text = nome_cliente_prazo Then
        cpf_cliente_prazo = Sheets("prazo_detalhe").Cells(Linha, 9).Text
        botao_abater.Enabled = True
        pago_prazo.Enabled = True
    
    With Me.listbox_prazo
     .AddItem
        .List(linhalistbox, 0) = Sheets("prazo_detalhe").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("prazo_detalhe").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("prazo_detalhe").Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets("prazo_detalhe").Cells(Linha, 4)
        .List(linhalistbox, 4) = Format(Sheets("prazo_detalhe").Cells(Linha, 5).Value, "HH:MM:SS")
        .List(linhalistbox, 5) = Sheets("prazo_detalhe").Cells(Linha, 7)
        .List(linhalistbox, 6) = Sheets("prazo_detalhe").Cells(Linha, 8)
        .List(linhalistbox, 7) = Sheets("prazo_detalhe").Cells(Linha, 9)
        
        End With
        linhalistbox = linhalistbox + 1
    End If
    
    
    Linha = Linha + 1

Loop
End Sub

Private Sub pago_prazo_Click()

Worksheets("prazo").Select

Totalregistro1 = Worksheets("somatorio_vendas").UsedRange.Rows.Count + 1

Totalregistro = Worksheets("prazo").UsedRange.Rows.Count

Dim i As Integer

For i = 2 To Totalregistro

    If cpf_cliente_prazo.Text = Sheets("prazo").Cells(i, 13) Then

        Sheets("somatorio_vendas").Cells(Totalregistro1, 1) = "Prazo"
    
        Sheets("somatorio_vendas").Cells(Totalregistro1, 2) = 1
    
        Sheets("somatorio_vendas").Cells(Totalregistro1, 3).Value = Sheets("prazo").Cells(i, 3).Value
    
        Sheets("somatorio_vendas").Cells(Totalregistro1, 4) = Date
        Sheets("somatorio_vendas").Cells(Totalregistro1, 5) = Time
        
        Sheets("somatorio_vendas").Cells(Totalregistro1, 6) = Sheets("prazo").Cells(i, 6).Value
        Sheets("somatorio_vendas").Cells(Totalregistro1, 7) = Sheets("prazo").Cells(i, 7).Value
        
        Sheets("somatorio_vendas").Cells(Totalregistro1, 8) = Sheets("prazo").Cells(i, 8).Value
        
        Sheets("somatorio_vendas").Cells(Totalregistro1, 9) = Format(Date, "dd")
        
        Sheets("somatorio_vendas").Cells(Totalregistro1, 10) = Format(Date, "mm")
        
        Sheets("somatorio_vendas").Cells(Totalregistro1, 11) = Format(Date, "yyyy")
        Sheets("somatorio_vendas").Cells(Totalregistro1, 12) = Sheets("prazo").Cells(i, 14).Value
        
        Sheets("somatorio_vendas").Cells(Totalregistro1, 13) = Sheets("prazo").Cells(i, 15).Value
        
        
       
    
        
 End If
Next


Worksheets("prazo").Select

Totalregistro = Worksheets("prazo").UsedRange.Rows.Count



For i = 1 To Totalregistro

    If cpf_cliente_prazo.Text = Sheets("prazo").Cells(i, 13) Then
    
        Sheets("prazo").Cells(i, 1).EntireRow.Delete
        
        i = 1
        
    End If
Next i



Worksheets("prazo_detalhe").Select

Totalregistro = Worksheets("prazo_detalhe").UsedRange.Rows.Count


For i = 1 To Totalregistro

    If cpf_cliente_prazo.Text = Sheets("prazo_detalhe").Cells(i, 9) Then
    
        Sheets("prazo_detalhe").Cells(i, 1).EntireRow.Delete
        i = 1
        
    End If
Next i



ActiveWorkbook.Save

listbox_prazo.Clear
nome_cliente_prazo = ""
cpf_cliente_prazo = ""
abater_prazo = Format(0, "R$ 0.00#,##")

cpf_cliente_prazo.SetFocus


''''''''''''''''''''''''''''''''''''''''''''''' listbox completo
Linha = 2
linhalistbox = Linha - 2

listbox_prazo2.Clear


Do While Sheets("prazo").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_prazo2
     .AddItem
        .List(linhalistbox, 0) = Sheets("prazo").Cells(Linha, 3)
        .List(linhalistbox, 1) = Sheets("prazo").Cells(Linha, 4)
        .List(linhalistbox, 2) = Sheets("prazo").Cells(Linha, 6)
        .List(linhalistbox, 3) = Sheets("prazo").Cells(Linha, 7)
        .List(linhalistbox, 4) = Sheets("prazo").Cells(Linha, 8)
        .List(linhalistbox, 5) = Sheets("prazo").Cells(Linha, 12)
        .List(linhalistbox, 6) = Sheets("prazo").Cells(Linha, 13)
        .List(linhalistbox, 7) = Sheets("prazo").Cells(Linha, 14)
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop

End Sub
Private Sub UserForm_QueryClose _
   (Cancel As Integer, CloseMode As Integer)
   If CloseMode = vbFormControlMenu Then
       MsgBox "Fechar de maneira correta (botão SAIR)", vbCritical, "AVISO"
        Cancel = True
   End If
End Sub

Private Sub UserForm_Initialize()
cpf_cliente_prazo.SetFocus

botao_abater.Enabled = False
pago_prazo.Enabled = False

abater_prazo = Format(0, "R$ 0.00#,##")


''''''''''''''''''''''''''''''''''''''''''''''' listbox
Linha = 2
linhalistbox = Linha - 2

listbox_prazo2.Clear


Do While Sheets("prazo").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_prazo2
     .AddItem
        .List(linhalistbox, 0) = Sheets("prazo").Cells(Linha, 3)
        .List(linhalistbox, 1) = Sheets("prazo").Cells(Linha, 4)
        .List(linhalistbox, 2) = Sheets("prazo").Cells(Linha, 6)
        .List(linhalistbox, 3) = Sheets("prazo").Cells(Linha, 7)
        .List(linhalistbox, 4) = Sheets("prazo").Cells(Linha, 8)
        .List(linhalistbox, 5) = Sheets("prazo").Cells(Linha, 12)
        .List(linhalistbox, 6) = Sheets("prazo").Cells(Linha, 13)
        .List(linhalistbox, 7) = Sheets("prazo").Cells(Linha, 14)
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop


End Sub



============================================================
MODULE: Módulo23.bas
============================================================
Attribute VB_Name = "Módulo23"



============================================================
MODULE: Módulo13.bas
============================================================
Attribute VB_Name = "Módulo13"



============================================================
MODULE: Módulo14.bas
============================================================
Attribute VB_Name = "Módulo14"
Sub inserir_expdata()
Attribute inserir_expdata.VB_ProcData.VB_Invoke_Func = "m\n14"
'
' inserir_expdata Macro
'
' Atalho do teclado: Ctrl+m
'
    Windows("ExploTrack exe").Activate

Sheets("expdata").Select
    Range("A1").Select

Dim LibroDestino As Workbook, LibroOrigem As Workbook
Dim CeldaDestino As Range
Dim RetVal As Boolean
Application.ScreenUpdating = False
Set LibroDestino = ActiveWorkbook
Set CeldaDestino = ActiveCell
RetVal = Application.Dialogs(xlDialogOpen).Show("*.xls")
If RetVal = False Then Exit Sub
Set LibroOrigem = ActiveWorkbook
Range(Range("A1"), Range("A1").SpecialCells(xlLastCell)).Copy
LibroDestino.Activate
CeldaDestino.PasteSpecial Paste:=xlValues
LibroOrigem.Close False



Sheets("expdata").Select
    Range("A5").Select


Application.ScreenUpdating = False
Set LibroDestino = ActiveWorkbook
Set CeldaDestino = ActiveCell
RetVal = Application.Dialogs(xlDialogOpen).Show("*.xls")
If RetVal = False Then Exit Sub
Set LibroOrigem = ActiveWorkbook
Range(Range("A1"), Range("A1").SpecialCells(xlLastCell)).Copy
LibroDestino.Activate
CeldaDestino.PasteSpecial Paste:=xlValues
LibroOrigem.Close False
End Sub
Sub processar_expdata()
Attribute processar_expdata.VB_ProcData.VB_Invoke_Func = "r\n14"
'
' processar_expdata Macro
'
' Atalho do teclado: Ctrl+r
'
   Range("C3").Select
    ActiveCell.FormulaR1C1 = "2"
    Range("D3").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E3").Select
    ActiveCell.FormulaR1C1 = "4"
    Range("F3").Select
    ActiveCell.FormulaR1C1 = "5"
    Range("G3").Select
    ActiveCell.FormulaR1C1 = "6"
    Range("H3").Select
    ActiveCell.FormulaR1C1 = "7"
    Range("I3").Select
    ActiveCell.FormulaR1C1 = "8"
    Range("J3").Select
    ActiveCell.FormulaR1C1 = "9"
    Range("K3").Select
    ActiveCell.FormulaR1C1 = "10"
    Range("L3").Select
    ActiveCell.FormulaR1C1 = "11"
    Range("M3").Select
    ActiveCell.FormulaR1C1 = "12"
    Range("N3").Select
    ActiveCell.FormulaR1C1 = "13"
    Range("O3").Select
    ActiveCell.FormulaR1C1 = "14"
    Range("P3").Select
    ActiveCell.FormulaR1C1 = "15"
    Range("Q3").Select
    ActiveCell.FormulaR1C1 = "16"
    Columns("A:B").Select
    Selection.Delete Shift:=xlToLeft
    Rows("4:5").Select
    Selection.Delete Shift:=xlUp
    Rows("1:1").Select
    Selection.Delete Shift:=xlUp
    Range("A4").Select
    ActiveCell.FormulaR1C1 = "=(R[-3]C+R[-1]C)/2"
    Range("A4").Select
    Selection.Copy
    Range("B4").Select
    ActiveSheet.Paste
    Range("A4:B4").Select
    Application.CutCopyMode = False
    Selection.AutoFill Destination:=Range("A4:O4"), Type:=xlFillDefault
    Range("A4:O4").Select
    Selection.Copy
    Range("A5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Rows("3:4").Select
    Application.CutCopyMode = False
    Selection.Delete Shift:=xlUp
    Rows("1:1").Select
    Selection.Delete Shift:=xlUp
    Range("A1:O2").Select
    Selection.Cut
    Range("A3").Select
    ActiveSheet.Paste
    Selection.Copy
    Range("A5").Select
    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
    Rows("2:4").Select
    Application.CutCopyMode = False
    Selection.Delete Shift:=xlUp
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "tubos"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = "tubos"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = "uL/CO2"
    ActiveCell.FormulaR1C1 = "uL de CO2/hora"
    Range("C2").Select
    Columns("B:B").ColumnWidth = 12.71
    Columns("B:B").ColumnWidth = 15
    Range("G12").Select
    
    Rows("16:16").Select
    Selection.ClearContents
    
    
    Range("C2").Select
    ActiveCell.FormulaR1C1 = "=(RC[-1]*1000)"
    Range("C2").Select
    Selection.AutoFill Destination:=Range("C2:C15"), Type:=xlFillDefault
    Range("C2:C15").Select
    Selection.Copy
    Range("B2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("C1:C15").Select
    Application.CutCopyMode = False
    Selection.ClearContents
     Rows("1:1").Select
    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
End Sub



============================================================
MODULE: bemvindo.frm
============================================================
Attribute VB_Name = "bemvindo"
Attribute VB_Base = "0{9A2359E6-5B29-4537-AEF8-9D1CA12041F7}{167CB43F-F837-4C6F-91A4-4C0C005101E7}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Label1_Click()

End Sub

Private Sub Image3_BeforeDragOver(ByVal Cancel As MSForms.ReturnBoolean, ByVal data As MSForms.DataObject, ByVal X As Single, ByVal Y As Single, ByVal DragState As MSForms.fmDragState, ByVal Effect As MSForms.ReturnEffect, ByVal Shift As Integer)

End Sub

Private Sub UserForm_Click()

End Sub

Private Sub UserForm_Initialize()
Application.OnTime Now + TimeValue("00:00:04"), "fechaform"

End Sub





============================================================
MODULE: Módulo15.bas
============================================================
Attribute VB_Name = "Módulo15"
Sub fechaform()
Attribute fechaform.VB_ProcData.VB_Invoke_Func = " \n14"


Unload bemvindo
LOGIN.Show

End Sub



============================================================
MODULE: Módulo16.bas
============================================================
Attribute VB_Name = "Módulo16"
Sub provisoria()
Attribute provisoria.VB_ProcData.VB_Invoke_Func = "S\n14"
'
' provisoria Macro
'
' Atalho do teclado: Ctrl+Shift+S
'
    Columns("K:K").Select
    Selection.Delete Shift:=xlToLeft
    Range("K1").Select
    ActiveCell.FormulaR1C1 = "lat"
    Range("L1").Select
    ActiveCell.FormulaR1C1 = "long"
    Range("M1").Select
    ActiveCell.FormulaR1C1 = "nova"
    Range("M2").Select
    ActiveCell.FormulaR1C1 = "=CONCATENATE(R1C11,RC[-2],R1C12,RC[-1])"
    Range("M2").Select
    Selection.AutoFill Destination:=Range("M2:M18000")
    Range("M2:M18000").Select
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 345
    ActiveWindow.ScrollRow = 474
    ActiveWindow.ScrollRow = 2324
    ActiveWindow.ScrollRow = 3357
    ActiveWindow.ScrollRow = 4132
    ActiveWindow.ScrollRow = 4820
    ActiveWindow.ScrollRow = 5336
    ActiveWindow.ScrollRow = 6068
    ActiveWindow.ScrollRow = 6498
    ActiveWindow.ScrollRow = 6756
    ActiveWindow.ScrollRow = 7015
    ActiveWindow.ScrollRow = 7058
    ActiveWindow.ScrollRow = 7101
    ActiveWindow.ScrollRow = 7660
    ActiveWindow.ScrollRow = 7832
    ActiveWindow.ScrollRow = 8865
    ActiveWindow.ScrollRow = 9037
    ActiveWindow.ScrollRow = 9812
    ActiveWindow.ScrollRow = 10285
    ActiveWindow.ScrollRow = 11103
    ActiveWindow.ScrollRow = 11619
    ActiveWindow.ScrollRow = 13125
    ActiveWindow.ScrollRow = 13383
    ActiveWindow.ScrollRow = 13469
    ActiveWindow.ScrollRow = 13512
    ActiveWindow.ScrollRow = 13556
    ActiveWindow.ScrollRow = 13599
    ActiveWindow.ScrollRow = 13642
    ActiveWindow.ScrollRow = 13685
    ActiveWindow.ScrollRow = 13943
    ActiveWindow.ScrollRow = 13986
    ActiveWindow.ScrollRow = 14115
    ActiveWindow.ScrollRow = 14158
    ActiveWindow.ScrollRow = 14287
    ActiveWindow.ScrollRow = 14330
    ActiveWindow.ScrollRow = 14373
    ActiveWindow.ScrollRow = 14416
    ActiveWindow.ScrollRow = 14459
    ActiveWindow.ScrollRow = 14588
    ActiveWindow.ScrollRow = 14631
    ActiveWindow.ScrollRow = 14760
    ActiveWindow.ScrollRow = 14846
    ActiveWindow.ScrollRow = 14976
    ActiveWindow.ScrollRow = 15019
    ActiveWindow.ScrollRow = 15105
    ActiveWindow.ScrollRow = 15148
    ActiveWindow.ScrollRow = 15277
    ActiveWindow.ScrollRow = 15320
    ActiveWindow.ScrollRow = 15363
    ActiveWindow.ScrollRow = 15406
    ActiveWindow.ScrollRow = 15449
    ActiveWindow.ScrollRow = 15492
    ActiveWindow.ScrollRow = 15535
    ActiveWindow.ScrollRow = 15578
    ActiveWindow.ScrollRow = 15621
    ActiveWindow.ScrollRow = 15664
    ActiveWindow.ScrollRow = 15750
    ActiveWindow.ScrollRow = 15836
    ActiveWindow.ScrollRow = 15879
    ActiveWindow.ScrollRow = 15965
    ActiveWindow.ScrollRow = 16008
    ActiveWindow.ScrollRow = 16051
    ActiveWindow.ScrollRow = 16180
    ActiveWindow.ScrollRow = 16223
    ActiveWindow.ScrollRow = 16310
    ActiveWindow.ScrollRow = 16353
    ActiveWindow.ScrollRow = 16396
    ActiveWindow.ScrollRow = 16482
    ActiveWindow.ScrollRow = 16525
    ActiveWindow.ScrollRow = 16611
    ActiveWindow.ScrollRow = 16697
    ActiveWindow.ScrollRow = 16740
    ActiveWindow.ScrollRow = 16783
    ActiveWindow.ScrollRow = 16826
    ActiveWindow.ScrollRow = 16912
    ActiveWindow.ScrollRow = 16955
    ActiveWindow.ScrollRow = 16998
    ActiveWindow.ScrollRow = 17041
    ActiveWindow.ScrollRow = 17084
    ActiveWindow.ScrollRow = 17127
    ActiveWindow.ScrollRow = 17170
    ActiveWindow.ScrollRow = 17213
    ActiveWindow.ScrollRow = 17256
    ActiveWindow.ScrollRow = 17299
    ActiveWindow.ScrollRow = 17342
    ActiveWindow.ScrollRow = 17385
    ActiveWindow.ScrollRow = 17428
    ActiveWindow.ScrollRow = 17471
    ActiveWindow.ScrollRow = 17514
    ActiveWindow.ScrollRow = 17557
    ActiveWindow.ScrollRow = 17600
    ActiveWindow.ScrollRow = 17644
    ActiveWindow.ScrollRow = 17687
    ActiveWindow.ScrollRow = 17730
    ActiveWindow.ScrollRow = 17773
    ActiveWindow.ScrollRow = 17816
    ActiveWindow.ScrollRow = 17859
    ActiveWindow.ScrollRow = 17902
    ActiveWindow.ScrollRow = 17945
    ActiveWindow.ScrollRow = 17988
    ActiveWindow.ScrollRow = 18031
    ActiveWindow.ScrollRow = 18074
    ActiveWindow.ScrollRow = 18117
    ActiveWindow.ScrollRow = 18160
    ActiveWindow.ScrollRow = 18117
    ActiveWindow.ScrollRow = 18074
    ActiveWindow.ScrollRow = 18031
    ActiveWindow.ScrollRow = 17988
    ActiveWindow.ScrollRow = 17945
    ActiveWindow.LargeScroll Down:=2
    Selection.AutoFill Destination:=Range("M2:M19000"), Type:=xlFillDefault
    Range("M2:M19000").Select
    ActiveWindow.ScrollRow = 18892
    ActiveWindow.ScrollRow = 17515
    ActiveWindow.ScrollRow = 15148
    ActiveWindow.ScrollRow = 13599
    ActiveWindow.ScrollRow = 13384
    ActiveWindow.ScrollRow = 13169
    ActiveWindow.ScrollRow = 13126
    ActiveWindow.ScrollRow = 13040
    ActiveWindow.ScrollRow = 11577
    ActiveWindow.ScrollRow = 10931
    ActiveWindow.ScrollRow = 8177
    ActiveWindow.ScrollRow = 6671
    ActiveWindow.ScrollRow = 6240
    ActiveWindow.ScrollRow = 5853
    ActiveWindow.ScrollRow = 5810
    ActiveWindow.ScrollRow = 5767
    ActiveWindow.ScrollRow = 5079
    ActiveWindow.ScrollRow = 4863
    ActiveWindow.ScrollRow = 4132
    ActiveWindow.ScrollRow = 3874
    ActiveWindow.ScrollRow = 3228
    ActiveWindow.ScrollRow = 3099
    ActiveWindow.ScrollRow = 2927
    ActiveWindow.ScrollRow = 2281
    ActiveWindow.ScrollRow = 2109
    ActiveWindow.ScrollRow = 1593
    ActiveWindow.ScrollRow = 1507
    ActiveWindow.ScrollRow = 1205
    ActiveWindow.ScrollRow = 1076
    ActiveWindow.ScrollRow = 904
    ActiveWindow.ScrollRow = 861
    ActiveWindow.ScrollRow = 732
    ActiveWindow.ScrollRow = 689
    ActiveWindow.ScrollRow = 646
    ActiveWindow.ScrollRow = 603
    ActiveWindow.ScrollRow = 388
    ActiveWindow.ScrollRow = 345
    ActiveWindow.ScrollRow = 302
    ActiveWindow.ScrollRow = 259
    ActiveWindow.ScrollRow = 216
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 130
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 1
    Selection.Copy
    Range("M2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Selection.Replace what:="latlong", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("N2").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=IF(RC[-1]=R[1]C[-1],"""",""1"")"
    Range("N2").Select
    Selection.AutoFill Destination:=Range("N2:N18000")
    Range("N2:N18000").Select
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 345
    ActiveWindow.ScrollRow = 431
    ActiveWindow.ScrollRow = 603
    ActiveWindow.ScrollRow = 689
    ActiveWindow.ScrollRow = 990
    ActiveWindow.ScrollRow = 1076
    ActiveWindow.ScrollRow = 1205
    ActiveWindow.ScrollRow = 1334
    ActiveWindow.ScrollRow = 1593
    ActiveWindow.ScrollRow = 1722
    ActiveWindow.ScrollRow = 1851
    ActiveWindow.ScrollRow = 1894
    ActiveWindow.ScrollRow = 2023
    ActiveWindow.ScrollRow = 2109
    ActiveWindow.ScrollRow = 2238
    ActiveWindow.ScrollRow = 2496
    ActiveWindow.ScrollRow = 2625
    ActiveWindow.ScrollRow = 2712
    ActiveWindow.ScrollRow = 2755
    ActiveWindow.ScrollRow = 2970
    ActiveWindow.ScrollRow = 3099
    ActiveWindow.ScrollRow = 3314
    ActiveWindow.ScrollRow = 3486
    ActiveWindow.ScrollRow = 3787
    ActiveWindow.ScrollRow = 3916
    ActiveWindow.ScrollRow = 4089
    ActiveWindow.ScrollRow = 4132
    ActiveWindow.ScrollRow = 4304
    ActiveWindow.ScrollRow = 4433
    ActiveWindow.ScrollRow = 4519
    ActiveWindow.ScrollRow = 4605
    ActiveWindow.ScrollRow = 4648
    ActiveWindow.ScrollRow = 4691
    ActiveWindow.ScrollRow = 4992
    ActiveWindow.ScrollRow = 5121
    ActiveWindow.ScrollRow = 5509
    ActiveWindow.ScrollRow = 5552
    ActiveWindow.ScrollRow = 5681
    ActiveWindow.ScrollRow = 5853
    ActiveWindow.ScrollRow = 5939
    ActiveWindow.ScrollRow = 6240
    ActiveWindow.ScrollRow = 6326
    ActiveWindow.ScrollRow = 6498
    ActiveWindow.ScrollRow = 6541
    ActiveWindow.ScrollRow = 6756
    ActiveWindow.ScrollRow = 6886
    ActiveWindow.ScrollRow = 7058
    ActiveWindow.ScrollRow = 7101
    ActiveWindow.ScrollRow = 7445
    ActiveWindow.ScrollRow = 7531
    ActiveWindow.ScrollRow = 7703
    ActiveWindow.ScrollRow = 7746
    ActiveWindow.ScrollRow = 7832
    ActiveWindow.ScrollRow = 7961
    ActiveWindow.ScrollRow = 8047
    ActiveWindow.ScrollRow = 8090
    ActiveWindow.ScrollRow = 8220
    ActiveWindow.ScrollRow = 8435
    ActiveWindow.ScrollRow = 8521
    ActiveWindow.ScrollRow = 8564
    ActiveWindow.ScrollRow = 8693
    ActiveWindow.ScrollRow = 8736
    ActiveWindow.ScrollRow = 8865
    ActiveWindow.ScrollRow = 8951
    ActiveWindow.ScrollRow = 9252
    ActiveWindow.ScrollRow = 9338
    ActiveWindow.ScrollRow = 9424
    ActiveWindow.ScrollRow = 9467
    ActiveWindow.ScrollRow = 9511
    ActiveWindow.ScrollRow = 9683
    ActiveWindow.ScrollRow = 9769
    ActiveWindow.ScrollRow = 10027
    ActiveWindow.ScrollRow = 10199
    ActiveWindow.ScrollRow = 10242
    ActiveWindow.ScrollRow = 10285
    ActiveWindow.ScrollRow = 10328
    ActiveWindow.ScrollRow = 10371
    ActiveWindow.ScrollRow = 10543
    ActiveWindow.ScrollRow = 10629
    ActiveWindow.ScrollRow = 10888
    ActiveWindow.ScrollRow = 10974
    ActiveWindow.ScrollRow = 11060
    ActiveWindow.ScrollRow = 11103
    ActiveWindow.ScrollRow = 11146
    ActiveWindow.ScrollRow = 11232
    ActiveWindow.ScrollRow = 11275
    ActiveWindow.ScrollRow = 11318
    ActiveWindow.ScrollRow = 11404
    ActiveWindow.ScrollRow = 11447
    ActiveWindow.ScrollRow = 11619
    ActiveWindow.ScrollRow = 11705
    ActiveWindow.ScrollRow = 11834
    ActiveWindow.ScrollRow = 11877
    ActiveWindow.ScrollRow = 12006
    ActiveWindow.ScrollRow = 12049
    ActiveWindow.ScrollRow = 12092
    ActiveWindow.ScrollRow = 12135
    ActiveWindow.ScrollRow = 12178
    ActiveWindow.ScrollRow = 12265
    ActiveWindow.ScrollRow = 12308
    ActiveWindow.ScrollRow = 12523
    ActiveWindow.ScrollRow = 12652
    ActiveWindow.ScrollRow = 12867
    ActiveWindow.ScrollRow = 12953
    ActiveWindow.ScrollRow = 13125
    ActiveWindow.ScrollRow = 13211
    ActiveWindow.ScrollRow = 13340
    ActiveWindow.ScrollRow = 13426
    ActiveWindow.ScrollRow = 13642
    ActiveWindow.ScrollRow = 13814
    ActiveWindow.ScrollRow = 14115
    ActiveWindow.ScrollRow = 14201
    ActiveWindow.ScrollRow = 14502
    ActiveWindow.ScrollRow = 14674
    ActiveWindow.ScrollRow = 14760
    ActiveWindow.ScrollRow = 14803
    ActiveWindow.ScrollRow = 14846
    ActiveWindow.ScrollRow = 14889
    ActiveWindow.ScrollRow = 14976
    ActiveWindow.ScrollRow = 15019
    ActiveWindow.ScrollRow = 15234
    ActiveWindow.ScrollRow = 15277
    ActiveWindow.ScrollRow = 15363
    ActiveWindow.ScrollRow = 15406
    ActiveWindow.ScrollRow = 15449
    ActiveWindow.ScrollRow = 15492
    ActiveWindow.ScrollRow = 15578
    ActiveWindow.ScrollRow = 15621
    ActiveWindow.ScrollRow = 15664
    ActiveWindow.ScrollRow = 15707
    ActiveWindow.ScrollRow = 15793
    ActiveWindow.ScrollRow = 15836
    ActiveWindow.ScrollRow = 15879
    ActiveWindow.ScrollRow = 16008
    ActiveWindow.ScrollRow = 16051
    ActiveWindow.ScrollRow = 16094
    ActiveWindow.ScrollRow = 16137
    ActiveWindow.ScrollRow = 16180
    ActiveWindow.ScrollRow = 16267
    ActiveWindow.ScrollRow = 16310
    ActiveWindow.ScrollRow = 16353
    ActiveWindow.ScrollRow = 16396
    ActiveWindow.ScrollRow = 16439
    ActiveWindow.ScrollRow = 16482
    ActiveWindow.ScrollRow = 16525
    ActiveWindow.ScrollRow = 16611
    ActiveWindow.ScrollRow = 16654
    ActiveWindow.ScrollRow = 16740
    ActiveWindow.ScrollRow = 16783
    ActiveWindow.ScrollRow = 16826
    ActiveWindow.ScrollRow = 16869
    ActiveWindow.ScrollRow = 16912
    ActiveWindow.ScrollRow = 16998
    ActiveWindow.ScrollRow = 17041
    ActiveWindow.ScrollRow = 17084
    ActiveWindow.ScrollRow = 17127
    ActiveWindow.ScrollRow = 17170
    ActiveWindow.ScrollRow = 17213
    ActiveWindow.ScrollRow = 17299
    ActiveWindow.ScrollRow = 17342
    ActiveWindow.ScrollRow = 17385
    ActiveWindow.ScrollRow = 17428
    ActiveWindow.ScrollRow = 17471
    ActiveWindow.ScrollRow = 17514
    ActiveWindow.ScrollRow = 17600
    ActiveWindow.ScrollRow = 17644
    ActiveWindow.ScrollRow = 17816
    ActiveWindow.ScrollRow = 17902
    ActiveWindow.ScrollRow = 17945
    ActiveWindow.ScrollRow = 17988
    ActiveWindow.ScrollRow = 18031
    ActiveWindow.ScrollRow = 18074
    ActiveWindow.ScrollRow = 18160
    ActiveWindow.ScrollRow = 18203
    ActiveWindow.ScrollRow = 18289
    ActiveWindow.ScrollRow = 18332
    ActiveWindow.ScrollRow = 18375
    ActiveWindow.ScrollRow = 18418
    ActiveWindow.ScrollRow = 18461
    ActiveWindow.ScrollRow = 18418
    ActiveWindow.ScrollRow = 18375
    ActiveWindow.ScrollRow = 18246
    ActiveWindow.ScrollRow = 18203
    ActiveWindow.ScrollRow = 18160
    ActiveWindow.ScrollRow = 18117
    ActiveWindow.ScrollRow = 18074
    ActiveWindow.ScrollRow = 18031
    ActiveWindow.ScrollRow = 17988
    ActiveWindow.ScrollRow = 17945
    ActiveWindow.SmallScroll Down:=45
    Selection.AutoFill Destination:=Range("N2:N19000"), Type:=xlFillDefault
    Range("N2:N19000").Select
    ActiveWindow.ScrollRow = 18935
    ActiveWindow.ScrollRow = 18204
    ActiveWindow.ScrollRow = 17731
    ActiveWindow.ScrollRow = 15837
    ActiveWindow.ScrollRow = 15235
    ActiveWindow.ScrollRow = 14374
    ActiveWindow.ScrollRow = 14331
    ActiveWindow.ScrollRow = 14202
    ActiveWindow.ScrollRow = 12136
    ActiveWindow.ScrollRow = 10759
    ActiveWindow.ScrollRow = 6068
    ActiveWindow.ScrollRow = 5337
    ActiveWindow.ScrollRow = 5294
    ActiveWindow.ScrollRow = 5251
    ActiveWindow.ScrollRow = 5165
    ActiveWindow.ScrollRow = 3831
    ActiveWindow.ScrollRow = 3443
    ActiveWindow.ScrollRow = 2238
    ActiveWindow.ScrollRow = 2152
    ActiveWindow.ScrollRow = 1593
    ActiveWindow.ScrollRow = 1421
    ActiveWindow.ScrollRow = 1205
    ActiveWindow.ScrollRow = 861
    ActiveWindow.ScrollRow = 732
    ActiveWindow.ScrollRow = 560
    ActiveWindow.ScrollRow = 474
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 130
    ActiveWindow.ScrollRow = 1
    Selection.Copy
    Range("N2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
        
        
        ultimalinha = Plan1.Cells(Rows.Count, "n").End(xlUp).Row
    Lin = 2
    For i = 2 To ultimalinha
        If Plan1.Cells(i, 14) <> "" Then
            
            Plan1.Cells(Lin, 16) = Plan1.Cells(i, 13)
            Plan1.Cells(Lin, 17) = Plan1.Cells(i, 14)
            
            Lin = Lin + 1
        End If
    
    Next
        
End Sub



============================================================
MODULE: Módulo17.bas
============================================================
Attribute VB_Name = "Módulo17"
Sub provisoria2()
Attribute provisoria2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' provisoria2 Macro
'

'
    Range("P1").Select
    ActiveCell.FormulaR1C1 = "contagem"
    Range("Q1").Select
    ActiveCell.FormulaR1C1 = "n"
    Range("P1:Q1").Select
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 130
    ActiveWindow.ScrollRow = 4002
    ActiveWindow.ScrollRow = 5078
    ActiveWindow.ScrollRow = 8865
    ActiveWindow.ScrollRow = 11404
    ActiveWindow.ScrollRow = 12135
    ActiveWindow.ScrollRow = 12222
    ActiveWindow.ScrollRow = 12265
    ActiveWindow.ScrollRow = 12996
    ActiveWindow.ScrollRow = 13469
    ActiveWindow.ScrollRow = 16094
    ActiveWindow.ScrollRow = 16267
    ActiveWindow.ScrollRow = 16869
    ActiveWindow.ScrollRow = 16955
    ActiveWindow.ScrollRow = 17471
    ActiveWindow.ScrollRow = 17557
    ActiveWindow.ScrollRow = 17644
    ActiveWindow.ScrollRow = 17945
    ActiveWindow.ScrollRow = 18203
    ActiveWindow.ScrollRow = 18504
    ActiveWindow.ScrollRow = 18590
    ActiveWindow.ScrollRow = 18848
    ActiveWindow.ScrollRow = 18978
    Range("P1:Q19000").Select
    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _
        "Plan1!R1C16:R19000C17", Version:=xlPivotTableVersion15).CreatePivotTable _
        TableDestination:="Plan1!R2C18", TableName:="Tabela dinâmica2", _
        DefaultVersion:=xlPivotTableVersion15
    Sheets("Plan1").Select
    Cells(2, 18).Select
    ActiveWorkbook.ShowPivotTableFieldList = True
    With ActiveSheet.PivotTables("Tabela dinâmica2").PivotFields("contagem")
        .Orientation = xlRowField
        .Position = 1
    End With
    ActiveSheet.PivotTables("Tabela dinâmica2").AddDataField ActiveSheet. _
        PivotTables("Tabela dinâmica2").PivotFields("n"), "Contagem de n", xlCount
    ActiveWorkbook.ShowPivotTableFieldList = False
    ActiveWindow.ScrollColumn = 4
    ActiveWindow.ScrollColumn = 5
    ActiveWindow.ScrollColumn = 6
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 646
    ActiveWindow.ScrollRow = 732
    ActiveWindow.ScrollRow = 990
    ActiveWindow.ScrollRow = 1076
    ActiveWindow.ScrollRow = 1248
    ActiveWindow.ScrollRow = 1334
    ActiveWindow.ScrollRow = 1937
    ActiveWindow.ScrollRow = 2023
    ActiveWindow.ScrollRow = 2281
    ActiveWindow.ScrollRow = 2410
    ActiveWindow.ScrollRow = 2841
    ActiveWindow.ScrollRow = 3056
    ActiveWindow.ScrollRow = 3443
    ActiveWindow.ScrollRow = 3572
    ActiveWindow.ScrollRow = 4175
    ActiveWindow.ScrollRow = 4261
    ActiveWindow.ScrollRow = 4605
    ActiveWindow.ScrollRow = 4691
    ActiveWindow.ScrollRow = 4734
    ActiveWindow.ScrollRow = 4777
    ActiveWindow.ScrollRow = 4820
    ActiveWindow.ScrollRow = 5595
    ActiveWindow.ScrollRow = 5767
    ActiveWindow.ScrollRow = 6369
    ActiveWindow.ScrollRow = 6670
    ActiveWindow.ScrollRow = 7488
    ActiveWindow.ScrollRow = 7660
    ActiveWindow.ScrollRow = 8047
    ActiveWindow.ScrollRow = 8177
    ActiveWindow.ScrollRow = 8865
    ActiveWindow.ScrollRow = 9037
    ActiveWindow.ScrollRow = 9381
    ActiveWindow.ScrollRow = 9597
    ActiveWindow.ScrollRow = 9726
    ActiveWindow.ScrollRow = 9769
    ActiveWindow.ScrollRow = 9726
    ActiveWindow.ScrollRow = 9683
    ActiveWindow.ScrollRow = 9554
    ActiveWindow.ScrollRow = 9338
    ActiveWindow.ScrollRow = 9209
    ActiveWindow.ScrollRow = 9166
    ActiveWindow.ScrollRow = 9123
    ActiveWindow.ScrollRow = 9080
    ActiveWindow.ScrollRow = 9037
    ActiveWindow.ScrollRow = 8994
    ActiveWindow.ScrollRow = 8865
    ActiveWindow.ScrollRow = 8822
    ActiveWindow.ScrollRow = 8779
    ActiveWindow.ScrollRow = 8736
    ActiveWindow.ScrollRow = 8693
    ActiveWindow.ScrollRow = 8650
    ActiveWindow.ScrollRow = 8607
    ActiveWindow.ScrollRow = 8564
    ActiveWindow.ScrollRow = 8435
    ActiveWindow.ScrollRow = 8392
    ActiveWindow.ScrollRow = 8349
    ActiveWindow.ScrollRow = 8306
    ActiveWindow.ScrollRow = 8263
    ActiveWindow.ScrollRow = 8220
    ActiveWindow.ScrollRow = 8177
    ActiveWindow.ScrollRow = 8134
    ActiveWindow.ScrollRow = 8090
    ActiveWindow.ScrollRow = 8047
    ActiveWindow.ScrollRow = 8004
    ActiveWindow.ScrollRow = 7961
    ActiveWindow.ScrollRow = 7918
    ActiveWindow.ScrollRow = 7875
    ActiveWindow.ScrollRow = 7832
    ActiveWindow.ScrollRow = 7789
    ActiveWindow.ScrollRow = 7746
    ActiveWindow.ScrollRow = 7703
    ActiveWindow.ScrollRow = 7660
    ActiveWindow.ScrollRow = 7617
    ActiveWindow.ScrollRow = 7574
    ActiveWindow.ScrollRow = 7531
    ActiveWindow.ScrollRow = 7445
    ActiveWindow.ScrollRow = 7402
    ActiveWindow.ScrollRow = 7359
    ActiveWindow.ScrollRow = 7316
    ActiveWindow.ScrollRow = 7273
    ActiveWindow.ScrollRow = 7058
    ActiveWindow.ScrollRow = 7015
    ActiveWindow.ScrollRow = 6886
    ActiveWindow.ScrollRow = 6843
    ActiveWindow.ScrollRow = 6800
    ActiveWindow.ScrollRow = 6756
    ActiveWindow.ScrollRow = 6713
    ActiveWindow.ScrollRow = 6670
    ActiveWindow.ScrollRow = 6627
    ActiveWindow.ScrollRow = 6670
    ActiveWindow.ScrollRow = 6713
    ActiveWindow.ScrollRow = 6756
    ActiveWindow.ScrollRow = 6800
    ActiveWindow.ScrollRow = 6843
    ActiveWindow.ScrollRow = 6886
    ActiveWindow.LargeScroll Down:=-6
    ActiveWindow.ScrollRow = 6756
    ActiveWindow.ScrollRow = 6670
    ActiveWindow.ScrollRow = 6584
    ActiveWindow.ScrollRow = 5379
    ActiveWindow.ScrollRow = 5078
    ActiveWindow.ScrollRow = 4648
    ActiveWindow.ScrollRow = 4476
    ActiveWindow.ScrollRow = 4002
    ActiveWindow.ScrollRow = 3916
    ActiveWindow.ScrollRow = 3701
    ActiveWindow.ScrollRow = 3615
    ActiveWindow.ScrollRow = 3271
    ActiveWindow.ScrollRow = 3228
    ActiveWindow.ScrollRow = 2884
    ActiveWindow.ScrollRow = 2755
    ActiveWindow.ScrollRow = 2453
    ActiveWindow.ScrollRow = 2324
    ActiveWindow.ScrollRow = 1980
    ActiveWindow.ScrollRow = 1937
    ActiveWindow.ScrollRow = 1722
    ActiveWindow.ScrollRow = 1679
    ActiveWindow.ScrollRow = 1334
    ActiveWindow.ScrollRow = 1248
    ActiveWindow.ScrollRow = 1162
    ActiveWindow.ScrollRow = 1119
    ActiveWindow.ScrollRow = 1076
    ActiveWindow.ScrollRow = 990
    ActiveWindow.ScrollRow = 947
    ActiveWindow.ScrollRow = 775
    ActiveWindow.ScrollRow = 603
    ActiveWindow.ScrollRow = 560
    ActiveWindow.ScrollRow = 517
    ActiveWindow.ScrollRow = 474
    ActiveWindow.ScrollRow = 431
    ActiveWindow.ScrollRow = 345
    ActiveWindow.ScrollRow = 302
    ActiveWindow.ScrollRow = 259
    ActiveWindow.ScrollRow = 216
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 130
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 1
    Range("R3:S3").Select
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 431
    ActiveWindow.ScrollRow = 1033
    ActiveWindow.ScrollRow = 1162
    ActiveWindow.ScrollRow = 2410
    ActiveWindow.ScrollRow = 2539
    ActiveWindow.ScrollRow = 4734
    ActiveWindow.ScrollRow = 6025
    ActiveWindow.ScrollRow = 6670
    ActiveWindow.ScrollRow = 7961
    ActiveWindow.ScrollRow = 8004
    ActiveWindow.ScrollRow = 8047
    ActiveWindow.ScrollRow = 8090
    ActiveWindow.ScrollRow = 9338
    ActiveWindow.ScrollRow = 9726
    ActiveWindow.ScrollRow = 10543
    ActiveWindow.ScrollRow = 11576
    ActiveWindow.ScrollRow = 12566
    ActiveWindow.ScrollRow = 12781
    ActiveWindow.ScrollRow = 13814
    ActiveWindow.ScrollRow = 14158
    ActiveWindow.ScrollRow = 15535
    ActiveWindow.ScrollRow = 15836
    ActiveWindow.ScrollRow = 16223
    ActiveWindow.ScrollRow = 16740
    ActiveWindow.ScrollRow = 16783
    ActiveWindow.ScrollRow = 16869
    ActiveWindow.ScrollRow = 17471
    ActiveWindow.ScrollRow = 17557
    ActiveWindow.ScrollRow = 17687
    ActiveWindow.ScrollRow = 17730
    ActiveWindow.ScrollRow = 17773
    ActiveWindow.ScrollRow = 17902
    ActiveWindow.ScrollRow = 17945
    ActiveWindow.ScrollRow = 17988
    ActiveWindow.ScrollRow = 18074
    ActiveWindow.ScrollRow = 18117
    ActiveWindow.ScrollRow = 18160
    ActiveWindow.ScrollRow = 18246
    ActiveWindow.ScrollRow = 18289
    ActiveWindow.ScrollRow = 18504
    ActiveWindow.ScrollRow = 18547
    ActiveWindow.ScrollRow = 18590
    ActiveWindow.ScrollRow = 18633
    ActiveWindow.ScrollRow = 18676
    ActiveWindow.ScrollRow = 18719
    ActiveWindow.ScrollRow = 18762
    ActiveWindow.ScrollRow = 18805
    ActiveWindow.ScrollRow = 18848
    ActiveWindow.ScrollRow = 18891
    ActiveWindow.ScrollRow = 18934
    ActiveWindow.ScrollRow = 18978
    Range("R3:S19000").Select
    Selection.Copy
    ActiveWindow.ScrollRow = 18934
    ActiveWindow.ScrollRow = 18891
    ActiveWindow.ScrollRow = 17342
    ActiveWindow.ScrollRow = 14287
    ActiveWindow.ScrollRow = 11189
    ActiveWindow.ScrollRow = 10543
    ActiveWindow.ScrollRow = 10156
    ActiveWindow.ScrollRow = 10113
    ActiveWindow.ScrollRow = 10070
    ActiveWindow.ScrollRow = 8779
    ActiveWindow.ScrollRow = 8004
    ActiveWindow.ScrollRow = 7402
    ActiveWindow.ScrollRow = 7101
    ActiveWindow.ScrollRow = 6412
    ActiveWindow.ScrollRow = 6283
    ActiveWindow.ScrollRow = 5896
    ActiveWindow.ScrollRow = 5853
    ActiveWindow.ScrollRow = 5810
    ActiveWindow.ScrollRow = 5724
    ActiveWindow.ScrollRow = 5336
    ActiveWindow.ScrollRow = 5250
    ActiveWindow.ScrollRow = 4992
    ActiveWindow.ScrollRow = 4949
    ActiveWindow.ScrollRow = 4820
    ActiveWindow.ScrollRow = 4777
    ActiveWindow.ScrollRow = 4476
    ActiveWindow.ScrollRow = 4390
    ActiveWindow.ScrollRow = 4132
    ActiveWindow.ScrollRow = 3959
    ActiveWindow.ScrollRow = 3486
    ActiveWindow.ScrollRow = 3357
    ActiveWindow.ScrollRow = 2927
    ActiveWindow.ScrollRow = 2755
    ActiveWindow.ScrollRow = 2281
    ActiveWindow.ScrollRow = 2152
    ActiveWindow.ScrollRow = 1722
    ActiveWindow.ScrollRow = 1550
    ActiveWindow.ScrollRow = 1076
    ActiveWindow.ScrollRow = 947
    ActiveWindow.ScrollRow = 560
    ActiveWindow.ScrollRow = 474
    ActiveWindow.ScrollRow = 345
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 130
    ActiveWindow.ScrollRow = 1
    Range("U2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 130
    ActiveWindow.ScrollRow = 689
    ActiveWindow.ScrollRow = 1033
    ActiveWindow.ScrollRow = 1722
    ActiveWindow.ScrollRow = 1894
    ActiveWindow.ScrollRow = 2798
    ActiveWindow.ScrollRow = 3013
    ActiveWindow.ScrollRow = 3744
    ActiveWindow.ScrollRow = 4002
    ActiveWindow.ScrollRow = 4476
    ActiveWindow.ScrollRow = 4605
    ActiveWindow.ScrollRow = 4992
    ActiveWindow.ScrollRow = 5035
    ActiveWindow.ScrollRow = 5078
    ActiveWindow.ScrollRow = 5293
    ActiveWindow.ScrollRow = 6025
    ActiveWindow.ScrollRow = 6154
    ActiveWindow.ScrollRow = 6455
    ActiveWindow.ScrollRow = 6584
    ActiveWindow.ScrollRow = 6886
    ActiveWindow.ScrollRow = 6972
    ActiveWindow.ScrollRow = 7230
    ActiveWindow.ScrollRow = 7359
    ActiveWindow.ScrollRow = 7531
    ActiveWindow.ScrollRow = 7617
    ActiveWindow.ScrollRow = 7789
    ActiveWindow.ScrollRow = 7918
    ActiveWindow.ScrollRow = 7961
    ActiveWindow.ScrollRow = 7918
    ActiveWindow.ScrollRow = 7789
    ActiveWindow.ScrollRow = 7531
    ActiveWindow.ScrollRow = 7488
    ActiveWindow.ScrollRow = 7445
    ActiveWindow.ScrollRow = 7402
    ActiveWindow.ScrollRow = 7359
    ActiveWindow.ScrollRow = 7187
    ActiveWindow.ScrollRow = 7144
    ActiveWindow.ScrollRow = 7101
    ActiveWindow.ScrollRow = 7058
    ActiveWindow.ScrollRow = 7015
    ActiveWindow.ScrollRow = 6972
    ActiveWindow.ScrollRow = 6929
    ActiveWindow.ScrollRow = 6843
    ActiveWindow.ScrollRow = 6800
    ActiveWindow.ScrollRow = 6756
    ActiveWindow.ScrollRow = 6713
    ActiveWindow.ScrollRow = 6627
    ActiveWindow.ScrollRow = 6628
    ActiveWindow.LargeScroll Down:=6
    Selection.Replace what:="(vazio)", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 646
    ActiveWindow.ScrollRow = 732
    ActiveWindow.ScrollRow = 1162
    ActiveWindow.ScrollRow = 2109
    ActiveWindow.ScrollRow = 2324
    ActiveWindow.ScrollRow = 3357
    ActiveWindow.ScrollRow = 3658
    ActiveWindow.ScrollRow = 4734
    ActiveWindow.ScrollRow = 4906
    ActiveWindow.ScrollRow = 4992
    ActiveWindow.ScrollRow = 5035
    ActiveWindow.ScrollRow = 5078
    ActiveWindow.ScrollRow = 5724
    ActiveWindow.ScrollRow = 5896
    ActiveWindow.ScrollRow = 6240
    ActiveWindow.ScrollRow = 6369
    ActiveWindow.ScrollRow = 6670
    ActiveWindow.ScrollRow = 6756
    ActiveWindow.ScrollRow = 7273
    ActiveWindow.ScrollRow = 7316
    ActiveWindow.ScrollRow = 7746
    ActiveWindow.ScrollRow = 7961
    ActiveWindow.ScrollRow = 8306
    ActiveWindow.ScrollRow = 8349
    ActiveWindow.ScrollRow = 8736
    ActiveWindow.ScrollRow = 8779
    ActiveWindow.ScrollRow = 8908
    ActiveWindow.ScrollRow = 8865
    ActiveWindow.ScrollRow = 8650
    ActiveWindow.ScrollRow = 8392
    ActiveWindow.ScrollRow = 8349
    ActiveWindow.ScrollRow = 8220
    ActiveWindow.ScrollRow = 8177
    ActiveWindow.ScrollRow = 8090
    ActiveWindow.ScrollRow = 7918
    ActiveWindow.ScrollRow = 7875
    ActiveWindow.ScrollRow = 7832
    ActiveWindow.ScrollRow = 7789
    ActiveWindow.ScrollRow = 7746
    ActiveWindow.ScrollRow = 7703
    ActiveWindow.ScrollRow = 7660
    ActiveWindow.ScrollRow = 7617
    ActiveWindow.ScrollRow = 7574
    ActiveWindow.ScrollRow = 7531
    ActiveWindow.ScrollRow = 7488
    ActiveWindow.ScrollRow = 7445
    ActiveWindow.ScrollRow = 7402
    ActiveWindow.ScrollRow = 7359
    ActiveWindow.LargeScroll Down:=-15
    ActiveWindow.ScrollRow = 7015
    ActiveWindow.ScrollRow = 6929
    ActiveWindow.ScrollRow = 6886
    ActiveWindow.ScrollRow = 6713
    ActiveWindow.ScrollRow = 6670
    ActiveWindow.ScrollRow = 6713
    ActiveWindow.ScrollRow = 6756
    ActiveWindow.ScrollRow = 6800
    ActiveWindow.ScrollRow = 6756
    ActiveWindow.ScrollRow = 6713
    ActiveWindow.ScrollRow = 6714
    ActiveWindow.LargeScroll Down:=2
    Selection.Replace what:="Total Geral", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    ActiveWindow.ScrollRow = 6756
    ActiveWindow.ScrollRow = 6670
    ActiveWindow.ScrollRow = 6455
    ActiveWindow.ScrollRow = 5336
    ActiveWindow.ScrollRow = 5078
    ActiveWindow.ScrollRow = 4132
    ActiveWindow.ScrollRow = 3787
    ActiveWindow.ScrollRow = 2625
    ActiveWindow.ScrollRow = 2023
    ActiveWindow.ScrollRow = 1119
    ActiveWindow.ScrollRow = 861
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 1
    Range("U2").Select
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 259
    ActiveWindow.ScrollRow = 2539
    ActiveWindow.ScrollRow = 3486
    ActiveWindow.ScrollRow = 7187
    ActiveWindow.ScrollRow = 8564
    ActiveWindow.ScrollRow = 8779
    ActiveWindow.ScrollRow = 8822
    ActiveWindow.ScrollRow = 8865
    ActiveWindow.ScrollRow = 10199
    ActiveWindow.ScrollRow = 10629
    ActiveWindow.ScrollRow = 12437
    ActiveWindow.ScrollRow = 12910
    ActiveWindow.ScrollRow = 14115
    ActiveWindow.ScrollRow = 14287
    ActiveWindow.ScrollRow = 14330
    ActiveWindow.ScrollRow = 14373
    ActiveWindow.ScrollRow = 14416
    ActiveWindow.ScrollRow = 14933
    ActiveWindow.ScrollRow = 15191
    ActiveWindow.ScrollRow = 16396
    ActiveWindow.ScrollRow = 16568
    ActiveWindow.ScrollRow = 17127
    ActiveWindow.ScrollRow = 17342
    ActiveWindow.ScrollRow = 17988
    ActiveWindow.ScrollRow = 18031
    ActiveWindow.ScrollRow = 18203
    ActiveWindow.ScrollRow = 18246
    ActiveWindow.ScrollRow = 18547
    ActiveWindow.ScrollRow = 18633
    ActiveWindow.ScrollRow = 18719
    ActiveWindow.ScrollRow = 18762
    ActiveWindow.ScrollRow = 18805
    ActiveWindow.ScrollRow = 18848
    ActiveWindow.ScrollRow = 18891
    ActiveWindow.ScrollRow = 18934
    ActiveWindow.ScrollRow = 18978
    Range("U2:U19000").Select
    Application.CutCopyMode = False
    ActiveWindow.ScrollRow = 1
    Range("U1").Select
    ActiveCell.FormulaR1C1 = "cont"
    Range("U1").Select
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 388
    ActiveWindow.ScrollRow = 3529
    ActiveWindow.ScrollRow = 4390
    ActiveWindow.ScrollRow = 8865
    ActiveWindow.ScrollRow = 9252
    ActiveWindow.ScrollRow = 9597
    ActiveWindow.ScrollRow = 9640
    ActiveWindow.ScrollRow = 9683
    ActiveWindow.ScrollRow = 12394
    ActiveWindow.ScrollRow = 13340
    ActiveWindow.ScrollRow = 15965
    ActiveWindow.ScrollRow = 16267
    ActiveWindow.ScrollRow = 16697
    ActiveWindow.ScrollRow = 16783
    ActiveWindow.ScrollRow = 17127
    ActiveWindow.ScrollRow = 17170
    ActiveWindow.ScrollRow = 17256
    ActiveWindow.ScrollRow = 18031
    ActiveWindow.ScrollRow = 18160
    ActiveWindow.ScrollRow = 18289
    ActiveWindow.ScrollRow = 18332
    ActiveWindow.ScrollRow = 18375
    ActiveWindow.ScrollRow = 18418
    ActiveWindow.ScrollRow = 18547
    ActiveWindow.ScrollRow = 18590
    ActiveWindow.ScrollRow = 18633
    ActiveWindow.ScrollRow = 18762
    ActiveWindow.ScrollRow = 18891
    ActiveWindow.ScrollRow = 18934
    ActiveWindow.ScrollRow = 18978
    Range("U1:U19000").Select
    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _
        "Plan1!R1C21:R19000C21", Version:=xlPivotTableVersion15).CreatePivotTable _
        TableDestination:="Plan1!R2C23", TableName:="Tabela dinâmica3", _
        DefaultVersion:=xlPivotTableVersion15
    Sheets("Plan1").Select
    Cells(2, 23).Select
    ActiveWorkbook.ShowPivotTableFieldList = True
    ActiveSheet.PivotTables("Tabela dinâmica3").AddDataField ActiveSheet. _
        PivotTables("Tabela dinâmica3").PivotFields("cont"), "Contagem de cont", _
        xlCount
    ActiveWorkbook.ShowPivotTableFieldList = False
    ActiveWindow.ScrollColumn = 8
    ActiveWindow.ScrollColumn = 9
    ActiveWindow.ScrollColumn = 10
    ActiveWindow.ScrollColumn = 11
    ActiveWindow.ScrollColumn = 12
End Sub
Sub excluirtudo()
Attribute excluirtudo.VB_ProcData.VB_Invoke_Func = " \n14"
'
' excluirtudo Macro
'

'
    Cells.Select
    Range("L1").Activate
    Selection.Delete Shift:=xlUp
End Sub



============================================================
MODULE: Módulo18.bas
============================================================
Attribute VB_Name = "Módulo18"
Sub provisoria3()
Attribute provisoria3.VB_ProcData.VB_Invoke_Func = " \n14"
'
' provisoria3 Macro
'

'
    ActiveWindow.ScrollRow = 18934
    ActiveWindow.ScrollRow = 18375
    ActiveWindow.ScrollRow = 18074
    ActiveWindow.ScrollRow = 15062
    ActiveWindow.ScrollRow = 14416
    ActiveWindow.ScrollRow = 11189
    ActiveWindow.ScrollRow = 11146
    ActiveWindow.ScrollRow = 11060
    ActiveWindow.ScrollRow = 8004
    ActiveWindow.ScrollRow = 7101
    ActiveWindow.ScrollRow = 6197
    ActiveWindow.ScrollRow = 5724
    ActiveWindow.ScrollRow = 4045
    ActiveWindow.ScrollRow = 3701
    ActiveWindow.ScrollRow = 2625
    ActiveWindow.ScrollRow = 2453
    ActiveWindow.ScrollRow = 1119
    ActiveWindow.ScrollRow = 990
    ActiveWindow.ScrollRow = 689
    ActiveWindow.ScrollRow = 603
    ActiveWindow.ScrollRow = 388
    ActiveWindow.ScrollRow = 345
    ActiveWindow.ScrollRow = 259
    ActiveWindow.ScrollRow = 216
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 1
    Columns("V:V").Select
    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Range("U1").Select
    Selection.ClearContents
    Range("U2").Select
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 474
    ActiveWindow.ScrollRow = 2668
    ActiveWindow.ScrollRow = 5121
    ActiveWindow.ScrollRow = 7531
    ActiveWindow.ScrollRow = 7832
    ActiveWindow.ScrollRow = 7918
    ActiveWindow.ScrollRow = 7961
    ActiveWindow.ScrollRow = 8004
    ActiveWindow.ScrollRow = 9554
    ActiveWindow.ScrollRow = 10027
    ActiveWindow.ScrollRow = 11920
    ActiveWindow.ScrollRow = 12178
    ActiveWindow.ScrollRow = 13039
    ActiveWindow.ScrollRow = 13469
    ActiveWindow.ScrollRow = 13943
    ActiveWindow.ScrollRow = 14072
    ActiveWindow.ScrollRow = 14158
    ActiveWindow.ScrollRow = 14287
    ActiveWindow.ScrollRow = 15062
    ActiveWindow.ScrollRow = 15105
    ActiveWindow.ScrollRow = 15148
    ActiveWindow.ScrollRow = 16223
    ActiveWindow.ScrollRow = 16396
    ActiveWindow.ScrollRow = 16740
    ActiveWindow.ScrollRow = 17428
    ActiveWindow.ScrollRow = 17514
    ActiveWindow.ScrollRow = 17730
    ActiveWindow.ScrollRow = 17773
    ActiveWindow.ScrollRow = 18117
    ActiveWindow.ScrollRow = 18160
    ActiveWindow.ScrollRow = 18289
    ActiveWindow.ScrollRow = 18332
    ActiveWindow.ScrollRow = 18375
    ActiveWindow.ScrollRow = 18676
    ActiveWindow.ScrollRow = 18719
    ActiveWindow.ScrollRow = 18762
    ActiveWindow.ScrollRow = 18891
    ActiveWindow.ScrollRow = 18934
    ActiveWindow.ScrollRow = 18978
    Range("U2:U19000").Select
    ActiveWindow.ScrollRow = 18934
    ActiveWindow.ScrollRow = 18891
    ActiveWindow.ScrollRow = 18289
    ActiveWindow.ScrollRow = 17428
    ActiveWindow.ScrollRow = 11963
    ActiveWindow.ScrollRow = 11662
    ActiveWindow.ScrollRow = 10801
    ActiveWindow.ScrollRow = 10715
    ActiveWindow.ScrollRow = 10672
    ActiveWindow.ScrollRow = 10500
    ActiveWindow.ScrollRow = 10328
    ActiveWindow.ScrollRow = 7832
    ActiveWindow.ScrollRow = 7359
    ActiveWindow.ScrollRow = 7101
    ActiveWindow.ScrollRow = 6972
    ActiveWindow.ScrollRow = 6154
    ActiveWindow.ScrollRow = 5767
    ActiveWindow.ScrollRow = 5293
    ActiveWindow.ScrollRow = 3744
    ActiveWindow.ScrollRow = 3529
    ActiveWindow.ScrollRow = 3486
    ActiveWindow.ScrollRow = 3443
    ActiveWindow.ScrollRow = 3271
    ActiveWindow.ScrollRow = 1679
    ActiveWindow.ScrollRow = 1205
    ActiveWindow.ScrollRow = 775
    ActiveWindow.ScrollRow = 216
    ActiveWindow.ScrollRow = 173
    ActiveWindow.ScrollRow = 130
    ActiveWindow.ScrollRow = 87
    ActiveWindow.ScrollRow = 44
    ActiveWindow.ScrollRow = 1
    Selection.Replace what:="lat", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace what:="long", Replacement:=";", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.TextToColumns Destination:=Range("U2"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _
        :=";", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True
    Range("U1").Select
    ActiveCell.FormulaR1C1 = "lat"
    Range("V1").Select
    ActiveCell.FormulaR1C1 = "long"
    Range("W1").Select
    ActiveCell.FormulaR1C1 = "exploracao"
    Columns("U:W").Select
    Selection.Copy
    Sheets("contar").Select
    Range("A1").Select
    ActiveSheet.Paste
End Sub



============================================================
MODULE: Módulo19.bas
============================================================
Attribute VB_Name = "Módulo19"
Sub selecionarmaiorvalor()
Attribute selecionarmaiorvalor.VB_ProcData.VB_Invoke_Func = " \n14"
'
' selecionarmaiorvalor Macro
'

Windows("ExploTrack exe.xlsm").Activate
    Sheets("contar").Select
       
    Totallinha = Worksheets("contar").UsedRange.Rows.Count
   
    Cells(Totallinha, 3) = ""
End Sub



============================================================
MODULE: relatorio.frm
============================================================
Attribute VB_Name = "relatorio"
Attribute VB_Base = "0{0C611660-7F2F-4A7E-B25A-5DD079015DD6}{16EDDD2D-A711-4099-850F-747D9A515134}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub acessar_inserir_Click()
Unload relatorio
venda.Show
End Sub

Private Sub adm_senha_Change()
listbox_relatorio.Clear
list_especifico.Clear
total_relatorio = 0
total_relatorio = ""
custo_relatorio = ""
lucro_relatorio = ""

box_modalidade.Visible = True
label_modalidade.Visible = True
box_vendedor.Visible = True
label_vendedor.Visible = True


label_encomenda_relatorio.Visible = True
box_encomenda.Visible = True

busca_detalhada.Visible = False
label_custo.Visible = False
custo_relatorio.Visible = False

label_lucro_relatorio.Visible = False
lucro_relatorio.Visible = False

ok2.Visible = False

Worksheets("Desenvolvedor").Select
        
    'varrer planilha
    
Linha = 1
Do
  Linha = Linha + 1
    
    nome = Cells(Linha, 1)
    senha = CStr(Cells(Linha, 2))
    
    
    If adm_user = nome And adm_senha = senha And Not adm_senha = "" Then
    
        box_modalidade.Visible = False
        label_modalidade.Visible = False
        box_vendedor.Visible = False
        label_vendedor.Visible = False
        ok2.Visible = False
        label_encomenda_relatorio.Visible = False
        box_encomenda.Visible = False
    
    
        busca_detalhada.Visible = True
        label_custo.Visible = True
        custo_relatorio.Visible = True
        label_total_relatorio.Visible = True
        total_relatorio.Visible = True
        label_lucro_relatorio.Visible = True
        lucro_relatorio.Visible = True
         
        End If
        
Loop Until (caixa_usuario = nome And caixa_senha = senha) Or Cells(Linha, 1) = ""


Worksheets("Desenvolvedor").Select
        
    'varrer planilha
    
Linha = 1
Do
  Linha = Linha + 1
   
   
    senha = CStr(Cells(Linha, 2))
    
    
    If adm_senha = senha And Not adm_senha = "" Then
    
        
        ok2.Visible = True
        
    
         
        End If
        
Loop Until (caixa_usuario = nome And caixa_senha = senha) Or Cells(Linha, 1) = ""



End Sub

Private Sub adm_user_Change()




End Sub

Private Sub back_Click()

Worksheets("somatorio_vendas").Select
Totalregistro = Worksheets("somatorio_vendas").UsedRange.Rows.Count
Worksheets("s_venda_back").Select
tot_back = Worksheets("s_venda_back").UsedRange.Rows.Count
tot_back = tot_back + 1



For i = 2 To Totalregistro
    
    If Sheets("somatorio_vendas").Cells(i, 4).Value < Date - 60 Then
  
        For coluna = 1 To 12
        
            Sheets("s_venda_back").Cells(tot_back, coluna).Value = Sheets("somatorio_vendas").Cells(i, coluna).Value
        Next
        
                
        
        
        tot_back = tot_back + 1
        
    End If
        
Next


End Sub

Private Sub botao_Click()
Unload relatorio
creditos_venda.Show
End Sub

Private Sub box_modalidade_Change()

End Sub

Private Sub box_vendedor_Change()

End Sub

Private Sub CommandButton1_Click()

''''''''''''''''''''''''''''''''''''''''''' valores do relatorio para listbox

listbox_relatorio.Clear
Linha = 2
linhalistbox = Linha - 2

Do While Sheets("somatorio_vendas").Cells(Linha, 1) <> ""

    If (Sheets("somatorio_vendas").Cells(Linha, 11).Text = box_ano Or box_ano = "") And (Sheets("somatorio_vendas").Cells(Linha, 10).Text = box_mes Or box_mes = "") And (Sheets("somatorio_vendas").Cells(Linha, 9).Text = box_dia Or box_dia = "") And (Sheets("somatorio_vendas").Cells(Linha, 6).Text = box_vendedor Or box_vendedor = "") And (Sheets("somatorio_vendas").Cells(Linha, 1).Text = box_modalidade Or box_modalidade = "") Then
    
    
    
    With Me.listbox_relatorio
     .AddItem
        .List(linhalistbox, 0) = Sheets("somatorio_vendas").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("somatorio_vendas").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("somatorio_vendas").Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets("somatorio_vendas").Cells(Linha, 4)
        .List(linhalistbox, 4) = Format(Sheets("somatorio_vendas").Cells(Linha, 5).Value, "HH:MM:SS")
        .List(linhalistbox, 5) = Sheets("somatorio_vendas").Cells(Linha, 6)
        .List(linhalistbox, 6) = Sheets("somatorio_vendas").Cells(Linha, 7)
        .List(linhalistbox, 7) = Sheets("somatorio_vendas").Cells(Linha, 8)
        End With
        linhalistbox = linhalistbox + 1
    End If
    
    
    Linha = Linha + 1

Loop


''''''''''''''''''''''''''''''''''''''''''''''''''''''
'''' atualizar resumo venda
Worksheets("somar_relatorio").Select

Rows("2:2").Select
Range(Selection, Selection.End(xlDown)).Select
Selection.ClearContents

Range("A2").Select

For i = 0 To (listbox_relatorio.ListCount - 1)

Do
If Not (IsEmpty(ActiveCell)) Then
ActiveCell.Offset(1, 0).Select
End If
Loop Until IsEmpty(ActiveCell) = True

ActiveCell.Value = listbox_relatorio.List(i, 2)


Next
''''''

Dim Soma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 Soma = Soma + Cells(Linha, 1).Value
                
           Next
          'Definimos o valor do TextBox, o total da soma
          
          total_relatorio = Format(Soma, "R$ 0.00#,##")
Soma = 0
End Sub

Private Sub ok_relatorio_Click()

listbox_relatorio.Clear

Dim Linha As Integer
Dim linhalistbox As Integer

Linha = 2
linhalistbox = Linha - 2

Do While Sheets("somatorio_vendas").Cells(Linha, 1) <> ""

    If Sheets("somatorio_vendas").Cells(Linha, 1) = box_modalidade Or Sheets("somatorio_vendas").Cells(Linha, 6) = box_vendedor Or Sheets("somatorio_vendas").Cells(Linha, 9).Text = box_dia Then
    
    With Me.listbox_relatorio
     .AddItem
        .List(linhalistbox, 0) = Sheets("somatorio_vendas").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("somatorio_vendas").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("somatorio_vendas").Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets("somatorio_vendas").Cells(Linha, 4)
        .List(linhalistbox, 4) = Format(Sheets("somatorio_vendas").Cells(Linha, 5).Value, "HH:MM:SS")
        .List(linhalistbox, 5) = Sheets("somatorio_vendas").Cells(Linha, 6)
        .List(linhalistbox, 6) = Sheets("somatorio_vendas").Cells(Linha, 7)
        .List(linhalistbox, 7) = Sheets("somatorio_vendas").Cells(Linha, 8)
        End With
        linhalistbox = linhalistbox + 1
    End If
    

    Linha = Linha + 1

Loop

''''''''''''''''''''''''''''''''' modalidade e vendedor

Linha = 2
linhalistbox = Linha - 2

Do While Sheets("somatorio_vendas").Cells(Linha, 1) <> ""

    If Sheets("somatorio_vendas").Cells(Linha, 1) = box_modalidade And Sheets("somatorio_vendas").Cells(Linha, 6) = box_vendedor Then
    listbox_relatorio.Clear
    
    With Me.listbox_relatorio
     .AddItem
        .List(linhalistbox, 0) = Sheets("somatorio_vendas").Cells(Linha, 1).Value
        .List(linhalistbox, 1) = Sheets("somatorio_vendas").Cells(Linha, 2).Value
        .List(linhalistbox, 2) = Sheets("somatorio_vendas").Cells(Linha, 3).Value
        .List(linhalistbox, 3) = Sheets("somatorio_vendas").Cells(Linha, 4).Value
        .List(linhalistbox, 4) = Format(Sheets("somatorio_vendas").Cells(Linha, 5).Value, "HH:MM:SS")
        .List(linhalistbox, 5) = Sheets("somatorio_vendas").Cells(Linha, 6).Value
        .List(linhalistbox, 6) = Sheets("somatorio_vendas").Cells(Linha, 7).Value
        .List(linhalistbox, 7) = Sheets("somatorio_vendas").Cells(Linha, 8).Value
        End With
        linhalistbox = linhalistbox + 1
    End If
    

    Linha = Linha + 1

Loop

'''''''''''''''''''''''''''' modalidade com dia

Linha = 2
linhalistbox = Linha - 2

Do While Sheets("somatorio_vendas").Cells(Linha, 1) <> ""

    If Sheets("somatorio_vendas").Cells(Linha, 1) = box_modalidade And Sheets("somatorio_vendas").Cells(Linha, 9).Text = box_dia Then
    listbox_relatorio.Clear
    
    With Me.listbox_relatorio
     .AddItem
        .List(linhalistbox, 0) = Sheets("somatorio_vendas").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("somatorio_vendas").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("somatorio_vendas").Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets("somatorio_vendas").Cells(Linha, 4)
        .List(linhalistbox, 4) = Format(Sheets("somatorio_vendas").Cells(Linha, 5).Value, "HH:MM:SS")
        .List(linhalistbox, 5) = Sheets("somatorio_vendas").Cells(Linha, 6)
        .List(linhalistbox, 6) = Sheets("somatorio_vendas").Cells(Linha, 7)
        .List(linhalistbox, 7) = Sheets("somatorio_vendas").Cells(Linha, 8)
        End With
        linhalistbox = linhalistbox + 1
    End If
    

    Linha = Linha + 1

Loop



''''''''''''''''''''''''''''''''''''''''''' vendedor com dia

Linha = 2
linhalistbox = Linha - 2

Do While Sheets("somatorio_vendas").Cells(Linha, 1) <> ""

    If Sheets("somatorio_vendas").Cells(Linha, 6) = box_vendedor And Sheets("somatorio_vendas").Cells(Linha, 9).Text = box_dia Then
    listbox_relatorio.Clear
    
    With Me.listbox_relatorio
     .AddItem
        .List(linhalistbox, 0) = Sheets("somatorio_vendas").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("somatorio_vendas").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("somatorio_vendas").Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets("somatorio_vendas").Cells(Linha, 4)
        .List(linhalistbox, 4) = Format(Sheets("somatorio_vendas").Cells(Linha, 5).Value, "HH:MM:SS")
        .List(linhalistbox, 5) = Sheets("somatorio_vendas").Cells(Linha, 6)
        .List(linhalistbox, 6) = Sheets("somatorio_vendas").Cells(Linha, 7)
        .List(linhalistbox, 7) = Sheets("somatorio_vendas").Cells(Linha, 8)
        End With
        linhalistbox = linhalistbox + 1
    End If
    
    
    Linha = Linha + 1

Loop


''''''''''''''''''''''''''''''''''''''''''''''''''''''

Linha = 2
linhalistbox = Linha - 2

Do While Sheets("somatorio_vendas").Cells(Linha, 1) <> ""

    If Sheets("somatorio_vendas").Cells(Linha, 1) = box_modalidade And Sheets("somatorio_vendas").Cells(Linha, 6) = box_vendedor And Sheets("somatorio_vendas").Cells(Linha, 9).Text = box_dia Then
    listbox_relatorio.Clear
    
    With Me.listbox_relatorio
     .AddItem
        .List(linhalistbox, 0) = Sheets("somatorio_vendas").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("somatorio_vendas").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("somatorio_vendas").Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets("somatorio_vendas").Cells(Linha, 4)
        .List(linhalistbox, 4) = Format(Sheets("somatorio_vendas").Cells(Linha, 5).Value, "HH:MM:SS")
        .List(linhalistbox, 5) = Sheets("somatorio_vendas").Cells(Linha, 6)
        .List(linhalistbox, 6) = Sheets("somatorio_vendas").Cells(Linha, 7)
        .List(linhalistbox, 7) = Sheets("somatorio_vendas").Cells(Linha, 8)
        End With
        linhalistbox = linhalistbox + 1
    End If
    

    Linha = Linha + 1

Loop

End Sub

Private Sub busca_detalhada_Click()



Sheet_detalhe = "historicovenda"

If Not data_inicio.Value = Date Or Not data_fim.Value = Date Then
Sheet_detalhe = "historicovendaback"
End If




list_especifico.Clear
Linha = 2
linhalistbox = Linha - 2


Do While Sheets(Sheet_detalhe).Cells(Linha, 1) <> ""

    If Sheets(Sheet_detalhe).Cells(Linha, 4) >= data_inicio And Sheets(Sheet_detalhe).Cells(Linha, 4) <= data_fim Then
    
        
    With Me.list_especifico
     .AddItem
        .List(linhalistbox, 0) = Sheets(Sheet_detalhe).Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets(Sheet_detalhe).Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets(Sheet_detalhe).Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets(Sheet_detalhe).Cells(Linha, 4)
        .List(linhalistbox, 4) = Format(Sheets(Sheet_detalhe).Cells(Linha, 5).Value, "HH:MM:SS")
        .List(linhalistbox, 5) = Sheets(Sheet_detalhe).Cells(Linha, 6)
        .List(linhalistbox, 6) = Sheets(Sheet_detalhe).Cells(Linha, 7)
        
        End With
        linhalistbox = linhalistbox + 1
    End If
    
    
    Linha = Linha + 1

Loop


''''''''''''''''''''''''''''''''''''''''''''''''''''''
'''' atualizar soma do relatorio
Worksheets("somar_detalhes").Select

Rows("2:2").Select
Range(Selection, Selection.End(xlDown)).Select
Selection.ClearContents

Range("A2").Select

For i = 0 To (list_especifico.ListCount - 1)

Do
If Not (IsEmpty(ActiveCell)) Then
ActiveCell.Offset(1, 0).Select
End If
Loop Until IsEmpty(ActiveCell) = True

ActiveCell.Value = list_especifico.List(i, 1)

ActiveCell.Offset(0, 1).Value = list_especifico.List(i, 6)
ActiveCell.Offset(0, 2).Value = list_especifico.List(i, 0)

Next
''''''

Dim Soma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 Total = Total + (Cells(Linha, 1).Value * Cells(Linha, 3).Value)
                 custo = custo + (Cells(Linha, 2).Value * Cells(Linha, 3).Value)
                 
                                 
           Next
          'Definimos o valor do TextBox, o total da soma
          If custo <> "" And IsNumeric(custo) And Total <> "" And IsNumeric(Total) Then
          
          custo_relatorio = Format(custo, "R$ 0.00#,##")
          total_relatorio = Format(Total, "R$ 0.00#,##")
          Soma = Total - custo
          lucro_relatorio = Format(Soma, "R$ 0.00#,##")
          
          End If
Soma = 0

End Sub

Private Sub CommandButton10_Click()
Unload relatorio
parametros.Show
End Sub

Private Sub CommandButton11_Click()
Unload relatorio
inicio.Show
End Sub

Private Sub CommandButton12_Click()
resposta = MsgBox("Deseja realmente sair?", vbYesNo, "ATENÇÃO")
    If resposta = vbYes Then
    ActiveWorkbook.Save
    Application.Quit
    Else
    ActiveWorkbook.Save
    Exit Sub
    End If
End Sub

Private Sub CommandButton13_Click()
Unload relatorio
prazo.Show
End Sub

Private Sub CommandButton14_Click()

tot_back = Worksheets("s_venda_back").UsedRange.Rows.Count

Worksheets("somatorio_vendas").Select

Dim fc As Range

 Set fc = Nothing
 Set fc = Worksheets("somatorio_vendas").Columns("D").Find(what:=Date - 1, after:=Range("D1"), searchdirection:=xlPrevious)
 
 
 If Not fc Is Nothing Then
 
 'MsgBox "Backup já foi feito", vbInformation, "Informação"
 
 'Else
 
 Sheets("somatorio_vendas").Range(Cells(2, 4), Cells(fc.Row, 4)).Select
 
 Selection.EntireRow.Copy Worksheets("s_venda_back").Cells(tot_back + 1, 1)
  
 Selection.EntireRow.Delete Shift:=xlUp
 
 End If
 
 

End Sub

Private Sub CommandButton9_Click()

End Sub

Private Sub contagem_inicio_Click()
Unload relatorio
acess_cadastro.Show
End Sub

Private Sub Label17_Click()

End Sub

Private Sub Label34_Click()

End Sub

Private Sub Label35_Click()

End Sub

Private Sub data_fim_DateClick(ByVal DateClicked As Date)
ok2.Visible = True
If Not data_inicio.Value = Date Or Not data_fim.Value = Date Then
listbox_relatorio.Clear
total_relatorio = 0
ok2.Visible = False
End If

Worksheets("Desenvolvedor").Select
        
    'varrer planilha
    
Linha = 1
Do
  Linha = Linha + 1
   
   
    senha = CStr(Cells(Linha, 2))
    
    
    If adm_senha = senha And Not adm_senha = "" Then
    
        
        ok2.Visible = True
        
    
         
        End If
        
Loop Until (caixa_usuario = nome And caixa_senha = senha) Or Cells(Linha, 1) = ""


End Sub

Private Sub data_inicio_DateClick(ByVal DateClicked As Date)
ok2.Visible = True
If Not data_inicio.Value = Date Or Not data_fim.Value = Date Then
listbox_relatorio.Clear
total_relatorio = 0
ok2.Visible = False
End If

Worksheets("Desenvolvedor").Select
        
    'varrer planilha
    
Linha = 1
Do
  Linha = Linha + 1
   
   
    senha = CStr(Cells(Linha, 2))
    
    
    If adm_senha = senha And Not adm_senha = "" Then
    
        
        ok2.Visible = True
        
    
         
        End If
        
Loop Until (caixa_usuario = nome And caixa_senha = senha) Or Cells(Linha, 1) = ""


End Sub

Private Sub Label45_Click()

End Sub

Private Sub ok2_Click()

Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual


'-------- jogar vendas que não são do dia para a tabea s_venda_back
tot_back = Worksheets("s_venda_back").UsedRange.Rows.Count

Worksheets("somatorio_vendas").Select

Dim fc As Range

 Set fc = Nothing
 Set fc = Worksheets("somatorio_vendas").Columns("D").Find(what:=Date - 1, after:=Range("D1"), searchdirection:=xlPrevious)
 
 
 If Not fc Is Nothing Then
 
 'MsgBox "Backup já foi feito", vbInformation, "Informação"
 
 'Else
 
 Sheets("somatorio_vendas").Range(Cells(2, 4), Cells(fc.Row, 4)).Select
 
 Selection.EntireRow.Copy Worksheets("s_venda_back").Cells(tot_back + 1, 1)
  
 Selection.EntireRow.Delete Shift:=xlUp
 
 End If

'------------------------------------------------------------------------------

Sheet = "somatorio_vendas"

If Not data_inicio.Value = Date Or Not data_fim.Value = Date Then
Sheet = "s_venda_back"
End If

listbox_relatorio.Clear
Linha = 2
linhalistbox = Linha - 2


total_relatorio = ""


Do While Sheets(Sheet).Cells(Linha, 1) <> ""

    If Sheets(Sheet).Cells(Linha, 4) >= data_inicio And Sheets(Sheet).Cells(Linha, 4) <= data_fim And (Sheets(Sheet).Cells(Linha, 6).Text = box_vendedor Or box_vendedor = "") And (Sheets(Sheet).Cells(Linha, 1).Text = box_modalidade Or box_modalidade = "") And (Sheets(Sheet).Cells(Linha, 12).Text = box_encomenda Or box_encomenda = "") And (Sheets(Sheet).Cells(Linha, 13).Text = box_online Or box_online = "") Then
    
        
    With Me.listbox_relatorio
     .AddItem
        .List(linhalistbox, 0) = Sheets(Sheet).Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets(Sheet).Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets(Sheet).Cells(Linha, 3)
        .List(linhalistbox, 3) = Sheets(Sheet).Cells(Linha, 4)
        .List(linhalistbox, 4) = Format(Sheets(Sheet).Cells(Linha, 5).Value, "HH:MM:SS")
        .List(linhalistbox, 5) = Sheets(Sheet).Cells(Linha, 6)
        'desconto_val = Sheets("somatorio_vendas").Cells(Linha, 7).Value
        desconto_val = Format(Round(Sheets(Sheet).Cells(Linha, 7).Value, 2), "0.00#,##")
        .List(linhalistbox, 6) = desconto_val
        .List(linhalistbox, 7) = Sheets(Sheet).Cells(Linha, 8)
        .List(linhalistbox, 8) = Sheets(Sheet).Cells(Linha, 13)
        End With
        linhalistbox = linhalistbox + 1
    End If
    
    
    Linha = Linha + 1

Loop


''''''''''''''''''''''''''''''''''''''''''''''''''''''
'''' atualizar soma do relatorio
Worksheets("somar_relatorio").Select

Rows("2:2").Select
Range(Selection, Selection.End(xlDown)).Select
Selection.ClearContents

Range("A2").Select

For i = 0 To (listbox_relatorio.ListCount - 1)

Do
If Not (IsEmpty(ActiveCell)) Then
ActiveCell.Offset(1, 0).Select
End If
Loop Until IsEmpty(ActiveCell) = True

ActiveCell.Value = listbox_relatorio.List(i, 2)


Next
''''''

Dim Soma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 Soma = Soma + Cells(Linha, 1).Value
                
           Next
          'Definimos o valor do TextBox, o total da soma
          
          total_relatorio = Format(Soma, "R$ 0.00#,##")
Soma = 0

Application.Calculation = xlCalculationAutomatic
Application.ScreenUpdating = True


End Sub

Private Sub total_relatorio_Change()

End Sub

Private Sub UserForm_Click()

End Sub
Private Sub UserForm_QueryClose _
   (Cancel As Integer, CloseMode As Integer)
   If CloseMode = vbFormControlMenu Then
       MsgBox "Fechar de maneira correta (botão SAIR)", vbCritical, "AVISO"
        Cancel = True
   End If
End Sub

Private Sub UserForm_Initialize()




'------- jogar hist venda detalhada para outra tabela de backup


tot_back = Worksheets("historicovendaback").UsedRange.Rows.Count

Worksheets("historicovenda").Select

Dim fc As Range

 Set fc = Nothing
 Set fc = Worksheets("historicovenda").Columns("D").Find(what:=Date - 1, after:=Range("D1"), searchdirection:=xlPrevious)
 
 
 If Not fc Is Nothing Then
 
 'MsgBox "Backup já foi feito", vbInformation, "Informação"
 
 'Else
 
 Sheets("historicovenda").Range(Cells(2, 4), Cells(fc.Row, 4)).Select
 
 Selection.EntireRow.Copy Worksheets("historicovendaback").Cells(tot_back + 1, 1)
  
 Selection.EntireRow.Delete Shift:=xlUp
 
 End If




'----------------------






data_inicio.Value = Date
data_fim.Value = Date


box_encomenda.AddItem "Não"
box_encomenda.AddItem "Sim"

box_modalidade.AddItem "Cartao"
box_modalidade.AddItem "pix"
box_modalidade.AddItem "Dinheiro"
box_modalidade.AddItem "Prazo"


box_online.AddItem "Nao"
box_online.AddItem "Sim"


'box_vendedor.AddItem "Luale"
'box_vendedor.AddItem "Estéfany"


Worksheets("vendedor_data").Select

Totalregistro = Worksheets("vendedor_data").UsedRange.Rows.Count

For i = 2 To Totalregistro
    box_vendedor.AddItem Cells(i, 1)
        
        Next




busca_detalhada.Visible = False
label_custo.Visible = False
custo_relatorio.Visible = False

label_lucro_relatorio.Visible = False
lucro_relatorio.Visible = False


End Sub



============================================================
MODULE: Módulo20.bas
============================================================
Attribute VB_Name = "Módulo20"
Sub outexp()
Attribute outexp.VB_ProcData.VB_Invoke_Func = " \n14"
'
' outexp Macro
'

'
Totalregistro = Worksheets("outputexpdata").UsedRange.Rows.Count + 1
Worksheets("expdata").Select
    Range("A3:B16").Select
    Selection.Copy
    Application.CutCopyMode = False
    Selection.Cut
    Sheets("outputexpdata").Select
    ActiveSheet.Cells(Totalregistro, 1).Select
    
    
    
    ActiveSheet.Paste
End Sub



============================================================
MODULE: Plan9.cls
============================================================
Attribute VB_Name = "Plan9"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: venda.frm
============================================================
Attribute VB_Name = "venda"
Attribute VB_Base = "0{7A3A35A4-C828-44F8-8D6F-0C8B8DBF45FB}{F28B4FDB-00F0-4E50-A38B-29F7CFD652C9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub acessar_inserir_Click()

End Sub

Private Sub adicionar_venda_Click()


If Not IsNumeric(quantidade_venda) Then
    MsgBox "Quantidade tem que ser um numero", vbInformation, "ATENÇÃO"
Else

    If busca_codigo = "" Then
    
        MsgBox "Colocar Codigo!", vbInformation, "ATENÇÃO"
 
    Else

        If quantidade_venda = "" Then
            MsgBox "Colocar quantidade!", vbInformation, "ATENÇÃO"
            
        Else
    
            Windows("ExploTrack exe").Activate
            Worksheets("Bancodados").Select
            Totalregistro = Worksheets("Bancodados").UsedRange.Rows.Count

            For i = 2 To Totalregistro
                codigo = Cells(i, 1)
                If busca_codigo.Text = codigo Then
                descricao = Cells(i, 5)
                quantidade = Cells(i, 2)
                preco = Cells(i, 4)
                preco_custo_var = Cells(i, 3)
                End If
               
            Next
            
            If descricao = "" Then
             '       MsgBox "Produto não cadastrado", vbInformation, "ATENÇÃO"
            Else
            ''''


            Totalregistro1 = Worksheets("resumo_compra").UsedRange.Rows.Count + 1
            Worksheets("resumo_compra").Select
            
            Cells(Totalregistro1, 1) = quantidade_venda.Value
            Cells(Totalregistro1, 2) = preco.Value
            Cells(Totalregistro1, 3) = descricao.Value
            Cells(Totalregistro1, 4) = busca_codigo.Value
            Cells(Totalregistro1, 5) = preco_custo_var

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

'''''''''''
            ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
            
            For Linha = 2 To ultimalinha
            
            linhalistbox = Linha - 2
            
                With Me.ListBox1
                    .AddItem
                    
                    .List(linhalistbox, 0) = Cells(Linha, 4).Value
                    .List(linhalistbox, 1) = Cells(Linha, 1).Value
                    .List(linhalistbox, 2) = Cells(Linha, 2).Value
                    .List(linhalistbox, 3) = Cells(Linha, 3).Value
                    .List(linhalistbox, 4) = Cells(Linha, 5).Value
                End With
                
            Next

'''' somar venda

Dim vSoma As Double
          
          vSoma = 0
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
          'Definimos o valor do TextBox, o total da soma
    
    '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    
        If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
        End If
          
        If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
        End If
            
        If desconto <> "" And IsNumeric(desconto) Then
          desc = (vSoma * desconto) / 100
          vSoma = vSoma - desc
        End If
          
        If botao_cartao2x = True Then
          Worksheets("juros").Select

          juros2 = (vSoma * Cells(2, 1)) / 100
          vSoma = vSoma + juros2
          
          parcela = Format(Round(vSoma / 2, 2), "R$ 0.00#,##")
        End If
          
        If botao_cartao3x = True Then
          Worksheets("juros").Select
          
          juros3 = (vSoma * Cells(3, 1)) / 100
          vSoma = vSoma + juros3
          
          parcela = Format(Round(vSoma / 3, 2), "R$ 0.00#,##")
        End If
          
        If botao_cartao2x = True Or botao_cartao3x = True Then
          recebido = ""
          troco = ""
        Else
          parcela = ""
        End If
          
          
          ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' se já tiver devendo somar o valor''''''''''''''''''''
    Linha = 2
    linhalistbox = Linha - 2

    Do While Sheets("prazo").Cells(Linha, 1) <> ""

    If Sheets("prazo").Cells(Linha, 13).Text = cpf_prazo Then
       
        valor_prazo_venda = Format(Sheets("prazo").Cells(Linha, 3).Value, "0.00#,##")
        nome_prazo = Sheets("prazo").Cells(Linha, 12).Value
        
        vSoma = vSoma + Sheets("prazo").Cells(Linha, 3).Value
       
    End If
    
    
    Linha = Linha + 1

Loop
          
          '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
          
total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")


''''''''
If recebido <> "" And IsNumeric(recebido) Then

Dim txt1 As Double
Dim txt2 As Double

txt1 = recebido
txt2 = total_venda
tot = txt1 - txt2

troco = Format(tot, "R$ 0.00#,##")
Else
troco = ""
End If

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' venda mista

If botao_misto = True Then
    
        Label_din_misto.Visible = True
        dinheiro_misto.Visible = True
        sobra_card_2x.Visible = True
        sobra_card_3x.Visible = True
        Labelcard_misto.Visible = True
        cartao_misto.Visible = True
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        'Else
        
         '   total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''




''''ativar botão de venda se resumo estiver feito
If Me.ListBox1.Value = "" Or (botao_dinheiro = False And botao_cartao = False And botao_cartao2x = False And botao_cartao3x = False And botao_prazo = False) Then
    fechar_venda.Enabled = False
    
Else

    If Me.ListBox1.Value <> "" And (botao_dinheiro = True Or botao_cartao = True Or botao_cartao2x = True Or botao_cartao3x = True Or botao_prazo = True) Then
        fechar_venda.Enabled = True
    
End If
End If
'''''


quantidade = ""
preco = ""
quantidade_venda = ""
busca_codigo = ""
busca_codigo.SetFocus
descricao = ""




End If
End If
End If
'Definimos o valor da Variável para 0 (zero)
vSoma = 0

End If

End Sub

Private Sub botao_cartao_Click()

Label_din_misto.Visible = False
dinheiro_misto.Visible = False
sobra_card_2x.Visible = False
sobra_card_3x.Visible = False
Labelcard_misto.Visible = False
cartao_misto.Visible = False

Worksheets("resumo_compra").Select
'''' somar venda

Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
           
           
            '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
           
           
             If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
            
            
            If desconto <> "" And IsNumeric(desconto) Then
            desc = (vSoma * desconto) / 100
            vSoma = vSoma - desc
            End If
           
           If botao_cartao2x = True Then
          Worksheets("juros").Select

          juros2 = (vSoma * Cells(2, 1)) / 100
          vSoma = vSoma + juros2
           parcela = Format(Round(vSoma / 2, 2), "R$ 0.00#,##")
           
           End If
          
          If botao_cartao3x = True Then
          Worksheets("juros").Select
          
          juros3 = (vSoma * Cells(3, 1)) / 100
          vSoma = vSoma + juros3
           parcela = Format(Round(vSoma / 3, 2), "R$ 0.00#,##")
           
           End If
           
            If botao_cartao2x = False Or botao_cartao3x = False Then
           parcela = ""
           parcela.Visible = False
           label_parcela.Visible = False
           End If
           
            If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Then
           recebido = ""
           troco = ""
           
            recebido.Visible = False
           troco.Visible = False
           
           label_recebido.Visible = False
           label_troco.Visible = False
           End If
           
           If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Or botao_dinheiro = True Then

            nome_prazo = ""
            cpf_prazo = ""
            valor_prazo_venda = ""
            
            nome_prazo.Visible = False
            label_nome_prazo.Visible = False
            label_cpf_prazo.Visible = False
            cpf_prazo.Visible = False
            valor_prazo_venda.Visible = False
            label_valor_prazo.Visible = False
            
            End If
        
          'Definimos o valor do TextBox, o total da soma
          total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
          'Definimos o valor da Variável para 0 (zero)
          
'''''''
If recebido <> "" And IsNumeric(recebido) Then

Dim txt1 As Double
Dim txt2 As Double

txt1 = recebido
txt2 = total_venda
tot = txt1 - txt2
troco = Format(tot, "R$ 0.00#,##")
End If

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' venda mista

If botao_misto = True Then
    
        Label_din_misto.Visible = True
        dinheiro_misto.Visible = True
        sobra_card_2x.Visible = True
        sobra_card_3x.Visible = True
        Labelcard_misto.Visible = True
        cartao_misto.Visible = True
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        'Else
        
         '   total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

vSoma = 0

''''ativar botão de venda se resumo estiver feito
If ListBox1.Value = "" And (botao_dinheiro = False And botao_cartao = False And botao_cartao2x = False And botao_cartao3x = False And botao_prazo = False) Then
    fechar_venda.Enabled = False
    
Else
    fechar_venda.Enabled = True

End If
'''''

If botao_troca = "Sim" Then
    If valor_credito_venda = "" And IsNumeric(valor_credito_venda) = False Then
        MsgBox "Desative botão troca ou coloque valor certo no credito", vbInformation, "ATENÇÃO"
        fechar_venda.Enabled = False
    End If
End If

If botao_encomenda = "Sim" Then
    If valor_encomenda = "" And IsNumeric(valor_encomenda) = False Then
        fechar_venda.Enabled = False
    End If
End If

If vendedores = "" Then
    
    fechar_venda.Enabled = False
    
    MsgBox "coloque o vendedor", vbInformation, "ATENÇÃO"
End If


If Me.ListBox1.ListCount > 0 Then
    fechar_venda.Enabled = True
Else
    fechar_venda.Enabled = False
    MsgBox "adicione o codigo e quantidade no botão da sacola", vbInformation, "ATENÇÃO"
End If


End Sub

Private Sub botao_cartao2x_Click()

Label_din_misto.Visible = False
dinheiro_misto.Visible = False
sobra_card_2x.Visible = False
sobra_card_3x.Visible = False
Labelcard_misto.Visible = False
cartao_misto.Visible = False

Worksheets("resumo_compra").Select

'''' somar venda

Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
           
           
            '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
           
            
             If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
            
            If desconto <> "" And IsNumeric(desconto) Then
            desc = (vSoma * desconto) / 100
            vSoma = vSoma - desc
            End If
           
           If botao_cartao2x = True Then
          Worksheets("juros").Select

          juros2 = (vSoma * Cells(2, 1)) / 100
          vSoma = vSoma + juros2
          parcela.Visible = True
          label_parcela.Visible = True
          
           parcela = Format(Round(vSoma / 2, 2), "R$ 0.00#,##")
           End If
          
          If botao_cartao3x = True Then
          Worksheets("juros").Select
          
          juros3 = (vSoma * Cells(3, 1)) / 100
          vSoma = vSoma + juros3
          
          parcela.Visible = True
          label_parcela.Visible = True
          
           parcela = Format(Round(vSoma / 3, 2), "R$ 0.00#,##")
           End If
           
           If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Then
           recebido = ""
           troco = ""
           
           recebido.Visible = False
           troco.Visible = False
           
           label_recebido.Visible = False
           label_troco.Visible = False
           
           recebido.Enabled = False
           troco.Enabled = False
           End If
           
           If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Or botao_dinheiro = True Then

            nome_prazo = ""
            cpf_prazo = ""
            valor_prazo_venda = ""
            
            nome_prazo.Visible = False
            label_nome_prazo.Visible = False
            label_cpf_prazo.Visible = False
            cpf_prazo.Visible = False
            valor_prazo_venda.Visible = False
            label_valor_prazo.Visible = False
            
            End If
           
          'Definimos o valor do TextBox, o total da soma
          total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
          'Definimos o valor da Variável para 0 (zero)
          
'''''''
If recebido <> "" And IsNumeric(recebido) Then

Dim txt1 As Double
Dim txt2 As Double

txt1 = recebido
txt2 = total_venda
tot = txt1 - txt2
troco = Format(tot, "R$ 0.00#,##")
End If

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' venda mista

If botao_misto = True Then
    
        Label_din_misto.Visible = True
        dinheiro_misto.Visible = True
        sobra_card_2x.Visible = True
        sobra_card_3x.Visible = True
        Labelcard_misto.Visible = True
        cartao_misto.Visible = True
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        'Else
        
         '   total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

vSoma = 0

''''ativar botão de venda se resumo estiver feito
If ListBox1.Value = "" And (botao_dinheiro = False And botao_cartao = False And botao_cartao2x = False And botao_cartao3x = False And botao_prazo = False) Then
    fechar_venda.Enabled = False
    
Else
    fechar_venda.Enabled = True

End If
'''''

If botao_troca = "Sim" Then
    If valor_credito_venda = "" And IsNumeric(valor_credito_venda) = False Then
        MsgBox "Desative botão troca ou coloque valor certo no credito", vbInformation, "ATENÇÃO"
        fechar_venda.Enabled = False
    End If
End If

If botao_encomenda = "Sim" Then
    If valor_encomenda = "" And IsNumeric(valor_encomenda) = False Then
        fechar_venda.Enabled = False
    End If
End If

If vendedores = "" Then
    
    fechar_venda.Enabled = False
    MsgBox "coloque o vendedor", vbInformation, "ATENÇÃO"
End If



If Me.ListBox1.ListCount > 0 Then
    fechar_venda.Enabled = True
Else
    fechar_venda.Enabled = False
    MsgBox "adicione o codigo e quantidade no botão da sacola", vbInformation, "ATENÇÃO"
End If



End Sub

Private Sub botao_cartao3x_Click()

Label_din_misto.Visible = False
dinheiro_misto.Visible = False
sobra_card_2x.Visible = False
sobra_card_3x.Visible = False
Labelcard_misto.Visible = False
cartao_misto.Visible = False

Worksheets("resumo_compra").Select

'''' somar venda

Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
           
           
            '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
           
           
             If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
            
            
            If desconto <> "" And IsNumeric(desconto) Then
            desc = (vSoma * desconto) / 100
            vSoma = vSoma - desc
            End If
           
           If botao_cartao2x = True Then
          Worksheets("juros").Select

          juros2 = (vSoma * Cells(2, 1)) / 100
          vSoma = vSoma + juros2
          
          parcela.Visible = True
          label_parcela.Visible = True
          
           parcela = Format(Round(vSoma / 2, 2), "R$ 0.00#,##")
           
           End If
          
          If botao_cartao3x = True Then
          Worksheets("juros").Select
          
          juros3 = (vSoma * Cells(3, 1)) / 100
          vSoma = vSoma + juros3
          
          parcela.Visible = True
          label_parcela.Visible = True
          
           parcela = Format(Round(vSoma / 3, 2), "R$ 0.00#,##")
           
           End If
           
           If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Then
           recebido = ""
           troco = ""
           
           recebido.Enabled = False
           troco.Enabled = False
           
           recebido.Visible = False
           troco.Visible = False
           
           label_recebido.Visible = False
           label_troco.Visible = False
           
           End If
           
           
           If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Or botao_dinheiro = True Then

            nome_prazo = ""
            cpf_prazo = ""
            valor_prazo_venda = ""
            
            nome_prazo.Visible = False
            label_nome_prazo.Visible = False
            label_cpf_prazo.Visible = False
            cpf_prazo.Visible = False
            valor_prazo_venda.Visible = False
            label_valor_prazo.Visible = False
            
            End If
           
          'Definimos o valor do TextBox, o total da soma
          total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
          'Definimos o valor da Variável para 0 (zero)
          
'''''''
If recebido <> "" And IsNumeric(recebido) Then

Dim txt1 As Double
Dim txt2 As Double

txt1 = recebido
txt2 = total_venda
tot = txt1 - txt2
troco = Format(tot, "R$ 0.00#,##")
End If

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' venda mista

If botao_misto = True Then
    
        Label_din_misto.Visible = True
        dinheiro_misto.Visible = True
        sobra_card_2x.Visible = True
        sobra_card_3x.Visible = True
        Labelcard_misto.Visible = True
        cartao_misto.Visible = True
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        'Else
        
         '   total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''


vSoma = 0

''''ativar botão de venda se resumo estiver feito
If ListBox1.Value = "" And (botao_dinheiro = False And botao_cartao = False And botao_cartao2x = False And botao_cartao3x = False And botao_prazo = False) Then
    fechar_venda.Enabled = False
    
Else
    fechar_venda.Enabled = True

End If
'''''

If botao_troca = "Sim" Then
    If valor_credito_venda = "" And IsNumeric(valor_credito_venda) = False Then
        MsgBox "Desative botão troca ou coloque valor certo no credito", vbInformation, "ATENÇÃO"
        fechar_venda.Enabled = False
    End If
End If

If botao_encomenda = "Sim" Then
    If valor_encomenda = "" And IsNumeric(valor_encomenda) = False Then
        fechar_venda.Enabled = False
    End If
End If

If vendedores = "" Then
    
    fechar_venda.Enabled = False
    MsgBox "coloque o vendedor", vbInformation, "ATENÇÃO"
End If



If Me.ListBox1.ListCount > 0 Then
    fechar_venda.Enabled = True
Else
    fechar_venda.Enabled = False
    MsgBox "adicione o codigo e quantidade no botão da sacola", vbInformation, "ATENÇÃO"
End If


End Sub

Private Sub botao_Click()
Unload venda
creditos_venda.Show
End Sub

Private Sub botao_dinheiro_Click()


Worksheets("resumo_compra").Select

Label_din_misto.Visible = False
dinheiro_misto.Visible = False
sobra_card_2x.Visible = False
sobra_card_3x.Visible = False
Labelcard_misto.Visible = False
cartao_misto.Visible = False

'''' somar venda

Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
      
      
      '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
      
      
        If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
        End If
          
        If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
      
            
            
            If desconto <> "" And IsNumeric(desconto) Then
            desc = (vSoma * desconto) / 100
            vSoma = vSoma - desc
            End If
           
           If botao_cartao2x = True Then
          Worksheets("juros").Select

          juros2 = (vSoma * Cells(2, 1)) / 100
          vSoma = vSoma + juros2
           parcela = Format(Round(vSoma / 2, 2), "R$ 0.00#,##")
                      
           End If
          
          If botao_cartao3x = True Then
          Worksheets("juros").Select
          
          juros3 = (vSoma * Cells(3, 1)) / 100
          vSoma = vSoma + juros3
           parcela = Format(Round(vSoma / 3, 2), "R$ 0.00#,##")
           
           End If
           
           If botao_cartao2x = False Or botao_cartao3x = False Then
           parcela = ""
           parcela.Visible = False
           label_parcela.Visible = False
           
           End If
           
           If botao_cartao2x = False Or botao_cartao3x = False Or botao_cartao = False Then
           recebido.Enabled = True
           troco.Enabled = True
           
           recebido.Visible = True
           troco.Visible = True
           
           label_recebido.Visible = True
           label_troco.Visible = True
           
           End If
           
           If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Or botao_dinheiro = True Then

            nome_prazo = ""
            cpf_prazo = ""
            valor_prazo_venda = ""
            
            nome_prazo.Visible = False
            label_nome_prazo.Visible = False
            label_cpf_prazo.Visible = False
            cpf_prazo.Visible = False
            valor_prazo_venda.Visible = False
            label_valor_prazo.Visible = False
            
            End If
           
          'Definimos o valor do TextBox, o total da soma
          total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
          'Definimos o valor da Variável para 0 (zero)
          
'''''''
If recebido <> "" And IsNumeric(recebido) Then

Dim txt1 As Double
Dim txt2 As Double

txt1 = recebido
txt2 = total_venda
tot = txt1 - txt2

troco = Format(tot, "R$ 0.00#,##")
Else
troco = ""
End If

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' venda mista

If botao_misto = True Then
    
        Label_din_misto.Visible = True
        dinheiro_misto.Visible = True
        sobra_card_2x.Visible = True
        sobra_card_3x.Visible = True
        Labelcard_misto.Visible = True
        cartao_misto.Visible = True
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        'Else
        
         '   total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''


vSoma = 0

''''ativar botão de venda se resumo estiver feito
If ListBox1.Value = "" And (botao_dinheiro = False And botao_cartao = False And botao_cartao2x = False And botao_cartao3x = False And botao_prazo = False) Then
    fechar_venda.Enabled = False
Else
    fechar_venda.Enabled = True
End If
'''''

If botao_troca = "Sim" Then
    If valor_credito_venda = "" And IsNumeric(valor_credito_venda) = False Then
        MsgBox "Desative botão troca ou coloque valor certo no credito", vbInformation, "ATENÇÃO"
        fechar_venda.Enabled = False
    End If
End If

If botao_encomenda = "Sim" Then
    If valor_encomenda = "" And IsNumeric(valor_encomenda) = False Then
        fechar_venda.Enabled = False
    End If
End If

If vendedores = "" Then
    
    fechar_venda.Enabled = False
    MsgBox "coloque o vendedor", vbInformation, "ATENÇÃO"
End If


If Me.ListBox1.ListCount > 0 Then
    fechar_venda.Enabled = True
Else
    fechar_venda.Enabled = False
    MsgBox "adicione o codigo e quantidade no botão da sacola", vbInformation, "ATENÇÃO"
End If


End Sub

Private Sub botao_encomenda_Change()
label_encomenda.Visible = False
valor_encomenda.Visible = False


If botao_encomenda = "Sim" Then

label_encomenda.Visible = True
valor_encomenda.Visible = True

End If

End Sub

Private Sub botao_misto_Click()


Worksheets("resumo_compra").Select

'''' somar venda

Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
      
      
      '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
      
      
             If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
      
            
            
            If desconto <> "" And IsNumeric(desconto) Then
            desc = (vSoma * desconto) / 100
            vSoma = vSoma - desc
            End If
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    If botao_misto = True Then
    
        Label_din_misto.Visible = True
        dinheiro_misto.Visible = True
        sobra_card_2x.Visible = True
        sobra_card_3x.Visible = True
        Labelcard_misto.Visible = True
        cartao_misto.Visible = True
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        Else
        
            total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If
    
    
    
    'Definimos o valor da Variável para 0 (zero)
    vSoma = 0
'''''''


''''ativar botão de venda se resumo estiver feito
If ListBox1.Value = "" And (botao_misto = False And botao_dinheiro = False And botao_cartao = False And botao_cartao2x = False And botao_cartao3x = False And botao_prazo = False) Then
    fechar_venda.Enabled = False
Else

    fechar_venda.Enabled = True

End If
'''''

If botao_troca = "Sim" Then
    If valor_credito_venda = "" And IsNumeric(valor_credito_venda) = False Then
        MsgBox "Desative botão troca ou coloque valor certo no credito", vbInformation, "ATENÇÃO"
        fechar_venda.Enabled = False
    End If
End If

If botao_encomenda = "Sim" Then
    If valor_encomenda = "" And IsNumeric(valor_encomenda) = False Then
        fechar_venda.Enabled = False
    End If
End If

If vendedores = "" Then
    
    fechar_venda.Enabled = False
    MsgBox "coloque o vendedor", vbInformation, "ATENÇÃO"
End If



End Sub

Private Sub botao_pix_Click()

Label_din_misto.Visible = False
dinheiro_misto.Visible = False
sobra_card_2x.Visible = False
sobra_card_3x.Visible = False
Labelcard_misto.Visible = False
cartao_misto.Visible = False



recebido = ""
troco = ""
           
recebido.Visible = False
troco.Visible = False
           
label_recebido.Visible = False
label_troco.Visible = False


nome_prazo = ""
cpf_prazo = ""
valor_prazo_venda = ""
            
nome_prazo.Visible = False
label_nome_prazo.Visible = False
label_cpf_prazo.Visible = False
cpf_prazo.Visible = False
valor_prazo_venda.Visible = False
label_valor_prazo.Visible = False


Worksheets("resumo_compra").Select
'''' somar venda

Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
           
           
            '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
           
           
             If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
            
            
            If desconto <> "" And IsNumeric(desconto) Then
            desc = (vSoma * desconto) / 100
            vSoma = vSoma - desc
            End If
           
           If botao_cartao2x = True Then
          Worksheets("juros").Select

          juros2 = (vSoma * Cells(2, 1)) / 100
          vSoma = vSoma + juros2
           parcela = Format(Round(vSoma / 2, 2), "R$ 0.00#,##")
           
           End If
          
          If botao_cartao3x = True Then
          Worksheets("juros").Select
          
          juros3 = (vSoma * Cells(3, 1)) / 100
          vSoma = vSoma + juros3
           parcela = Format(Round(vSoma / 3, 2), "R$ 0.00#,##")
           
           End If
           
            If botao_cartao2x = False Or botao_cartao3x = False Then
           parcela = ""
           parcela.Visible = False
           label_parcela.Visible = False
           End If
           
            If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Then
           recebido = ""
           troco = ""
           
            recebido.Visible = False
           troco.Visible = False
           
           label_recebido.Visible = False
           label_troco.Visible = False
           End If
           
           If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Or botao_dinheiro = True Then

            nome_prazo = ""
            cpf_prazo = ""
            valor_prazo_venda = ""
            
            nome_prazo.Visible = False
            label_nome_prazo.Visible = False
            label_cpf_prazo.Visible = False
            cpf_prazo.Visible = False
            valor_prazo_venda.Visible = False
            label_valor_prazo.Visible = False
            
            End If
        
          'Definimos o valor do TextBox, o total da soma
          total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
          'Definimos o valor da Variável para 0 (zero)
          
'''''''
If recebido <> "" And IsNumeric(recebido) Then

Dim txt1 As Double
Dim txt2 As Double

txt1 = recebido
txt2 = total_venda
tot = txt1 - txt2
troco = Format(tot, "R$ 0.00#,##")
End If

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' venda mista

If botao_misto = True Then
    
        Label_din_misto.Visible = True
        dinheiro_misto.Visible = True
        sobra_card_2x.Visible = True
        sobra_card_3x.Visible = True
        Labelcard_misto.Visible = True
        cartao_misto.Visible = True
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        'Else
        
         '   total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

vSoma = 0

''''ativar botão de venda se resumo estiver feito
If ListBox1.Value = "" And (botao_dinheiro = False And botao_cartao = False And botao_cartao2x = False And botao_cartao3x = False And botao_prazo = False) Then
    fechar_venda.Enabled = False
    
Else
    fechar_venda.Enabled = True

End If
'''''

If botao_troca = "Sim" Then
    If valor_credito_venda = "" And IsNumeric(valor_credito_venda) = False Then
        MsgBox "Desative botão troca ou coloque valor certo no credito", vbInformation, "ATENÇÃO"
        fechar_venda.Enabled = False
    End If
End If

If botao_encomenda = "Sim" Then
    If valor_encomenda = "" And IsNumeric(valor_encomenda) = False Then
        fechar_venda.Enabled = False
    End If
End If

If vendedores = "" Then
    
    fechar_venda.Enabled = False
    
    MsgBox "coloque o vendedor", vbInformation, "ATENÇÃO"
End If


If Me.ListBox1.ListCount > 0 Then
    fechar_venda.Enabled = True
Else
    fechar_venda.Enabled = False
    MsgBox "adicione o codigo e quantidade no botão da sacola", vbInformation, "ATENÇÃO"
End If

End Sub

Private Sub botao_prazo_Click()

Label_din_misto.Visible = False
dinheiro_misto.Visible = False
sobra_card_2x.Visible = False
sobra_card_3x.Visible = False
Labelcard_misto.Visible = False
cartao_misto.Visible = False

If botao_prazo = True Then

    nome_prazo.Visible = True
    label_nome_prazo.Visible = True
    label_cpf_prazo.Visible = True
    cpf_prazo.Visible = True
    
    fechar_venda.Enabled = False
    
    
    parcela = ""
    parcela.Visible = False
    label_parcela.Visible = False
    
    recebido = ""
    troco = ""
               
    recebido.Visible = False
    troco.Visible = False
               
    label_recebido.Visible = False
    label_troco.Visible = False
End If

If botao_troca = "Sim" Then
    If valor_credito_venda = "" And IsNumeric(valor_credito_venda) = False Then
        MsgBox "Desative botão troca ou coloque valor certo no credito", vbInformation, "ATENÇÃO"
        fechar_venda.Enabled = False
    End If
End If

If botao_encomenda = "Sim" Then
    If valor_encomenda = "" And IsNumeric(valor_encomenda) = False Then
        fechar_venda.Enabled = False
    End If
End If

If vendedores = "" Then
    
    fechar_venda.Enabled = False
    MsgBox "coloque o vendedor", vbInformation, "ATENÇÃO"
End If



End Sub

Private Sub botao_troca_Change()


If botao_troca = "Sim" Then

fechar_venda.Enabled = True
label_valor_credito.Visible = True
label_cpf.Visible = True
cpf_busca_credito.Visible = True
valor_credito_venda.Visible = True

Else

fechar_venda.Enabled = False
label_valor_credito.Visible = False
label_cpf.Visible = False
cpf_busca_credito.Visible = False
valor_credito_venda.Visible = False

cpf_busca_credito = ""
valor_credito_venda = ""

End If


If botao_troca <> "Sim" Then
    fechar_venda.Enabled = False
End If

If Me.ListBox1.ListCount > 0 Then
    fechar_venda.Enabled = True
Else
    fechar_venda.Enabled = False
    MsgBox "adicione o codigo e quantidade no botão da sacola", vbInformation, "ATENÇÃO"
End If

End Sub

Private Sub busca_codigo_Change()

If busca_codigo = "" Then

Else
If Not IsNumeric(busca_codigo) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 busca_codigo = ""
 
 End If
  End If

If busca_codigo = "" Then

Else

Worksheets("Bancodados").Select

Totalregistro = Worksheets("Bancodados").UsedRange.Rows.Count

descricao = ""
quantidade = ""
preco = ""

For i = 2 To Totalregistro
    codigo = Cells(i, 1)
    If busca_codigo.Text = codigo Then
4331111        descricao = Cells(i, 5)
        quantidade = Cells(i, 2).Value
        preco = Cells(i, 4)
    
    End If
        
        Next
    


If quantidade = "0" Then
        adicionar_venda.Enabled = False
        'MsgBox "Produto Indisponivel", vbInformation, "ATENÇÃO"
        
        Else
        adicionar_venda.Enabled = True
End If

End If
End Sub

Private Sub buscar_venda_Click()

Windows("ExploTrack exe").Activate
Worksheets("Bancodados").Select

Totalregistro = Worksheets("Bancodados").UsedRange.Rows.Count

descricao = ""
quantidade = ""
preco = ""

For i = 2 To Totalregistro
    codigo = Cells(i, 1)
    If busca_codigo = codigo Then
        descricao = Cells(i, 5)
        quantidade = Cells(i, 2)
        preco = Cells(i, 4)
    
    End If
        
        Next
    
If descricao = "" Then
        MsgBox "Produto não cadastrado", vbInformation, "ATENÇÃO"
    
End If
    
    

End Sub

Private Sub CheckBox1_Click()

End Sub

Private Sub CommandButton1_Click()

End Sub

Private Sub CommandButton10_Click()
Unload venda
parametros.Show
End Sub

Private Sub CommandButton11_Click()
Unload venda
inicio.Show
End Sub

Private Sub CommandButton12_Click()
resposta = MsgBox("Deseja realmente sair?", vbYesNo, "ATENÇÃO")
    If resposta = vbYes Then
    ActiveWorkbook.Save
    Application.Quit
    Else
    ActiveWorkbook.Save
    Exit Sub
    End If
End Sub

Private Sub CommandButton13_Click()
Unload venda
prazo.Show
End Sub

Private Sub CommandButton9_Click()
Unload venda
relatorio.Show
End Sub

Private Sub contagem_inicio_Click()
Unload venda
acess_cadastro.Show
End Sub

Private Sub cpf_busca_credito_Change()


valor_credito_venda = ""

Worksheets("credito_clientes").Select
Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    cpf_b_credito = cpf_busca_credito.Text
    cpf_b_credito = LCase(cpf_b_credito)
    
    found = Cells(i, 2).Text
    found = LCase(found)
    
    If cpf_b_credito = found Then
               
        valor_credito_venda = Format(Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next


'#############################################################################################

If valor_credito_venda = Format(0, "R$ 0.00#,##") Or valor_credito_venda = "" Then

''''''''''''''''''''''''''''''''venda sem credito
Worksheets("resumo_compra").Select


Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
           
            
        If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          vSoma = vSoma + valor_encomenda.Value
        End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
            
            
            If desconto <> "" And IsNumeric(desconto) Then
            desc = (vSoma * desconto) / 100
            vSoma = vSoma - desc
            End If
           
           If botao_cartao2x = True Then
          Worksheets("juros").Select

          juros2 = (vSoma * Cells(2, 1)) / 100
          vSoma = vSoma + juros2
          parcela.Visible = True
          label_parcela.Visible = True
          parcela = Format(Round(vSoma / 2, 2), "R$ 0.00#,##")
           End If
          
          If botao_cartao3x = True Then
          Worksheets("juros").Select
          
          juros3 = (vSoma * Cells(3, 1)) / 100
          vSoma = vSoma + juros3
          
          parcela.Visible = True
          label_parcela.Visible = True
          parcela = Format(Round(vSoma / 3, 2), "R$ 0.00#,##")
           End If
           
           If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Then
           recebido = ""
           troco = ""
           
           recebido.Visible = False
           troco.Visible = False
           
           label_recebido.Visible = False
           label_troco.Visible = False
           
           End If
           
           If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Then
           recebido.Enabled = False
           troco.Enabled = False
           End If
                               
                    
          'Definimos o valor do TextBox, o total da soma
          total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
          'Definimos o valor da Variável para 0 (zero)
          
'''''''
If recebido <> "" And IsNumeric(recebido) Then

Dim txt1 As Double
Dim txt2 As Double

txt1 = recebido
txt2 = total_venda
tot = txt1 - txt2

troco = Format(tot, "R$ 0.00#,##")

End If

''''''''''''''''''''''''''''''''''''''''''''''''' se for troca

Else
Worksheets("resumo_compra").Select

          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
           
      '''''''''''''''''''''''''''''''''''''''''inserir desconto credito''''''''''''''''''''''''''''
           Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            cpf_b_credito = cpf_busca_credito.Text
            cpf_b_credito = LCase(cpf_b_credito)
            found = Sheets("credito_clientes").Cells(j, 2).Text
            found = LCase(found)
            
            If cpf_b_credito = found Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
            
                If vSoma < 0 Then
                MsgBox "O cliente precisa usar todo o credito", vbInformation, "ATENÇÃO"
                End If
                    
            End If
                
            Loop Until cpf_b_credito = found
            
            
                       
                       
           ''''''''''''''''''''''''''''''''''''''''''''''''''''
           
           '''''''''''''''''''''''''''''''''''''''''''''''''''''' somar com valor da encomenda
           If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
           
           ''''''''''''''''''''''''''''''''''''
           
           
           
                       
            If desconto <> "" Then
            desc = (vSoma * desconto) / 100
            vSoma = vSoma - desc
            End If
                       
                       
           If botao_cartao2x = True Then
          Worksheets("juros").Select

          juros2 = (vSoma * Cells(2, 1)) / 100
          vSoma = vSoma + juros2
          parcela.Visible = True
          label_parcela.Visible = True
          parcela = Format(vSoma / 2, "R$ 0.00#,##")
                     
           End If
          
          If botao_cartao3x = True Then
          Worksheets("juros").Select
          
          juros3 = (vSoma * Cells(3, 1)) / 100
          vSoma = vSoma + juros3
          
          parcela.Visible = True
          label_parcela.Visible = True
          parcela = Format(vSoma / 3, "R$ 0.00#,##")
          
          End If
           
           If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Then
           recebido = ""
           troco = ""
           
           recebido.Visible = False
           troco.Visible = False
           
           label_recebido.Visible = False
           label_troco.Visible = False
           
           End If
           
           If botao_cartao2x = True Or botao_cartao3x = True Or botao_cartao = True Then
           recebido.Enabled = False
           troco.Enabled = False
           End If
           
           
           
                   
                  
          'Definimos o valor do TextBox, o total da soma
          If vSoma < 0 Then
            MsgBox "O cliente precisa usar todo o credito", vbInformation, "ATENÇÃO"
          End If
          
          total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
         
          'Definimos o valor da Variável para 0 (zero)
          
'''''''
If recebido <> "" Then
txt1 = recebido
txt2 = total_venda
tot = txt1 - txt2

troco = Format(tot, "R$ 0.00#,##")
Else
troco = ""
End If
End If

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' venda mista

If botao_misto = True Then
    
        Label_din_misto.Visible = True
        dinheiro_misto.Visible = True
        sobra_card_2x.Visible = True
        sobra_card_3x.Visible = True
        Labelcard_misto.Visible = True
        cartao_misto.Visible = True
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        'Else
        
         '   total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

vSoma = 0


End Sub

Private Sub cpf_prazo_Change()

If cpf_prazo = "" Then

Else
If Not IsNumeric(cpf_prazo) Then

 MsgBox "Só aceita numeros. Coloque telefone ou cpf completo", vbInformation, "ATENÇÃO"
 cpf_prazo = ""
 
 End If
End If

nome_prazo = ""
valor_prazo_venda = ""
valor_prazo_venda.Visible = False
label_valor_prazo.Visible = False

'''' somar venda
Worksheets("resumo_compra").Select

Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
          'Definimos o valor do TextBox, o total da soma
    
    '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    
    
           If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
          
          
          If desconto <> "" And IsNumeric(desconto) Then
          desc = (vSoma * desconto) / 100
          vSoma = vSoma - desc
          End If
          
          If botao_cartao2x = True Then
          Worksheets("juros").Select

          juros2 = (vSoma * Cells(2, 1)) / 100
          vSoma = vSoma + juros2
          
          parcela = Format(Round(vSoma / 2, 2), "R$ 0.00#,##")
          
           End If
          
          If botao_cartao3x = True Then
          Worksheets("juros").Select
          
          juros3 = (vSoma * Cells(3, 1)) / 100
          vSoma = vSoma + juros3
          
          parcela = Format(Round(vSoma / 3, 2), "R$ 0.00#,##")
          
           End If
          
          If botao_cartao2x = True Or botao_cartao3x = True Then
          recebido = ""
          treco = ""
          Else
          parcela = ""
          End If
          
          
          ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' se já tiver devendo somar o valor''''''''''''''''''''
          Linha = 2
   

    Do While Sheets("prazo").Cells(Linha, 1) <> ""

    If Sheets("prazo").Cells(Linha, 13).Text = cpf_prazo Then
       
        valor_prazo_venda = Format(Sheets("prazo").Cells(Linha, 3).Value, "0.00#,##")
        nome_prazo = Sheets("prazo").Cells(Linha, 12).Value
        
        vSoma = vSoma + Sheets("prazo").Cells(Linha, 3).Value
        valor_prazo_venda.Visible = True
        label_valor_prazo.Visible = True
       
    End If
    
    
    Linha = Linha + 1

Loop
          
          '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
          
          total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
          
                  
          'Definimos o valor da Variável para 0 (zero)
          

''''''''
If recebido <> "" And IsNumeric(recebido) Then

Dim txt1 As Double
Dim txt2 As Double

txt1 = recebido
txt2 = total_venda
tot = txt1 - txt2

troco = Format(tot, "R$ 0.00#,##")
Else
troco = ""
End If


''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' venda mista

If botao_misto = True Then
    
        Label_din_misto.Visible = True
        dinheiro_misto.Visible = True
        sobra_card_2x.Visible = True
        sobra_card_3x.Visible = True
        Labelcard_misto.Visible = True
        cartao_misto.Visible = True
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        'Else
        
         '   total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
vSoma = 0

descricao = ""
quantidade = ""
preco = ""
quantidade_venda = ""
busca_codigo = ""




End Sub

Private Sub desconto_Change()

If desconto = "" Then

Else
If Not IsNumeric(desconto) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 desconto = 0
 
 End If
  End If

'''' somar venda
Worksheets("resumo_compra").Select
Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                
           Next
          'Definimos o valor do TextBox, o total da soma
          
           '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
          
          
           If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
          
          If desconto <> "" And IsNumeric(desconto) Then
          desc = (vSoma * desconto) / 100
          vSoma = vSoma - desc
          End If
          
          
          If botao_cartao2x = True Then
          Worksheets("juros").Select

          juros2 = (vSoma * Cells(2, 1)) / 100
          vSoma = vSoma + juros2
           parcela = Format(Round(vSoma / 2, 2), "R$ 0.00#,##")
           End If
          
          If botao_cartao3x = True Then
          Worksheets("juros").Select
          
          juros3 = (vSoma * Cells(3, 1)) / 100
          vSoma = vSoma + juros3
           parcela = Format(Round(vSoma / 3, 2), "R$ 0.00#,##")
           End If
           
            If botao_cartao2x = True Or botao_cartao3x = True Then
          recebido = ""
          treco = ""
          Else
          parcela = ""
          End If
          
          total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
          'Definimos o valor da Variável para 0 (zero)
          

If recebido <> "" And IsNumeric(recebido) Then

Dim txt1 As Double
Dim txt2 As Double

txt1 = recebido
txt2 = total_venda
tot = txt1 - txt2
troco = Format(tot, "R$ 0.00#,##")
End If

If recebido = "" Then
troco = ""
End If

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' venda mista

If botao_misto = True Then
    
        Label_din_misto.Visible = True
        dinheiro_misto.Visible = True
        sobra_card_2x.Visible = True
        sobra_card_3x.Visible = True
        Labelcard_misto.Visible = True
        cartao_misto.Visible = True
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        'Else
        
         '   total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''


vSoma = 0
'''''''
End Sub

Private Sub descricao_Change()

End Sub

Private Sub dinheiro_misto_Change()
Worksheets("resumo_compra").Select

'''' somar venda

Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
      
      
      '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
      
      
             If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
      
            
            
            If desconto <> "" And IsNumeric(desconto) Then
            desc = (vSoma * desconto) / 100
            vSoma = vSoma - desc
            End If
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    If botao_misto = True Then
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        Else
        
            total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If
    
    
    
    'Definimos o valor da Variável para 0 (zero)
    vSoma = 0
'''''''


''''ativar botão de venda se resumo estiver feito
If ListBox1.Value = "" And (botao_misto = False And botao_dinheiro = False And botao_cartao = False And botao_cartao2x = False And botao_cartao3x = False And botao_prazo = False) Then
    fechar_venda.Enabled = False
    
Else

    fechar_venda.Enabled = True
    

End If



If Me.ListBox1.ListCount > 0 Then
    fechar_venda.Enabled = True
Else
    fechar_venda.Enabled = False
    MsgBox "adicione o codigo e quantidade no botão da sacola", vbInformation, "ATENÇÃO"
End If


'''''
End Sub

Private Sub fechar_venda_Click()
'''' venda detalhada
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual

Windows("ExploTrack exe").Activate
Worksheets("historicovenda").Select
Range("A2").Select

For i = 0 To (ListBox1.ListCount - 1)

Do
If Not (IsEmpty(ActiveCell)) Then
ActiveCell.Offset(1, 0).Select
End If
Loop Until IsEmpty(ActiveCell) = True

ActiveCell.Value = ListBox1.List(i, 1)

If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
    ActiveCell.Offset(0, 1).Value = valor_encomenda.Value 'preco venda
Else
    ActiveCell.Offset(0, 1).Value = ListBox1.List(i, 2) 'preco venda
End If


ActiveCell.Offset(0, 2).Value = ListBox1.List(i, 3)
ActiveCell.Offset(0, 3).Value = Date
ActiveCell.Offset(0, 4).Value = Time
ActiveCell.Offset(0, 5).Value = ListBox1.List(i, 0)
ActiveCell.Offset(0, 6).Value = Sheets("resumo_compra").Cells(i + 2, 5)

If botao_online = "Sim" Then
ActiveCell.Offset(0, 7).Value = "Sim"
Else
ActiveCell.Offset(0, 7).Value = "Nao"
End If

Next
''''''''

'''''''''''''''''''''''''''''''''''''''''''''''''' historico de Venda total

If botao_prazo = False Then

    Windows("ExploTrack exe").Activate
    Worksheets("somatorio_vendas").Select
    
    
    Totalregistro1 = Worksheets("somatorio_vendas").UsedRange.Rows.Count + 1
    
    
    If valor_credito_venda <> Format(0, "R$ 0.00#,##") Or valor_credito_venda <> "" And total_venda = 0 Then
        Cells(Totalregistro1, 1) = "Dinheiro"
        Cells(Totalregistro1, 2) = 1
    End If
        
    
    If botao_dinheiro = True Then
        Cells(Totalregistro1, 1) = "Dinheiro"
    End If
    If botao_pix = True Then
        Cells(Totalregistro1, 1) = "pix"
    End If
    If botao_cartao = True Then
        Cells(Totalregistro1, 1) = "Cartao"
    End If
    If botao_cartao2x Or botao_cartao3x = True Then
        Cells(Totalregistro1, 1) = "Cartao"
    End If
    If botao_misto = True Then
        Cells(Totalregistro1, 1) = "Dinheiro"
        Cells(Totalregistro1 + 1, 1) = "Cartao"
    End If

    If botao_dinheiro = True Or botao_cartao Or botao_pix = True Then
        Cells(Totalregistro1, 2) = 1
    End If
    If botao_cartao2x = True Then
        Cells(Totalregistro1, 2) = 2
    End If
    If botao_cartao3x = True Then
        Cells(Totalregistro1, 2) = 3
    End If
    
    If botao_misto = True Then
        Cells(Totalregistro1, 2) = 1
        Cells(Totalregistro1 + 1, 2) = 1
        If sobra_card_2x = True Then
            Cells(Totalregistro1 + 1, 2) = 2
        End If
        If sobra_card_3x = True Then
            Cells(Totalregistro1 + 1, 2) = 3
        End If
    End If

    ' Quando for venda mista
    If botao_misto = True Then
        valor_venda_din = Format(dinheiro_misto, "0.00#,##")
        valor_venda_card = Format(cartao_misto, "0.00#,##")
        
        Cells(Totalregistro1, 3) = valor_venda_din
        Cells(Totalregistro1 + 1, 3) = valor_venda_card
        
        For i = 0 To 1

            Cells(Totalregistro1 + i, 4) = Date
            Cells(Totalregistro1 + i, 5) = Time
            Cells(Totalregistro1 + i, 6) = vendedores.Value
            Cells(Totalregistro1 + i, 7) = desconto.Value
        
            If valor_credito_venda = Format(0, "R$ 0.00#,##") Or valor_credito_venda = "" Then
                Cells(Totalregistro1 + i, 8) = "Nao"
            Else
                Cells(Totalregistro1 + i, 8) = "Sim"
            End If
        
            Cells(Totalregistro1 + i, 9) = Format(Date, "dd")
            Cells(Totalregistro1 + i, 10) = Format(Date, "mm")
            Cells(Totalregistro1 + i, 11) = Format(Date, "yyyy")
        
            If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
                  
                Cells(Totalregistro1 + i, 12) = "Sim"
            Else
                Cells(Totalregistro1 + i, 12) = "Não"
            End If
            
            If botao_online = "Sim" Then
                Cells(Totalregistro1, 13) = "Sim"
            Else
                Cells(Totalregistro1, 13) = "Nao"
            End If
            
            
            
            
            If botao_misto = True Then
            
            If botao_online = "Sim" Then
                Cells(Totalregistro1 + 1, 13) = "Sim"
            Else
                Cells(Totalregistro1 + 1, 13) = "Nao"
            End If
            
            End If
            
            
            
            
        Next i
            
    Else
        
        valor_venda_total = Format(total_venda, "0.00#,##")
        Cells(Totalregistro1, 3) = valor_venda_total
        
        Cells(Totalregistro1, 4) = Date
        Cells(Totalregistro1, 5) = Time
        Cells(Totalregistro1, 6) = vendedores.Value
        Cells(Totalregistro1, 7) = desconto.Value
    
        If valor_credito_venda = Format(0, "R$ 0.00#,##") Or valor_credito_venda = "" Then
            Cells(Totalregistro1, 8) = "Nao"
        Else
            Cells(Totalregistro1, 8) = "Sim"
        End If
    
        Cells(Totalregistro1, 9) = Format(Date, "dd")
        Cells(Totalregistro1, 10) = Format(Date, "mm")
        Cells(Totalregistro1, 11) = Format(Date, "yyyy")
    
        If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
              
            Cells(Totalregistro1, 12) = "Sim"
        Else
            Cells(Totalregistro1, 12) = "Não"
        End If
        
        If botao_online = "Sim" Then
              
            Cells(Totalregistro1, 13) = "Sim"
        Else
            Cells(Totalregistro1, 13) = "Nao"
        End If
        
        
    End If

''''''''''''se for a prazo, salvar na tabela a prazo''''
Else

''''''''''''' se já estiver devendo, somar na conta da pessoa
    Linha = 1

    Do
    Linha = Linha + 1
    
    If Sheets("prazo").Cells(Linha, 13).Text = cpf_prazo Then
        Worksheets("prazo").Select
       
        Cells(Linha, 1) = "Prazo"

        Cells(Linha, 2) = 1
        
        valor_venda_total = Format(total_venda, "0.00#,##")
        Cells(Linha, 3) = valor_venda_total
        Cells(Linha, 4) = Date
        Cells(Linha, 5) = Time
        Cells(Linha, 6) = vendedores.Value
        Cells(Linha, 7) = desconto.Value
        
        If valor_credito_venda = Format(0, "R$ 0.00#,##") Or valor_credito_venda = "" Then
            Cells(Linha, 8) = "Nao"
        Else
            Cells(Linha, 8) = "Sim"
        End If
        
        Cells(Linha, 9) = Format(Date, "dd")
        Cells(Linha, 10) = Format(Date, "mm")
        Cells(Linha, 11) = Format(Date, "yyyy")
        Cells(Linha, 12) = nome_prazo.Value
        Cells(Linha, 13) = cpf_prazo.Text
        
        If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
            Cells(Linha, 14) = "Sim"
        Else
            Cells(Linha, 14) = "Não"
        End If
        
        If botao_online = "Sim" Then
              
            Cells(Linha, 15) = "Nao"
        Else
            Cells(Linha, 15) = "Nao"
        End If
       
    End If
    
    Loop Until Sheets("prazo").Cells(Linha, 13).Text = cpf_prazo Or Sheets("prazo").Cells(Linha, 1) = ""



''''''
    If Sheets("prazo").Cells(Linha, 13).Text <> cpf_prazo Then

        Worksheets("prazo").Select
        
        Totalregistro1 = Worksheets("prazo").UsedRange.Rows.Count + 1


        Cells(Totalregistro1, 1) = "Prazo"

        Cells(Totalregistro1, 2) = 1

        valor_venda_total = Format(total_venda, "0.00#,##")
        Cells(Totalregistro1, 3) = valor_venda_total
        Cells(Totalregistro1, 4) = Date
        Cells(Totalregistro1, 5) = Time
        Cells(Totalregistro1, 6) = vendedores.Value
        Cells(Totalregistro1, 7) = desconto.Value

        If valor_credito_venda = Format(0, "R$ 0.00#,##") Or valor_credito_venda = "" Then
            Cells(Totalregistro1, 8) = "Nao"
        Else
            Cells(Totalregistro1, 8) = "Sim"
        End If
        
        Cells(Totalregistro1, 9) = Format(Date, "dd")
        Cells(Totalregistro1, 10) = Format(Date, "mm")
        Cells(Totalregistro1, 11) = Format(Date, "yyyy")
        Cells(Totalregistro1, 12) = nome_prazo.Value
        Cells(Totalregistro1, 13) = cpf_prazo.Text

        If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
            Cells(Totalregistro1, 14) = "Sim"
        Else
            Cells(Totalregistro1, 14) = "Não"
        End If
        
        If botao_online = "Sim" Then
              
            Cells(Linha, 15) = "Nao"
        Else
            Cells(Linha, 15) = "Nao"
        End If
        
    End If
    
    
    Worksheets("prazo_detalhe").Select
    Range("A2").Select
    
    For i = 0 To (ListBox1.ListCount - 1)
    
    Do
    If Not (IsEmpty(ActiveCell)) Then
    ActiveCell.Offset(1, 0).Select
    End If
    Loop Until IsEmpty(ActiveCell) = True
    
    ActiveCell.Value = ListBox1.List(i, 1) ' quantidade
    ActiveCell.Offset(0, 2).Value = ListBox1.List(i, 3) 'descricao
    
    If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
        ActiveCell.Offset(0, 1).Value = valor_encomenda.Value 'preco venda
        ActiveCell.Value = 1 ' quantidade
        ActiveCell.Offset(0, 2).Value = "Encomenda" 'descricao
    Else
        ActiveCell.Offset(0, 1).Value = ListBox1.List(i, 2) 'preco venda
    End If
    
    ActiveCell.Offset(0, 3).Value = Date
    ActiveCell.Offset(0, 4).Value = Time
    ActiveCell.Offset(0, 5).Value = ListBox1.List(i, 0)
    ActiveCell.Offset(0, 6).Value = vendedores.Value
    ActiveCell.Offset(0, 7).Value = nome_prazo.Value
    ActiveCell.Offset(0, 8) = cpf_prazo.Text
    Next
    
    
End If


''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' subtrair venda do estoque e apagar credito########################

Totalregistro1 = Worksheets("resumo_compra").UsedRange.Rows.Count
Dim j As Double
j = 1

For i = 2 To Totalregistro1
    
    Do
    j = j + 1
    
    If Sheets("Bancodados").Cells(j, 1).Value = Sheets("resumo_compra").Cells(i, 4).Value Then
    
    a = Sheets("Bancodados").Cells(j, 2).Value
    b = Sheets("resumo_compra").Cells(i, 1).Value
    Sheets("Bancodados").Cells(j, 2) = a - b
        
    End If
    
    Loop Until Sheets("Bancodados").Cells(j, 1).Value = Sheets("resumo_compra").Cells(i, 4).Value
    
    j = 1
Next

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''##############################################


'''' atualizar resumo venda

Worksheets("resumo_compra").Range("A2:E10000").ClearContents


''''''''''''''''''''''''''''''''''''''''''''''''' se for troca, subtrair o credito e eliminar quem ficar zerado
Worksheets("credito_clientes").Select
If valor_credito_venda <> Format(0, "R$ 0.00#,##") Or valor_credito_venda <> "" Then

Totalcredito = Worksheets("credito_clientes").UsedRange.Rows.Count
           For i = 2 To Totalcredito
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
    
            Sheets("credito_clientes").Rows(i).Select
            Selection.Delete Shift:=xlUp
    
        End If
        
         Next
           
End If


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

''''Limpar os campo depois da venda finalizada
ActiveWorkbook.Save


botao_encomenda = ""
botao_troca = ""
botao_online = ""


nome_prazo = ""
nome_prazo.Visible = False
label_nome_prazo.Visible = False
label_cpf_prazo.Visible = False

cpf_prazo.Visible = False
cpf_prazo = ""


busca_codigo = ""
quantidade_venda = ""
descricao = ""
quantidade = ""
preco = ""
ListBox1.Clear



valor_encomenda = ""

desconto = 0
total_venda = Format(0, "R$ 0.00#,##")
recebido = ""
troco = ""
parcela = ""

'''''
fechar_venda.Enabled = False
    
botao_misto = False
botao_pix = False
botao_dinheiro = False
botao_cartao = False
botao_cartao2x = False
botao_cartao3x = False
botao_prazo = False


Label_din_misto.Visible = False
dinheiro_misto.Visible = False
dinheiro_misto = ""
sobra_card_2x.Visible = False
sobra_card_2x = False
sobra_card_3x.Visible = False
sobra_card_3x = False
Labelcard_misto.Visible = False
cartao_misto.Visible = False
cartao_misto = ""


valor_prazo_venda = ""
valor_prazo_venda.Visible = False
label_valor_prazo.Visible = False

vSoma = 0

busca_codigo.SetFocus

Application.Calculation = xlCalculationAutomatic
Application.ScreenUpdating = True

End Sub

Private Sub label_cpf_Click()

End Sub

Private Sub Label11_Click()

End Sub

Private Sub Label12_Click()

End Sub

Private Sub Label13_Click()

End Sub

Private Sub Label19_Click()

End Sub

Private Sub Label21_Click()

End Sub

Private Sub Label28_Click()

End Sub

Private Sub Label2_Click()

End Sub

Private Sub Label29_Click()

End Sub

Private Sub Label3_Click()

End Sub

Private Sub Label31_Click()

End Sub

Private Sub Label32_Click()

End Sub

Private Sub Label4_Click()

End Sub

Private Sub Label9_Click()

End Sub

Private Sub limpar_item_Click()

If ListBox1.ListIndex > -1 Then
    linhalistbox = ListBox1.ListIndex
    ListBox1.RemoveItem (linhalistbox)
End If

''''ativar botão de venda se resumo estiver feito
If Me.ListBox1.Value = "" Then
    Me.fechar_venda.Enabled = False
    
End If
'''''

'''' atualizar resumo venda
Worksheets("resumo_compra").Select

Rows("2:2").Select
Range(Selection, Selection.End(xlDown)).Select
Selection.ClearContents

Range("A2").Select

For i = 0 To (ListBox1.ListCount - 1)

Do
If Not (IsEmpty(ActiveCell)) Then
ActiveCell.Offset(1, 0).Select
End If
Loop Until IsEmpty(ActiveCell) = True

ActiveCell.Value = ListBox1.List(i, 1)
ActiveCell.Offset(0, 1).Value = ListBox1.List(i, 2)
ActiveCell.Offset(0, 2).Value = ListBox1.List(i, 3)
ActiveCell.Offset(0, 3).Value = ListBox1.List(i, 0)

ActiveCell.Offset(0, 4).Value = ListBox1.List(i, 4)

Next
''''''

'''' somar venda

Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
           
           
           '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
           
           
            
        If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then  ''''' somar encomenda
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
            
            
            If desconto <> "" And IsNumeric(desconto) Then
            desc = (vSoma * desconto) / 100
            vSoma = vSoma - desc
            End If
           
           If botao_cartao2x = True Then
          Worksheets("juros").Select

          juros2 = (vSoma * Cells(2, 1)) / 100
          vSoma = vSoma + juros2
           parcela = Format(Round(vSoma / 2, 2), "R$ 0.00#,##")
           
           End If
          
          If botao_cartao3x = True Then
          Worksheets("juros").Select
          
          juros3 = (vSoma * Cells(3, 1)) / 100
          vSoma = vSoma + juros3
           parcela = Format(Round(vSoma / 3, 2), "R$ 0.00#,##")
           
           End If
           
            If botao_cartao2x = True Or botao_cartao3x = True Then
          recebido = ""
          treco = ""
          Else
          parcela = ""
          End If
           


''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' se já tiver devendo somar o valor''''''''''''''''''''
    Linha = 2
    linhalistbox = Linha - 2

    Do While Sheets("prazo").Cells(Linha, 1) <> ""

    If Sheets("prazo").Cells(Linha, 13).Text = cpf_prazo Then
       
        valor_prazo_venda = Format(Sheets("prazo").Cells(Linha, 3).Value, "0.00#,##")
        nome_prazo = Sheets("prazo").Cells(Linha, 12).Value
        
        vSoma = vSoma + Sheets("prazo").Cells(Linha, 3).Value
       
    End If
    
    
    Linha = Linha + 1

Loop
          
   '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''



'Definimos o valor do TextBox, o total da soma
total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
          
'''''''
If recebido <> "" And IsNumeric(recebido) Then

Dim txt1 As Double
Dim txt2 As Double

txt1 = recebido
txt2 = total_venda
tot = txt1 - txt2

troco = Format(tot, "R$ 0.00#,##")
Else
troco = ""
End If


If botao_misto = True Then
    
        Label_din_misto.Visible = True
        dinheiro_misto.Visible = True
        sobra_card_2x.Visible = True
        sobra_card_3x.Visible = True
        Labelcard_misto.Visible = True
        cartao_misto.Visible = True
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        'Else
        
            'total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If
'Definimos o valor da Variável para 0 (zero)
vSoma = 0

End Sub

Private Sub limpar_tudo_Click()
ListBox1.Clear

''''ativar botão de venda se resumo estiver feito
If Me.ListBox1.Text = "" Then
    Me.fechar_venda.Enabled = False
    
Else
    Me.fechar_venda.Enabled = True
    
End If
'''''

'''' atualizar resumo venda
Worksheets("resumo_compra").Select

Rows("2:2").Select
Range(Selection, Selection.End(xlDown)).Select
Selection.ClearContents

troco = ""
recebido = ""
desconto = 0
parcela = ""
busca_codigo = ""
quantidade_venda = ""
quantidade = ""
preco = ""
descricao = ""
total_venda = Format(0, "R$ 0.00#,##")

botao_misto = False
botao_dinheiro = False
botao_pix = False
botao_cartao = False
botao_cartao2x = False
botao_cartao3x = False
botao_prazo = False

botao_online = ""
botao_troca = ""
botao_encomenda = ""
valor_encomenda = ""

botao_misto = False
Label_din_misto.Visible = False
dinheiro_misto.Visible = False
dinheiro_misto = ""
sobra_card_2x.Visible = False
sobra_card_2x = False
sobra_card_3x.Visible = False
sobra_card_3x = False
Labelcard_misto.Visible = False
cartao_misto.Visible = False
cartao_misto = ""

nome_prazo.Visible = False
label_nome_prazo.Visible = False
label_cpf_prazo.Visible = False
cpf_prazo.Visible = False
valor_prazo_venda.Visible = False
label_valor_prazo.Visible = False

fechar_venda.Enabled = False

End Sub

Private Sub ListBox1_Click()

End Sub



Private Sub resumo_compra_Click()

End Sub



Private Sub nome_prazo_Change()




fechar_venda.Enabled = False
If cpf_prazo <> "" And nome_prazo <> "" And Me.ListBox1.Text <> "" Then

fechar_venda.Enabled = True
End If


If Me.ListBox1.ListCount > 0 Then
    fechar_venda.Enabled = True
Else
    fechar_venda.Enabled = False
    MsgBox "adicione o codigo e quantidade no botão da sacola", vbInformation, "ATENÇÃO"
End If

End Sub

Private Sub OptionButton1_Click()

End Sub

Private Sub parcela_Change()

End Sub

Private Sub preco_Change()

End Sub

Private Sub quantidade_Change()

End Sub

Private Sub quantidade_venda_Change()

If descricao = "" Then
        MsgBox "Produto não cadastrado", vbInformation, "ATENÇÃO"
        adicionar_venda.Enabled = False
Else
    
If quantidade_venda = "" Then

Else
If Not IsNumeric(quantidade_venda) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 quantidade_venda = ""
 
 End If
  End If


If quantidade_venda.Value = "" Then

Else

Dim X As Double
Dim Y As Double

X = quantidade_venda.Value

Y = quantidade.Value

If X > Y Or X = 0 Then
        adicionar_venda.Enabled = False
        MsgBox "Quantidade indisponivel", vbInformation, "ATENÇÃO"
        
        Else
        adicionar_venda.Enabled = True
End If
End If
End If
End Sub

Private Sub recebido_Change()

If recebido = "" Then

Else
If Not IsNumeric(recebido) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 recebido = ""
 
 End If
  End If


If recebido <> "" And IsNumeric(recebido) Then

Dim txt1 As Double
Dim txt2 As Double

txt1 = recebido.Value
txt2 = total_venda.Value
tot = txt1 - txt2
troco = Format(Round(tot, 2), "R$ 0.00#,##")
End If

If recebido = "" Then
troco = ""
End If

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' venda mista

If botao_misto = True Then
        
                
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
          
        End If
    End If


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''

End Sub

Private Sub sobra_card_2x_Click()
Worksheets("resumo_compra").Select

'''' somar venda

Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
      
      
      '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
      
      
             If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
      
            
            
            If desconto <> "" And IsNumeric(desconto) Then
            desc = (vSoma * desconto) / 100
            vSoma = vSoma - desc
            End If
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    If botao_misto = True Then
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        Else
        
            total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If
    
    
    
    'Definimos o valor da Variável para 0 (zero)
    vSoma = 0
'''''''


''''ativar botão de venda se resumo estiver feito
If ListBox1.Value = "" And (botao_misto = False And botao_dinheiro = False And botao_cartao = False And botao_cartao2x = False And botao_cartao3x = False And botao_prazo = False) Then
    fechar_venda.Enabled = False
    
Else

    fechar_venda.Enabled = True
    

End If
'''''
End Sub

Private Sub sobra_card_3x_Click()
Worksheets("resumo_compra").Select

'''' somar venda

Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
      
      
      '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
        
    End If
        
Next
        
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
      
      
             If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
      
            
            
            If desconto <> "" And IsNumeric(desconto) Then
            desc = (vSoma * desconto) / 100
            vSoma = vSoma - desc
            End If
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    If botao_misto = True Then
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        Else
        
            total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If
    
    
    
    'Definimos o valor da Variável para 0 (zero)
    vSoma = 0
'''''''


''''ativar botão de venda se resumo estiver feito
If ListBox1.Value = "" And (botao_misto = False And botao_dinheiro = False And botao_cartao = False And botao_cartao2x = False And botao_cartao3x = False And botao_prazo = False) Then
    fechar_venda.Enabled = False
    
Else

    fechar_venda.Enabled = True
    

End If
'''''
End Sub

Private Sub total_venda_Change()


End Sub

Private Sub troco_Change()

End Sub
Private Sub UserForm_QueryClose _
   (Cancel As Integer, CloseMode As Integer)
   If CloseMode = vbFormControlMenu Then
       MsgBox "Fechar de maneira correta (botão SAIR)", vbCritical, "AVISO"
        Cancel = True
   End If
End Sub


Private Sub UserForm_Initialize()



'------------------------- exibir aniversariantes

aniver.Visible = False
aniver = ""

Worksheets("clientes_data").Select

Totalregistro = Worksheets("clientes_data").UsedRange.Rows.Count


'''' Editar se ja estiver cadastrado
For i = 2 To Totalregistro
    
    If Day(Date) = Day(Cells(i, 3)) And Month(Date) = Month(Cells(i, 3)) Then
    
        
        
        aniver.Visible = True
        aniver = "Ei! Hoje tem aniversariante. Dê uma olhada em clientes"
        
        
    
    End If
        
        Next

'---------------------------------




botao_misto = False
Label_din_misto.Visible = False
dinheiro_misto.Visible = False
dinheiro_misto = ""
sobra_card_2x.Visible = False
sobra_card_2x = False
sobra_card_3x.Visible = False
sobra_card_3x = False
Labelcard_misto.Visible = False
cartao_misto.Visible = False
cartao_misto = ""

label_encomenda.Visible = False
valor_encomenda.Visible = False

desconto = 0

nome_prazo.Visible = False
label_nome_prazo.Visible = False
label_cpf_prazo.Visible = False
cpf_prazo.Visible = False
valor_prazo_venda.Visible = False
label_valor_prazo.Visible = False

label_valor_credito.Visible = False
label_cpf.Visible = False
cpf_busca_credito.Visible = False
valor_credito_venda.Visible = False

botao_dinheiro = False


'vendedores.AddItem "Luale"
'vendedores.AddItem "Estéfany"


Worksheets("vendedor_data").Select

Totalregistro = Worksheets("vendedor_data").UsedRange.Rows.Count

For i = 2 To Totalregistro
    vendedores.AddItem Cells(i, 1)
        
        Next




botao_troca.AddItem "Sim"
botao_encomenda.AddItem "Sim"
botao_online.AddItem "Sim"

If Me.ListBox1.Text = "" Then
    Me.fechar_venda.Enabled = False
    
Else
    Me.fechar_venda.Enabled = True
    
End If

'''''data no formulario
data = Format(Date, "dd/mm/yyyy")
''''''
'recebido = Format(0, "R$ 0.00#,##")
total_venda = Format(0, "R$ 0.00#,##")
'troco = Format(0, "R$ 0.00#,##")

If vendedores = "" Then
busca_codigo.Enabled = False
End If

Exit Sub




End Sub

Private Sub UserForm_Click()
    

End Sub

Private Sub valor_credito_venda_Change()

End Sub

Private Sub valor_encomenda_Change()
fechar_venda.Enabled = False

If valor_encomenda = "" Then

Else
If Not IsNumeric(valor_encomenda) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 valor_encomenda = ""
 
 End If
  End If


Worksheets("resumo_compra").Select

'''' somar venda

Dim vSoma As Double
          'Para cada item do ListBox
          ultimalinha = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row
           For Linha = 2 To ultimalinha
                'Adicionamos a variável, o valor da coluna 5 do ListBox e somamos
                 vSoma = vSoma + (Cells(Linha, 2).Value * Cells(Linha, 1).Value)
                'vSoma = vSoma + Format(Cells(Totalregistro, 2), "R$ 0.00#,##")
           Next
          'Definimos o valor do TextBox, o total da soma
    
    '''''''''''''''''''''''''''''''''''''''''inserir desconto se a pessoa tiver credito''''''''''''''''''''
       valor_credito_venda = ""


    Totalregistro = Worksheets("credito_clientes").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(i, 2) Then
               
        valor_credito_venda = Format(Sheets("credito_clientes").Cells(i, 3).Value, "R$ 0.00#,##")
        
    End If
        
Next
        
        
        
If valor_credito_venda <> "" Then

Dim j As Double
            j = 1
    
            Do
            j = j + 1
    
            If cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2) Then
            
                
            vSoma = vSoma - Sheets("credito_clientes").Cells(j, 3).Value
                    
            End If
                
            Loop Until cpf_busca_credito.Text = Sheets("credito_clientes").Cells(j, 2)
                       
  End If
   
    ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
    
        If botao_encomenda = "Sim" And IsNumeric(valor_encomenda) Then
            'fechar_venda.Enabled = True
          
          vSoma = vSoma + valor_encomenda.Value
          End If
          
          If botao_encomenda = "Sim" And Not IsNumeric(valor_encomenda) Then
          MsgBox "Desative botão encomenda ou coloque valor encomenda", vbInformation, "ATENÇÃO"
            End If
            
          If desconto <> "" And IsNumeric(desconto) Then
          desc = (vSoma * desconto) / 100
          vSoma = vSoma - desc
          End If
          
          If botao_cartao2x = True Then
          Worksheets("juros").Select

          juros2 = (vSoma * Cells(2, 1)) / 100
          vSoma = vSoma + juros2
          
          parcela = Format(Round(vSoma / 2, 2), "R$ 0.00#,##")
          
           End If
          
          If botao_cartao3x = True Then
          Worksheets("juros").Select
          
          juros3 = (vSoma * Cells(3, 1)) / 100
          vSoma = vSoma + juros3
          
          parcela = Format(Round(vSoma / 3, 2), "R$ 0.00#,##")
          
           End If
          
          If botao_cartao2x = True Or botao_cartao3x = True Then
          recebido = ""
          treco = ""
          Else
          parcela = ""
          End If
          
          
          ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''' se já tiver devendo somar o valor''''''''''''''''''''
          Linha = 2
    linhalistbox = Linha - 2

    Do While Sheets("prazo").Cells(Linha, 1) <> ""

    If Sheets("prazo").Cells(Linha, 13).Text = cpf_prazo Then
       
        valor_prazo_venda = Format(Sheets("prazo").Cells(Linha, 3).Value, "0.00#,##")
        nome_prazo = Sheets("prazo").Cells(Linha, 12).Value
        
        vSoma = vSoma + Sheets("prazo").Cells(Linha, 3).Value
       
    End If
    
    
    Linha = Linha + 1

Loop
          
          '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
          
    total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
          
                  
    'Definimos o valor da Variável para 0 (zero)
          

''''''''
If recebido <> "" And IsNumeric(recebido) Then

Dim txt1 As Double
Dim txt2 As Double

txt1 = recebido
txt2 = total_venda
tot = txt1 - txt2

troco = Format(tot, "R$ 0.00#,##")
Else
troco = ""
End If



If botao_misto = True Then
    
        Label_din_misto.Visible = True
        dinheiro_misto.Visible = True
        sobra_card_2x.Visible = True
        sobra_card_3x.Visible = True
        Labelcard_misto.Visible = True
        cartao_misto.Visible = True
                
        recebido.Enabled = True
        troco.Enabled = True
           
        recebido.Visible = True
        troco.Visible = True
           
        label_recebido.Visible = True
        label_troco.Visible = True
        
        nome_prazo = ""
        cpf_prazo = ""
        valor_prazo_venda = ""
            
        nome_prazo.Visible = False
        label_nome_prazo.Visible = False
        label_cpf_prazo.Visible = False
        cpf_prazo.Visible = False
        valor_prazo_venda.Visible = False
        label_valor_prazo.Visible = False
        
        If sobra_card_2x = True Or sobra_card_3x = True Then
            parcela.Visible = True
            label_parcela.Visible = True
        Else
            parcela.Visible = False
            label_parcela.Visible = False
        End If
          
    
        If dinheiro_misto <> "" And IsNumeric(dinheiro_misto) Then

            Dim dim_misto As Double
            Dim sobra_card_misto As Double
            
            dim_misto = dinheiro_misto.Value
            
            sobra_card_misto = vSoma - dim_misto
            
            cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
            
            If recebido <> "" And IsNumeric(recebido) Then
                Dim rec As Double
                rec = recebido
                tro = rec - dim_misto
                
                troco = Format(tro, "R$ 0.00#,##")
                Else
                troco = ""
            End If
            
            If sobra_card_2x = True Then
                             
              sobra_card_3x = False
              sobra_card_3x.Visible = False
        
              Worksheets("juros").Select
              juros2 = (sobra_card_misto * Cells(2, 1)) / 100
              sobra_card_misto = sobra_card_misto + juros2
              cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
              parcela = Format(Round(sobra_card_misto / 2, 2), "R$ 0.00#,##")
            Else
                sobra_card_3x.Visible = True
                                         
            End If
          
            If sobra_card_3x = True Then
                                
                sobra_card_2x = False
                sobra_card_2x.Visible = False
            
                Worksheets("juros").Select
                juros3 = (sobra_card_misto * Cells(3, 1)) / 100
                sobra_card_misto = sobra_card_misto + juros3
                cartao_misto = Format(Round(sobra_card_misto, 2), "R$ 0.00#,##")
                parcela = Format(Round(sobra_card_misto / 3, 2), "R$ 0.00#,##")
            Else
                sobra_card_2x.Visible = True
                           
           End If
           
            total_venda = Format(Round(dim_misto + sobra_card_misto, 2), "R$ 0.00#,##")
        'Else
        
         '   total_venda = Format(Round(vSoma, 2), "R$ 0.00#,##")
        
        End If
    End If

vSoma = 0


End Sub

Private Sub valor_prazo_venda_Change()

End Sub

Private Sub vendedores_Change()

busca_codigo.Enabled = True

End Sub



============================================================
MODULE: Planilha1.cls
============================================================
Attribute VB_Name = "Planilha1"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Planilha2.cls
============================================================
Attribute VB_Name = "Planilha2"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Módulo21.bas
============================================================
Attribute VB_Name = "Módulo21"



============================================================
MODULE: Planilha3.cls
============================================================
Attribute VB_Name = "Planilha3"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: parametros.frm
============================================================
Attribute VB_Name = "parametros"
Attribute VB_Base = "0{827EBD62-7732-49B4-AB34-BC9B0B49A5BD}{0C758703-A219-4C63-8B85-1769B81EE76C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub acessar_inserir_Click()
Unload parametros
venda.Show
End Sub

Private Sub botao_Click()
Unload parametros
creditos_venda.Show
End Sub

Private Sub botao_excluir_Click()







End Sub

Private Sub botao_salvar_Click()




End Sub

Private Sub botao_excluir_cli_Click()


If cli_tel = "" Then
            
    MsgBox "PREENCHER o CEL PARA EXCLUIR"
    
Else
Worksheets("clientes_data").Select
Totalregistro = Worksheets("clientes_data").UsedRange.Rows.Count

'''' Editar se ja estiver cadastrado
For i = 2 To Totalregistro
    
    If cli_tel.Text = Cells(i, 2) Then
    
        Sheets("clientes_data").Rows(i).Select
        Selection.Delete Shift:=xlUp
    
    End If
        
        Next
        
MsgBox "Cliente excluido!"


ActiveWorkbook.Save

'limpar caixas
cli_name = ""
cli_tel = ""
cli_dia = ""
mes_cliente.Clear

mes_cliente.AddItem "Janeiro"
mes_cliente.AddItem "Fevereiro"
mes_cliente.AddItem "Março"
mes_cliente.AddItem "Abril"
mes_cliente.AddItem "Maio"
mes_cliente.AddItem "Junho"
mes_cliente.AddItem "Julho"
mes_cliente.AddItem "Agosto"
mes_cliente.AddItem "setembro"
mes_cliente.AddItem "Outubro"
mes_cliente.AddItem "Novembro"
mes_cliente.AddItem "Dezembro"

'voltar cursor para caixa codigo
edicao_cli.Enabled = False
botao_excluir_cli.Enabled = False
cli_tel.SetFocus

'''''''''''''''''''''''''''''''''''''' somar valor custo e venda total

''''''''''''''''''''''''''''''''''''''''''''''' listbox
Linha = 2
linhalistbox = Linha - 2

listbox_cli_data.Clear

Do While Sheets("Bancodados").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_cli_data
     .AddItem
        .List(linhalistbox, 0) = Sheets("clientes_data").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("clientes_data").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("clientes_data").Cells(Linha, 3)
        
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop
''''''''''''''''''''''''''''''''''''''''''''''''''''''


End If
End Sub

Private Sub botao_excluir_vend_Click()


If vend_name = "" Then
            
    MsgBox "PREENCHER o NOME PARA EXCLUIR"
    
Else
Worksheets("vendedor_data").Select
Totalregistro = Worksheets("vendedor_data").UsedRange.Rows.Count

'''' Editar se ja estiver cadastrado
For i = 2 To Totalregistro
    
    If vend_name.Text = Cells(i, 1) Then
    
        Sheets("vendedor_data").Rows(i).Select
        Selection.Delete Shift:=xlUp
    
    End If
        
        Next
        
ActiveWorkbook.Save

'limpar caixas
vend_name = ""

'voltar cursor para caixa codigo
botao_excluir_vend.Enabled = False
vend_name.SetFocus

End If



End Sub

Private Sub botao_salvar_cli_Click()

If cli_name = "" Or cli_tel = "" Or cli_dia = "" Or mes_cliente = "" Then
            
    MsgBox "FORMULARIO NÃO PREENCHIDO!"

Else

Worksheets("clientes_data").Select

Totalregistro = Worksheets("clientes_data").UsedRange.Rows.Count

Totalregistro = Totalregistro + 1

'aqui começa a gravação dos dados no fomulario
Cells(Totalregistro, 1) = cli_name.Value
Cells(Totalregistro, 2) = cli_tel.Value
Cells(Totalregistro, 3) = DateValue(CDate(cli_dia.Value & "/" & mes_cliente.ListIndex + 1))

'DateValue (CDate(TxtDataNascimento.Text))



''''''''''''''''''''''''''''''''''''''''''''''' listbox
Linha = 2
linhalistbox = Linha - 2

listbox_cli_data.Clear


Do While Sheets("clientes_data").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_cli_data
     .AddItem
        .List(linhalistbox, 0) = Sheets("clientes_data").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("clientes_data").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("clientes_data").Cells(Linha, 3)
        
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop
''''''''''''''''''''''''''''''''''''''''''''''''''''''

ActiveWorkbook.Save

'limpar caixas
cli_name = ""
cli_tel = ""
cli_dia = ""
mes_cliente.Clear

mes_cliente.AddItem "Janeiro"
mes_cliente.AddItem "Fevereiro"
mes_cliente.AddItem "Março"
mes_cliente.AddItem "Abril"
mes_cliente.AddItem "Maio"
mes_cliente.AddItem "Junho"
mes_cliente.AddItem "Julho"
mes_cliente.AddItem "Agosto"
mes_cliente.AddItem "setembro"
mes_cliente.AddItem "Outubro"
mes_cliente.AddItem "Novembro"
mes_cliente.AddItem "Dezembro"

'voltar cursor para caixa codigo
edicao_cli.Enabled = False
botao_excluir_cli.Enabled = False
cli_tel.SetFocus

End If



End Sub

Private Sub botao_salvar_vend_Click()


If vend_name = "" Then
            
    MsgBox "FORMULARIO NÃO PREENCHIDO!"

Else

Worksheets("vendedor_data").Select

Totalregistro = Worksheets("vendedor_data").UsedRange.Rows.Count

Totalregistro = Totalregistro + 1

'aqui começa a gravação dos dados no fomulario
Cells(Totalregistro, 1) = vend_name.Value
Cells(Totalregistro, 2) = Date


ActiveWorkbook.Save

'limpar caixas
vend_name = ""


'voltar cursor para caixa codigo

botao_excluir_vend.Enabled = False
vend_name.SetFocus

End If



End Sub

Private Sub buscar_cli_Click()
Worksheets("clientes_data").Select

Totalregistro = Worksheets("clientes_data").UsedRange.Rows.Count

linhalistbox = 0

listbox_cli_data.Clear
'''' Editar se ja estiver cadastrado
For i = 2 To Totalregistro
    
    If Day(Date) = Day(Cells(i, 3)) And Month(Date) = Month(Cells(i, 3)) Then
    
        
        
        
        With Me.listbox_cli_data
        .AddItem
        .List(linhalistbox, 0) = Sheets("clientes_data").Cells(i, 1)
        .List(linhalistbox, 1) = Sheets("clientes_data").Cells(i, 2)
        .List(linhalistbox, 2) = Sheets("clientes_data").Cells(i, 3)
        
        
        End With
        linhalistbox = linhalistbox + 1
        
        
    
    End If
        
        Next
End Sub

Private Sub cli_name_Change()

End Sub

Private Sub cli_tel_Change()

botao_salvar_cli.Enabled = True

Worksheets("clientes_data").Select
Totalregistro = Worksheets("clientes_data").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If CStr(cli_tel.Text) = CStr(Cells(i, 2)) Then
        botao_salvar_cli.Enabled = False
        botao_excluir_cli.Enabled = True
        edicao_cli.Enabled = True
        MsgBox "Cliente já cadastrado", vbInformation, "ATENÇÃO"
        cli_name = Cells(i, 1)
        cli_tel = Cells(i, 2)
        cli_dia = Day(Cells(i, 3))
        'mes_cliente = Month(Cells(i, 3))
        
    End If
        
Next


End Sub

Private Sub CommandButton10_Click()

End Sub

Private Sub CommandButton11_Click()
Unload parametros
inicio.Show
End Sub

Private Sub CommandButton12_Click()
resposta = MsgBox("Deseja realmente sair?", vbYesNo, "ATENÇÃO")
    If resposta = vbYes Then
    ActiveWorkbook.Save
    Application.Quit
    Else
    ActiveWorkbook.Save
    Exit Sub
    End If
End Sub

Private Sub CommandButton13_Click()
Unload parametros
prazo.Show
End Sub

Private Sub CommandButton14_Click()




End Sub

Private Sub CommandButton15_Click()

End Sub

Private Sub CommandButton9_Click()
Unload parametros
relatorio.Show
End Sub

Private Sub contagem_inicio_Click()
Unload parametros
acess_cadastro.Show
End Sub

Private Sub Frame1_Click()

End Sub

Private Sub edicao_cli_Click()

If cli_name = "" Or cli_tel = "" Or cli_dia = "" Or mes_cliente = "" Then
            
    MsgBox "FORMULARIO NÃO PREENCHIDO!"
    
Else

Worksheets("clientes_data").Select
Totalregistro = Worksheets("clientes_data").UsedRange.Rows.Count

'''' Editar se ja estiver cadastrado
For i = 2 To Totalregistro
    
    If cli_tel.Text = Cells(i, 2) Then
    
        Cells(i, 1) = cli_name.Value
        Cells(i, 2) = cli_tel.Value
        Cells(i, 3) = DateValue(CDate(cli_dia.Value & "/" & mes_cliente.ListIndex + 1))
        
    
    End If
        
        Next

''''

''''''''''''''''''''''''''''''''''''''''''''''''''''''' proximo codigo

''''''''''''''''''''''''''''''''''''''''''''''''''''

MsgBox "Dados Editados com sucesso!"
'limpar caixas
cli_name = ""
cli_tel = ""
cli_dia = ""
mes_cliente.Clear

mes_cliente.AddItem "Janeiro"
mes_cliente.AddItem "Fevereiro"
mes_cliente.AddItem "Março"
mes_cliente.AddItem "Abril"
mes_cliente.AddItem "Maio"
mes_cliente.AddItem "Junho"
mes_cliente.AddItem "Julho"
mes_cliente.AddItem "Agosto"
mes_cliente.AddItem "setembro"
mes_cliente.AddItem "Outubro"
mes_cliente.AddItem "Novembro"
mes_cliente.AddItem "Dezembro"

ActiveWorkbook.Save

'voltar cursor para caixa codigo
edicao_cli.Enabled = False
botao_excluir_cli.Enabled = False
cli_tel.SetFocus

'''''''''''''''''''''''''''''''''''''' somar valor custo e venda total

''''''''''''''''''''''''''''''''''''''''''''''' listbox
Linha = 2
linhalistbox = Linha - 2

listbox_cli_data.Clear

Do While Sheets("Bancodados").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_cli_data
     .AddItem
        .List(linhalistbox, 0) = Sheets("clientes_data").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("clientes_data").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("clientes_data").Cells(Linha, 3)
        
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop
''''''''''''''''''''''''''''''''''''''''''''''''''''''


End If



End Sub

Private Sub edicao_vend_Click()





End Sub

Private Sub juros2x_Change()
If juros2x = "" Then

Else
If Not IsNumeric(juros2x) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 juros2x = ""
 
 End If
  End If
End Sub

Private Sub juros3x_Change()
If juros3x = "" Then

Else
If Not IsNumeric(juros3x) Then

 MsgBox "Esse campo só aceita numeros!", vbInformation, "ATENÇÃO"
 juros3x = ""
 
 End If
  End If
End Sub

Private Sub Label10_Click()

End Sub

Private Sub Label11_Click()

End Sub

Private Sub Label3_Click()

End Sub

Private Sub Label12_Click()

End Sub

Private Sub Label4_Click()

End Sub

Private Sub Label6_Click()

End Sub

Private Sub salvar_config_Click()
Windows("ExploTrack exe").Activate

Worksheets("juros").Select

If IsNumeric(juros2x) And IsNumeric(juros3x) Then

Cells(2, 1) = juros2x.Value
Cells(3, 1) = juros3x.Value

ActiveWorkbook.Save
MsgBox "Dados Salvos!", vbInformation, "ATENÇÃO"

Else
 MsgBox "Colocar numero. Outros caracteres não são aceitos", vbInformation, "ATENÇÃO"

End If



End Sub

Private Sub UserForm_Click()


End Sub
Private Sub UserForm_QueryClose _
   (Cancel As Integer, CloseMode As Integer)
   If CloseMode = vbFormControlMenu Then
       MsgBox "Fechar de maneira correta (botão SAIR)", vbCritical, "AVISO"
        Cancel = True
   End If
End Sub

Private Sub UserForm_Initialize()

cli_tel.SetFocus

botao_excluir_cli.Enabled = False
edicao_cli.Enabled = False


botao_excluir_vend.Enabled = False



Worksheets("juros").Select

juros2x = Cells(2, 1)
juros3x = Cells(3, 1)

' ---------------
mes_cliente.AddItem "Janeiro"
mes_cliente.AddItem "Fevereiro"
mes_cliente.AddItem "Março"
mes_cliente.AddItem "Abril"
mes_cliente.AddItem "Maio"
mes_cliente.AddItem "Junho"
mes_cliente.AddItem "Julho"
mes_cliente.AddItem "Agosto"
mes_cliente.AddItem "setembro"
mes_cliente.AddItem "Outubro"
mes_cliente.AddItem "Novembro"
mes_cliente.AddItem "Dezembro"



Linha = 2
linhalistbox = Linha - 2

listbox_cli_data.Clear


Do While Sheets("clientes_data").Cells(Linha, 1) <> ""
    
        
    With Me.listbox_cli_data
     .AddItem
        .List(linhalistbox, 0) = Sheets("clientes_data").Cells(Linha, 1)
        .List(linhalistbox, 1) = Sheets("clientes_data").Cells(Linha, 2)
        .List(linhalistbox, 2) = Sheets("clientes_data").Cells(Linha, 3)
        
        
        End With
        linhalistbox = linhalistbox + 1
     
    
    Linha = Linha + 1

Loop


End Sub

Private Sub vend_name_Change()

botao_salvar_vend.Enabled = True

Worksheets("vendedor_data").Select
Totalregistro = Worksheets("vendedor_data").UsedRange.Rows.Count

For i = 2 To Totalregistro
    
    If CStr(vend_name.Text) = CStr(Cells(i, 1)) Then
        botao_salvar_vend.Enabled = False
        botao_excluir_vend.Enabled = True
        MsgBox "Vendedor já cadastrado", vbInformation, "ATENÇÃO"
        vend_name = Cells(i, 1)
        
        
    End If
        
Next



End Sub



============================================================
MODULE: Planilha8.cls
============================================================
Attribute VB_Name = "Planilha8"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: acess_cadastro.frm
============================================================
Attribute VB_Name = "acess_cadastro"
Attribute VB_Base = "0{94319EBB-2C9A-4F24-937B-8C6241FA6BD7}{2670C0A5-4589-445E-A97B-C78503B6436E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Label1_Click()

End Sub

Private Sub ok_cadastro_Click()
Worksheets("Desenvolvedor").Select
    If senha_cadastro = "" Then
    MsgBox "Digite a senha"
    senha_cadastro.SetFocus
    Exit Sub
    
    End If
    
    'varrer planilha
    
Linha = 1
    
Do
Linha = Linha + 1

    
    senha = CStr(Cells(Linha, 2))
    
    
    If senha_cadastro = senha Then
        Unload acess_cadastro
        cadastro.Show
         
    End If
        
Loop Until (senha_cadastro = senha) Or Cells(Linha, 2) = ""
                
        
If senha_cadastro <> senha Then
 
        MsgBox "Senha incorreta!"
        
        senha_cadastro = ""
        
End If
End Sub

Private Sub voltar_Click()
Unload acess_cadastro
venda.Show
End Sub



============================================================
MODULE: Planilha9.cls
============================================================
Attribute VB_Name = "Planilha9"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Planilha13.cls
============================================================
Attribute VB_Name = "Planilha13"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet1.cls
============================================================
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Planilha11.cls
============================================================
Attribute VB_Name = "Planilha11"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Planilha10.cls
============================================================
Attribute VB_Name = "Planilha10"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet2.cls
============================================================
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet3.cls
============================================================
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet4.cls
============================================================
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet5.cls
============================================================
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet6.cls
============================================================
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet7.cls
============================================================
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet8.cls
============================================================
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet9.cls
============================================================
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet10.cls
============================================================
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet11.cls
============================================================
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet12.cls
============================================================
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet13.cls
============================================================
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet14.cls
============================================================
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet15.cls
============================================================
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet16.cls
============================================================
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



============================================================
MODULE: Sheet17.cls
============================================================
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


